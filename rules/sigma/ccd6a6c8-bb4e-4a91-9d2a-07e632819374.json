{
  "id": "ccd6a6c8-bb4e-4a91-9d2a-07e632819374",
  "name": "AWS SAML Provider Deletion Activity",
  "description": "Detects the deletion of an AWS SAML provider, potentially indicating malicious intent to disrupt administrative or security team access.\nAn attacker can remove the SAML provider for the information security team or a team of system administrators, to make it difficult for them to work and investigate at the time of the attack and after it.\n",
  "source": {
    "type": "sigma",
    "id": "ccd6a6c8-bb4e-4a91-9d2a-07e632819374",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/aws_delete_saml_provider.yml",
    "file_path": "tmp/repos/sigma/rules/cloud/aws/cloudtrail/aws_delete_saml_provider.yml"
  },
  "tags": [
    "attackprivilege-escalation",
    "attackt1078004",
    "attackt1531"
  ],
  "author": "Ivan Saakov",
  "references": [
    "https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteSAMLProvider.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "experimental",
  "created": "2024-12-19",
  "modified": "2024-12-19",
  "mitre": {
    "tactics": [
      "TA1078",
      "TA1531"
    ],
    "techniques": [
      "T004"
    ]
  },
  "detection": {
    "query": "selection: {\"eventSource\": \"iam.amazonaws.com\", \"eventName\": \"DeleteSAMLProvider\", \"status\": \"success\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Automated processes using tools like Terraform may trigger this alert.",
    "Legitimate administrative actions by authorized system administrators could cause this alert. Verify the user identity, user agent, and hostname to ensure they are expected.",
    "Deletions by unfamiliar users should be investigated. If the behavior is known and expected, it can be exempted from the rule."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "aws",
    "cloudtrail"
  ]
}