{
  "id": "8d31a8ce-46b5-4dd6-bdc3-680931f1db86",
  "name": "Bad Opsec Powershell Code Artifacts",
  "description": "focuses on trivial artifacts observed in variants of prevalent offensive ps1 payloads, including\nCobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other attack payloads\nthat often undergo minimal changes by attackers due to bad opsec.\n",
  "source": {
    "type": "sigma",
    "id": "8d31a8ce-46b5-4dd6-bdc3-680931f1db86",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_pm_bad_opsec_artifacts.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_module/posh_pm_bad_opsec_artifacts.yml"
  },
  "tags": [
    "attackexecution",
    "attackt1059001"
  ],
  "author": "ok @securonix invrep_de, oscd.community",
  "references": [
    "https://newtonpaul.com/analysing-fileless-malware-cobalt-strike-beacon/",
    "https://labs.sentinelone.com/top-tier-russian-organized-cybercrime-group-unveils-fileless-stealthy-powertrick-backdoor-for-high-value-targets/",
    "https://www.mdeditor.tw/pl/pgRt"
  ],
  "severity": "critical",
  "type": "sigma",
  "status": "test",
  "created": "2020-10-09",
  "modified": "2022-12-25",
  "mitre": {
    "tactics": [
      "TA1059"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_4103: {\"Payload|contains\": [\"$DoIt\", \"harmj0y\", \"mattifestation\", \"_RastaMouse\", \"tifkin_\", \"0xdeadbeef\"]}",
    "condition": "selection_4103",
    "fields": []
  },
  "falsepositives": [
    "Moderate-to-low; Despite the shorter length/lower entropy for some of these, because of high specificity, fp appears to be fairly limited in many environments."
  ],
  "level": "critical",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_module"
  ]
}