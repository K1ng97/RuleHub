{
  "id": "123e4e6d-b123-48f8-b261-7214938acaf0",
  "name": "Startup/Logon Script Added to Group Policy Object",
  "description": "Detects the modification of Group Policy Objects (GPO) to add a startup/logon script to users or computer objects.\n",
  "source": {
    "type": "sigma",
    "id": "123e4e6d-b123-48f8-b261-7214938acaf0",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/win_security_susp_group_policy_startup_script_added_to_gpo.yml",
    "file_path": "tmp/repos/sigma/rules/windows/builtin/security/win_security_susp_group_policy_startup_script_added_to_gpo.yml"
  },
  "tags": [
    "attackprivilege-escalation",
    "attackt1484001",
    "attackt1547"
  ],
  "author": "Elastic, Josh Nickels, Marius Rothenb√ºcher",
  "references": [
    "https://www.elastic.co/guide/en/security/current/startup-logon-script-added-to-group-policy-object.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "experimental",
  "created": "2024-09-06",
  "modified": "2024-09-06",
  "mitre": {
    "tactics": [
      "TA1484",
      "TA1547"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_eventid: {\"EventID\": [5136, 5145]}\nselection_attributes_main: {\"AttributeLDAPDisplayName\": [\"gPCMachineExtensionNames\", \"gPCUserExtensionNames\"], \"AttributeValue|contains\": \"42B5FAAE-6536-11D2-AE5A-0000F87571E3\"}\nselection_attributes_optional: {\"AttributeValue|contains\": [\"40B6664F-4972-11D1-A7CA-0000F87571E3\", \"40B66650-4972-11D1-A7CA-0000F87571E3\"]}\nselection_share: {\"ShareName|endswith\": \"\\\\SYSVOL\", \"RelativeTargetName|endswith\": [\"\\\\scripts.ini\", \"\\\\psscripts.ini\"], \"AccessList|contains\": \"%%4417\"}",
    "condition": "selection_eventid and (all of selection_attributes_* or selection_share)",
    "fields": []
  },
  "falsepositives": [
    "Legitimate execution by system administrators."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "security"
  ]
}