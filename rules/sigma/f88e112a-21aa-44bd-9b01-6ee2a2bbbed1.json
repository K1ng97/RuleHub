{
  "id": "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
  "name": "Failed Logon From Public IP",
  "description": "Detects a failed logon attempt from a public IP. A login from a public IP can indicate a misconfigured firewall or network boundary.",
  "source": {
    "type": "sigma",
    "id": "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/win_security_susp_failed_logon_source.yml",
    "file_path": "tmp/repos/sigma/rules/windows/builtin/security/account_management/win_security_susp_failed_logon_source.yml"
  },
  "tags": [
    "attackinitial-access",
    "attackpersistence",
    "attackt1078",
    "attackt1133",
    "attackt1190"
  ],
  "author": "NVISO",
  "references": [
    "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2020-05-06",
  "modified": "2024-03-11",
  "mitre": {
    "tactics": [
      "TA1078",
      "TA1133",
      "TA1190"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"EventID\": 4625}\nfilter_main_ip_unknown: {\"IpAddress|contains\": \"-\"}\nfilter_main_local_ranges: {\"IpAddress|cidr\": [\"::1/128\", \"10.0.0.0/8\", \"127.0.0.0/8\", \"172.16.0.0/12\", \"192.168.0.0/16\", \"169.254.0.0/16\", \"fc00::/7\", \"fe80::/10\"]}",
    "condition": "selection and not 1 of filter_main_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate logon attempts over the internet",
    "IPv4-to-IPv6 mapped IPs"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "security"
  ]
}