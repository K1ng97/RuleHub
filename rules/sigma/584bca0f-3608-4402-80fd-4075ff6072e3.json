{
  "id": "584bca0f-3608-4402-80fd-4075ff6072e3",
  "name": "Potential CommandLine Obfuscation Using Unicode Characters From Suspicious Image",
  "description": "Detects potential commandline obfuscation using unicode characters.\nAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.\n",
  "source": {
    "type": "sigma",
    "id": "584bca0f-3608-4402-80fd-4075ff6072e3",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_susp_cli_obfuscation_unicode_img.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_unicode_img.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1027"
  ],
  "author": "frack113, Florian Roth (Nextron Systems), Josh Nickels",
  "references": [
    "https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation",
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md#atomic-test-6---dlp-evasion-via-sensitive-data-in-vba-macro-over-http"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2024-09-02",
  "modified": "2024-09-05",
  "mitre": {
    "tactics": [
      "TA1027"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: {\"Image|endswith\": [\"\\\\cmd.exe\", \"\\\\cscript.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\", \"\\\\wscript.exe\"], \"OriginalFileName\": [\"Cmd.EXE\", \"cscript.exe\", \"PowerShell.EXE\", \"pwsh.dll\", \"wscript.exe\"]}\nselection_special_chars: {\"CommandLine|contains\": [\"\\u02e3\", \"\\u02ea\", \"\\u02e2\", \"\\u2215\", \"\\u2044\", \"\\u2015\", \"\\u2014\", \"\\u00a0\", \"\\u00af\", \"\\u00ae\", \"\\u00b6\"]}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}