{
  "id": "cf0c254b-22f1-4b2b-8221-e137b3c0af94",
  "name": "HackTool - Impersonate Execution",
  "description": "Detects execution of the Impersonate tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively",
  "source": {
    "type": "sigma",
    "id": "cf0c254b-22f1-4b2b-8221-e137b3c0af94",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_hktl_impersonate.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_hktl_impersonate.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackprivilege-escalation",
    "attackt1134001",
    "attackt1134003"
  ],
  "author": "Sai Prashanth Pulisetti @pulisettis",
  "references": [
    "https://sensepost.com/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/",
    "https://github.com/sensepost/impersonate"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-12-21",
  "modified": "2024-11-23",
  "mitre": {
    "tactics": [
      "TA1134"
    ],
    "techniques": [
      "T001",
      "T003"
    ]
  },
  "detection": {
    "query": "selection_commandline_exe: {\"CommandLine|contains\": \"impersonate.exe\"}\nselection_commandline_opt: {\"CommandLine|contains\": [\" list \", \" exec \", \" adduser \"]}\nselection_hash: {\"Hashes|contains\": [\"MD5=9520714AB576B0ED01D1513691377D01\", \"SHA256=E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A\", \"IMPHASH=0A358FFC1697B7A07D0E817AC740DF62\"]}",
    "condition": "all of selection_commandline_* or selection_hash",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}