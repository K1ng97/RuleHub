{
  "id": "ca94a6db-8106-4737-9ed2-3e3bb826af0a",
  "name": "Password Policy Discovery - Linux",
  "description": "Detects password policy discovery commands",
  "source": {
    "type": "sigma",
    "id": "ca94a6db-8106-4737-9ed2-3e3bb826af0a",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/lnx_auditd_password_policy_discovery.yml",
    "file_path": "tmp/repos/sigma/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackt1201"
  ],
  "author": "Ömer Günal, oscd.community, Pawel Mazur",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1201/T1201.md",
    "https://linux.die.net/man/1/chage",
    "https://man7.org/linux/man-pages/man1/passwd.1.html",
    "https://superuser.com/questions/150675/how-to-display-password-policy-information-for-a-user-ubuntu"
  ],
  "severity": "low",
  "type": "sigma",
  "status": "stable",
  "created": "2020-10-08",
  "modified": "2024-12-01",
  "mitre": {
    "tactics": [
      "TA1201"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection_files: {\"type\": \"PATH\", \"name\": [\"/etc/login.defs\", \"/etc/pam.d/auth\", \"/etc/pam.d/common-account\", \"/etc/pam.d/common-auth\", \"/etc/pam.d/common-password\", \"/etc/pam.d/system-auth\", \"/etc/security/pwquality.conf\"]}\nselection_chage: {\"type\": \"EXECVE\", \"a0\": \"chage\", \"a1\": [\"--list\", \"-l\"]}\nselection_passwd: {\"type\": \"EXECVE\", \"a0\": \"passwd\", \"a1\": [\"-S\", \"--status\"]}",
    "condition": "1 of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate administration activities"
  ],
  "level": "low",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "linux",
    "auditd"
  ]
}