{
  "id": "d7a95147-145f-4678-b85d-d1ff4a3bb3f6",
  "name": "CobaltStrike Service Installations - Security",
  "description": "Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement",
  "source": {
    "type": "sigma",
    "id": "d7a95147-145f-4678-b85d-d1ff4a3bb3f6",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/win_security_cobaltstrike_service_installs.yml",
    "file_path": "tmp/repos/sigma/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml"
  },
  "tags": [
    "attackexecution",
    "attacklateral-movement",
    "attackprivilege-escalation",
    "attackt1021002",
    "attackt1543003",
    "attackt1569002"
  ],
  "author": "Florian Roth (Nextron Systems), Wojciech Lesicki",
  "references": [
    "https://www.sans.org/webcasts/119395",
    "https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/",
    "https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2021-05-26",
  "modified": "2022-11-27",
  "mitre": {
    "tactics": [
      "TA1021",
      "TA1543",
      "TA1569"
    ],
    "techniques": [
      "T002",
      "T003"
    ]
  },
  "detection": {
    "query": "event_id: {\"EventID\": 4697}\nselection1: {\"ServiceFileName|contains|all\": [\"ADMIN$\", \".exe\"]}\nselection2: {\"ServiceFileName|contains|all\": [\"%COMSPEC%\", \"start\", \"powershell\"]}\nselection3: {\"ServiceFileName|contains\": \"powershell -nop -w hidden -encodedcommand\"}\nselection4: {\"ServiceFileName|base64offset|contains\": \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:\"}",
    "condition": "event_id and 1 of selection*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "security"
  ]
}