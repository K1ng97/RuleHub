{
  "id": "5a5152f1-463f-436b-b2f5-8eceb3964b42",
  "name": "Displaying Hidden Files Feature Disabled",
  "description": "Detects modifications to the \"Hidden\" and \"ShowSuperHidden\" explorer registry values in order to disable showing of hidden files and system files.\nThis technique is abused by several malware families to hide their files from normal users.\n",
  "source": {
    "type": "sigma",
    "id": "5a5152f1-463f-436b-b2f5-8eceb3964b42",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/registry_set_hide_file.yml",
    "file_path": "tmp/repos/sigma/rules/windows/registry/registry_set/registry_set_hide_file.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1564001"
  ],
  "author": "frack113",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md#atomic-test-8---hide-files-through-registry"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-04-02",
  "modified": "2024-03-26",
  "mitre": {
    "tactics": [
      "TA1564"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection: {\"TargetObject|endswith\": [\"\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced\\\\ShowSuperHidden\", \"\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced\\\\Hidden\"], \"Details\": \"DWORD (0x00000000)\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "registry_set"
  ]
}