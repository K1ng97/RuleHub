{
  "id": "b45e3d6f-42c6-47d8-a478-df6bd6cf534c",
  "name": "Local System Accounts Discovery - Linux",
  "description": "Detects enumeration of local systeam accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.",
  "source": {
    "type": "sigma",
    "id": "b45e3d6f-42c6-47d8-a478-df6bd6cf534c",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_lnx_local_account.yml",
    "file_path": "tmp/repos/sigma/rules/linux/process_creation/proc_creation_lnx_local_account.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackt1087001"
  ],
  "author": "Alejandro Ortuno, oscd.community, CheraghiMilad",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.001/T1087.001.md",
    "https://my.f5.com/manage/s/article/K589",
    "https://man.freebsd.org/cgi/man.cgi?pwd_mkdb"
  ],
  "severity": "low",
  "type": "sigma",
  "status": "test",
  "created": "2020-10-08",
  "modified": "2024-12-10",
  "mitre": {
    "tactics": [
      "TA1087"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_1: {\"Image|endswith\": \"/lastlog\"}\nselection_2: {\"CommandLine|contains\": \"'x:0:'\"}\nselection_3: {\"Image|endswith\": [\"/cat\", \"/ed\", \"/head\", \"/more\", \"/nano\", \"/tail\", \"/vi\", \"/vim\", \"/less\", \"/emacs\", \"/sqlite3\", \"/makemap\"], \"CommandLine|contains\": [\"/etc/passwd\", \"/etc/shadow\", \"/etc/sudoers\", \"/etc/spwd.db\", \"/etc/pwd.db\", \"/etc/master.passwd\"]}\nselection_4: {\"Image|endswith\": \"/id\"}\nselection_5: {\"Image|endswith\": \"/lsof\", \"CommandLine|contains\": \"-u\"}",
    "condition": "1 of selection*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate administration activities"
  ],
  "level": "low",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "linux",
    "process_creation"
  ]
}