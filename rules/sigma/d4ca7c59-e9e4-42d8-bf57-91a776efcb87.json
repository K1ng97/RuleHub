{
  "id": "d4ca7c59-e9e4-42d8-bf57-91a776efcb87",
  "name": "LOLBIN Execution From Abnormal Drive",
  "description": "Detects LOLBINs executing from an abnormal or uncommon drive such as a mounted ISO.",
  "source": {
    "type": "sigma",
    "id": "d4ca7c59-e9e4-42d8-bf57-91a776efcb87",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_susp_lolbin_exec_from_non_c_drive.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_susp_lolbin_exec_from_non_c_drive.yml"
  },
  "tags": [
    "attackdefense-evasion"
  ],
  "author": "Christopher Peacock '@securepeacock', SCYTHE '@scythe_io', Angelo Violetti - SEC Consult '@angelo_violetti', Aaron Herman",
  "references": [
    "https://thedfirreport.com/2021/12/13/diavol-ransomware/",
    "https://www.scythe.io/library/threat-emulation-qakbot",
    "https://sec-consult.com/blog/detail/bumblebee-hunting-with-a-velociraptor/"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-01-25",
  "modified": "2023-08-29",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection: [{\"Image|endswith\": [\"\\\\calc.exe\", \"\\\\certutil.exe\", \"\\\\cmstp.exe\", \"\\\\cscript.exe\", \"\\\\installutil.exe\", \"\\\\mshta.exe\", \"\\\\regsvr32.exe\", \"\\\\rundll32.exe\", \"\\\\wscript.exe\"]}, {\"OriginalFileName\": [\"CALC.EXE\", \"CertUtil.exe\", \"CMSTP.EXE\", \"cscript.exe\", \"installutil.exe\", \"MSHTA.EXE\", \"REGSVR32.EXE\", \"RUNDLL32.EXE\", \"wscript.exe\"]}]\nfilter_main_currentdirectory: {\"CurrentDirectory|contains\": \"C:\\\\\"}\nfilter_main_empty: {\"CurrentDirectory\": \"\"}\nfilter_main_null: {\"CurrentDirectory\": null}",
    "condition": "selection and not 1 of filter_main_*",
    "fields": []
  },
  "falsepositives": [
    "Rare false positives could occur on servers with multiple drives."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}