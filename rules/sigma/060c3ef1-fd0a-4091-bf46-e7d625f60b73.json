{
  "id": "060c3ef1-fd0a-4091-bf46-e7d625f60b73",
  "name": "Suspicious Get-ADReplAccount",
  "description": "The DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory.\nThese include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.\n",
  "source": {
    "type": "sigma",
    "id": "060c3ef1-fd0a-4091-bf46-e7d625f60b73",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_ps_get_adreplaccount.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_script/posh_ps_get_adreplaccount.yml"
  },
  "tags": [
    "attackcredential-access",
    "attackt1003006"
  ],
  "author": "frack113",
  "references": [
    "https://www.powershellgallery.com/packages/DSInternals",
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.006/T1003.006.md#atomic-test-2---run-dsinternals-get-adreplaccount"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-02-06",
  "modified": "2022-02-06",
  "mitre": {
    "tactics": [
      "TA1003"
    ],
    "techniques": [
      "T006"
    ]
  },
  "detection": {
    "query": "selection: {\"ScriptBlockText|contains|all\": [\"Get-ADReplAccount\", \"-All \", \"-Server \"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Legitimate PowerShell scripts"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_script"
  ]
}