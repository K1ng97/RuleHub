{
  "id": "add64136-62e5-48ea-807e-88638d02df1e",
  "name": "Fsutil Suspicious Invocation",
  "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc).\nMight be used by ransomwares during the attack (seen by NotPetya and others).\n",
  "source": {
    "type": "sigma",
    "id": "add64136-62e5-48ea-807e-88638d02df1e",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_fsutil_usage.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_fsutil_usage.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackimpact",
    "attackt1070",
    "attackt1485"
  ],
  "author": "Ecco, E.M. Anhaus, oscd.community",
  "references": [
    "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn",
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070/T1070.md",
    "https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html",
    "https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md",
    "https://blog.cluster25.duskrise.com/2023/05/22/back-in-black-blackbyte-nt"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "stable",
  "created": "2019-09-26",
  "modified": "2023-09-09",
  "mitre": {
    "tactics": [
      "TA1070",
      "TA1485"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: [{\"Image|endswith\": \"\\\\fsutil.exe\"}, {\"OriginalFileName\": \"fsutil.exe\"}]\nselection_cli: {\"CommandLine|contains\": [\"deletejournal\", \"createjournal\", \"setZeroData\"]}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Admin activity",
    "Scripts and administrative tools used in the monitored environment"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}