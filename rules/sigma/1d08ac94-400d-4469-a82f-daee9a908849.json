{
  "id": "1d08ac94-400d-4469-a82f-daee9a908849",
  "name": "Communication To Ngrok Tunneling Service Initiated",
  "description": "Detects an executable initiating a network connection to \"ngrok\" tunneling domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
  "source": {
    "type": "sigma",
    "id": "1d08ac94-400d-4469-a82f-daee9a908849",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/net_connection_win_domain_ngrok_tunnel.yml",
    "file_path": "tmp/repos/sigma/rules/windows/network_connection/net_connection_win_domain_ngrok_tunnel.yml"
  },
  "tags": [
    "attackcommand-and-control",
    "attackexfiltration",
    "attacks0508",
    "attackt1090",
    "attackt1102",
    "attackt1567",
    "attackt1568002",
    "attackt1572"
  ],
  "author": "Florian Roth (Nextron Systems)",
  "references": [
    "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
    "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2022-11-03",
  "modified": "2024-02-02",
  "mitre": {
    "tactics": [
      "TA1090",
      "TA1102",
      "TA1567",
      "TA1568",
      "TA1572"
    ],
    "techniques": [
      "T002"
    ]
  },
  "detection": {
    "query": "selection: {\"DestinationHostname|contains\": [\"tunnel.us.ngrok.com\", \"tunnel.eu.ngrok.com\", \"tunnel.ap.ngrok.com\", \"tunnel.au.ngrok.com\", \"tunnel.sa.ngrok.com\", \"tunnel.jp.ngrok.com\", \"tunnel.in.ngrok.com\"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use of the ngrok service."
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "network_connection"
  ]
}