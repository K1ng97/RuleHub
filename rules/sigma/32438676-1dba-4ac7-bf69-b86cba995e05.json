{
  "id": "32438676-1dba-4ac7-bf69-b86cba995e05",
  "name": "GCP Access Policy Deleted",
  "description": "Detects when an access policy that is applied to a GCP cloud resource is deleted.\nAn adversary would be able to remove access policies to gain access to a GCP cloud resource.\n",
  "source": {
    "type": "sigma",
    "id": "32438676-1dba-4ac7-bf69-b86cba995e05",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/gcp_access_policy_deleted.yml",
    "file_path": "tmp/repos/sigma/rules/cloud/gcp/audit/gcp_access_policy_deleted.yml"
  },
  "tags": [
    "attackpersistence",
    "attackprivilege-escalation",
    "attackt1098"
  ],
  "author": "Bryan Lim",
  "references": [
    "https://cloud.google.com/access-context-manager/docs/audit-logging",
    "https://cloud.google.com/logging/docs/audit/understanding-audit-logs",
    "https://cloud.google.com/logging/docs/reference/audit/auditlog/rest/Shared.Types/AuditLog"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2024-01-12",
  "modified": "2024-01-12",
  "mitre": {
    "tactics": [
      "TA1098"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"data.protoPayload.authorizationInfo.permission\": [\"accesscontextmanager.accessPolicies.delete\", \"accesscontextmanager.accessPolicies.accessLevels.delete\", \"accesscontextmanager.accessPolicies.accessZones.delete\", \"accesscontextmanager.accessPolicies.authorizedOrgsDescs.delete\"], \"data.protoPayload.authorizationInfo.granted\": \"true\", \"data.protoPayload.serviceName\": \"accesscontextmanager.googleapis.com\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Legitimate administrative activities"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "gcp",
    "gcp.audit"
  ]
}