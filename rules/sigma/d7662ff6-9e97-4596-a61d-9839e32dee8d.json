{
  "id": "d7662ff6-9e97-4596-a61d-9839e32dee8d",
  "name": "Add SafeBoot Keys Via Reg Utility",
  "description": "Detects execution of \"reg.exe\" commands with the \"add\" or \"copy\" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not",
  "source": {
    "type": "sigma",
    "id": "d7662ff6-9e97-4596-a61d-9839e32dee8d",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_reg_add_safeboot.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1562001"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2022-09-02",
  "modified": "2024-03-19",
  "mitre": {
    "tactics": [
      "TA1562"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_img: [{\"Image|endswith\": \"\\\\reg.exe\"}, {\"OriginalFileName\": \"reg.exe\"}]\nselection_safeboot: {\"CommandLine|contains\": \"\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\"}\nselection_flag: {\"CommandLine|contains\": [\" copy \", \" add \"]}",
    "condition": "all of selection*",
    "fields": []
  },
  "falsepositives": [
    "Unlikely"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}