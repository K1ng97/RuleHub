{
  "id": "dcd74b95-3f36-4ed9-9598-0490951643aa",
  "name": "PowerView PowerShell Cmdlets - ScriptBlock",
  "description": "Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.",
  "source": {
    "type": "sigma",
    "id": "dcd74b95-3f36-4ed9-9598-0490951643aa",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_ps_powerview_malicious_commandlets.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_script/posh_ps_powerview_malicious_commandlets.yml"
  },
  "tags": [
    "attackexecution",
    "attackt1059001"
  ],
  "author": "Bhabesh Raj",
  "references": [
    "https://powersploit.readthedocs.io/en/stable/Recon/README",
    "https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon",
    "https://thedfirreport.com/2020/10/08/ryuks-return",
    "https://adsecurity.org/?p=2277"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2021-05-18",
  "modified": "2023-11-22",
  "mitre": {
    "tactics": [
      "TA1059"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection: {\"ScriptBlockText|contains\": [\"Export-PowerViewCSV\", \"Find-DomainLocalGroupMember\", \"Find-DomainObjectPropertyOutlier\", \"Find-DomainProcess\", \"Find-DomainShare\", \"Find-DomainUserEvent\", \"Find-DomainUserLocation\", \"Find-ForeignGroup\", \"Find-ForeignUser\", \"Find-GPOComputerAdmin\", \"Find-GPOLocation\", \"Find-InterestingDomain\", \"Find-InterestingFile\", \"Find-LocalAdminAccess\", \"Find-ManagedSecurityGroups\", \"Get-CachedRDPConnection\", \"Get-DFSshare\", \"Get-DomainDFSShare\", \"Get-DomainDNSRecord\", \"Get-DomainDNSZone\", \"Get-DomainFileServer\", \"Get-DomainGPOComputerLocalGroupMapping\", \"Get-DomainGPOLocalGroup\", \"Get-DomainGPOUserLocalGroupMapping\", \"Get-LastLoggedOn\", \"Get-LoggedOnLocal\", \"Get-NetFileServer\", \"Get-NetForest\", \"Get-NetGPOGroup\", \"Get-NetProcess\", \"Get-NetRDPSession\", \"Get-RegistryMountedDrive\", \"Get-RegLoggedOn\", \"Get-WMIRegCachedRDPConnection\", \"Get-WMIRegLastLoggedOn\", \"Get-WMIRegMountedDrive\", \"Get-WMIRegProxy\", \"Invoke-ACLScanner\", \"Invoke-CheckLocalAdminAccess\", \"Invoke-EnumerateLocalAdmin\", \"Invoke-EventHunter\", \"Invoke-FileFinder\", \"Invoke-Kerberoast\", \"Invoke-MapDomainTrust\", \"Invoke-ProcessHunter\", \"Invoke-RevertToSelf\", \"Invoke-ShareFinder\", \"Invoke-UserHunter\", \"Invoke-UserImpersonation\", \"Remove-RemoteConnection\", \"Request-SPNTicket\", \"Resolve-IPAddress\"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_script"
  ]
}