{
  "id": "0f6da907-5854-4be6-859a-e9958747b0aa",
  "name": "Potential DLL Injection Via AccCheckConsole",
  "description": "Detects the execution \"AccCheckConsole\" a command-line tool for verifying the accessibility implementation of an application's UI.\nOne of the tests that this checker can run are called \"verification routine\", which tests for things like Consistency, Navigation, etc.\nThe tool allows a user to provide a DLL that can contain a custom \"verification routine\". An attacker can build such DLLs and pass it via the CLI, which would then be loaded in the context of the \"AccCheckConsole\" utility.\n",
  "source": {
    "type": "sigma",
    "id": "0f6da907-5854-4be6-859a-e9958747b0aa",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_acccheckconsole_execution.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_acccheckconsole_execution.yml"
  },
  "tags": [
    "attackexecution",
    "detectionthreat-hunting"
  ],
  "author": "Florian Roth (Nextron Systems)",
  "references": [
    "https://gist.github.com/bohops/2444129419c8acf837aedda5f0e7f340",
    "https://twitter.com/bohops/status/1477717351017680899?s=12",
    "https://lolbas-project.github.io/lolbas/OtherMSBinaries/AccCheckConsole/"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-01-06",
  "modified": "2024-08-29",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: [{\"Image|endswith\": \"\\\\AccCheckConsole.exe\"}, {\"OriginalFileName\": \"AccCheckConsole.exe\"}]\nselection_cli: {\"CommandLine|contains\": [\" -hwnd\", \" -process \", \" -window \"]}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use of the UI Accessibility Checker"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}