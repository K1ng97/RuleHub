{
  "id": "74176142-4684-4d8a-8b0a-713257e7df8e",
  "name": "Potential Active Directory Enumeration Using AD Module - PsModule",
  "description": "Detects usage of the \"Import-Module\" cmdlet to load the \"Microsoft.ActiveDirectory.Management.dl\" DLL. Which is often used by attackers to perform AD enumeration.",
  "source": {
    "type": "sigma",
    "id": "74176142-4684-4d8a-8b0a-713257e7df8e",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_pm_active_directory_module_dll_import.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_module/posh_pm_active_directory_module_dll_import.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackimpact",
    "attackreconnaissance"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
  "references": [
    "https://github.com/samratashok/ADModule",
    "https://twitter.com/cyb3rops/status/1617108657166061568?s=20",
    "https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2023-01-22",
  "modified": "2023-01-22",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection_cmdlet: {\"Payload|contains\": [\"Import-Module \", \"ipmo \"]}\nselection_dll: {\"Payload|contains\": \"Microsoft.ActiveDirectory.Management.dll\"}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use of the library for administrative activity"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_module"
  ]
}