{
  "id": "d223b46b-5621-4037-88fe-fda32eead684",
  "name": "New Root or CA or AuthRoot Certificate to Store",
  "description": "Detects the addition of new root, CA or AuthRoot certificates to the Windows registry",
  "source": {
    "type": "sigma",
    "id": "d223b46b-5621-4037-88fe-fda32eead684",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/registry_set_install_root_or_ca_certificat.yml",
    "file_path": "tmp/repos/sigma/rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml"
  },
  "tags": [
    "attackimpact",
    "attackt1490"
  ],
  "author": "frack113",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md#atomic-test-6---add-root-certificate-to-currentuser-certificate-store",
    "https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-04-04",
  "modified": "2023-08-17",
  "mitre": {
    "tactics": [
      "TA1490"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"TargetObject|contains\": [\"\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\Root\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\Root\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\CA\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\CA\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\CA\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Microsoft\\\\SystemCertificates\\\\AuthRoot\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\SystemCertificates\\\\AuthRoot\\\\Certificates\\\\\", \"\\\\SOFTWARE\\\\Microsoft\\\\EnterpriseCertificates\\\\AuthRoot\\\\Certificates\\\\\"], \"TargetObject|endswith\": \"\\\\Blob\", \"Details\": \"Binary Data\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "registry_set"
  ]
}