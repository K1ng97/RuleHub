{
  "id": "0c3fac91-5627-46e8-a6a8-a0d7b9b8ae1b",
  "name": "Suspicious Get-Variable.exe Creation",
  "description": "Get-Variable is a valid PowerShell cmdlet\nWindowsApps is by default in the path where PowerShell is executed.\nSo when the Get-Variable command is issued on PowerShell execution, the system first looks for the Get-Variable executable in the path and executes the malicious binary instead of looking for the PowerShell cmdlet.\n",
  "source": {
    "type": "sigma",
    "id": "0c3fac91-5627-46e8-a6a8-a0d7b9b8ae1b",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/file_event_win_susp_get_variable.yml",
    "file_path": "tmp/repos/sigma/rules/windows/file/file_event/file_event_win_susp_get_variable.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackpersistence",
    "attackt1027",
    "attackt1546"
  ],
  "author": "frack113",
  "references": [
    "https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/",
    "https://www.joesandbox.com/analysis/465533/0/html"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2022-04-23",
  "modified": "2022-04-23",
  "mitre": {
    "tactics": [
      "TA1027",
      "TA1546"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"TargetFilename|endswith\": \"Local\\\\Microsoft\\\\WindowsApps\\\\Get-Variable.exe\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "file_event"
  ]
}