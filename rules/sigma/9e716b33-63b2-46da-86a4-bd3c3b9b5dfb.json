{
  "id": "9e716b33-63b2-46da-86a4-bd3c3b9b5dfb",
  "name": "Certificate Exported Via PowerShell",
  "description": "Detects calls to cmdlets that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines.",
  "source": {
    "type": "sigma",
    "id": "9e716b33-63b2-46da-86a4-bd3c3b9b5dfb",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_powershell_export_certificate.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_powershell_export_certificate.yml"
  },
  "tags": [
    "attackcredential-access",
    "attackexecution",
    "attackt1059001",
    "attackt1552004"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a",
    "https://learn.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate?view=windowsserver2022-ps",
    "https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2023-05-18",
  "modified": "2023-05-18",
  "mitre": {
    "tactics": [
      "TA1059",
      "TA1552"
    ],
    "techniques": [
      "T001",
      "T004"
    ]
  },
  "detection": {
    "query": "selection: {\"CommandLine|contains\": [\"Export-PfxCertificate \", \"Export-Certificate \"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Legitimate certificate exports by administrators. Additional filters might be required."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}