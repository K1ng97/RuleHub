{
  "id": "e7be6119-fc37-43f0-ad4f-1f3f99be2f9f",
  "name": "Copying Sensitive Files with Credential Data",
  "description": "Files with well-known filenames (sensitive files with credential data) copying",
  "source": {
    "type": "sigma",
    "id": "e7be6119-fc37-43f0-ad4f-1f3f99be2f9f",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_esentutl_sensitive_file_copy.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_esentutl_sensitive_file_copy.yml"
  },
  "tags": [
    "attackcredential-access",
    "attacks0404",
    "attackt1003002",
    "attackt1003003",
    "car2013-07-001"
  ],
  "author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
  "references": [
    "https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/",
    "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
    "https://dfironthemountain.wordpress.com/2018/12/06/locked-file-access-using-esentutl-exe/",
    "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Esentutl.yml"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2019-10-22",
  "modified": "2024-06-04",
  "mitre": {
    "tactics": [
      "TA1003"
    ],
    "techniques": [
      "T002",
      "T003"
    ]
  },
  "detection": {
    "query": "selection_esent_img: [{\"Image|endswith\": \"\\\\esentutl.exe\"}, {\"OriginalFileName\": \"\\\\esentutl.exe\"}]\nselection_esent_cli: {\"CommandLine|contains|windash\": [\"vss\", \" /m \", \" /y \"]}\nselection_susp_paths: {\"CommandLine|contains\": [\"\\\\config\\\\RegBack\\\\sam\", \"\\\\config\\\\RegBack\\\\security\", \"\\\\config\\\\RegBack\\\\system\", \"\\\\config\\\\sam\", \"\\\\config\\\\security\", \"\\\\config\\\\system \", \"\\\\repair\\\\sam\", \"\\\\repair\\\\security\", \"\\\\repair\\\\system\", \"\\\\windows\\\\ntds\\\\ntds.dit\"]}",
    "condition": "all of selection_esent_* or selection_susp_paths",
    "fields": []
  },
  "falsepositives": [
    "Copying sensitive files for legitimate use (eg. backup) or forensic investigation by legitimate incident responder or forensic investigator."
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}