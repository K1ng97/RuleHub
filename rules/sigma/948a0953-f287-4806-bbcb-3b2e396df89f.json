{
  "id": "948a0953-f287-4806-bbcb-3b2e396df89f",
  "name": "Unsigned Mfdetours.DLL Sideloading",
  "description": "Detects DLL sideloading of unsigned \"mfdetours.dll\". Executing \"mftrace.exe\" can be abused to attach to an arbitrary process and force load any DLL named \"mfdetours.dll\" from the current directory of execution.",
  "source": {
    "type": "sigma",
    "id": "948a0953-f287-4806-bbcb-3b2e396df89f",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/image_load_side_load_mfdetours_unsigned.yml",
    "file_path": "tmp/repos/sigma/rules/windows/image_load/image_load_side_load_mfdetours_unsigned.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackprivilege-escalation",
    "attackt1574001"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "Internal Research"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2023-08-11",
  "modified": "2023-08-11",
  "mitre": {
    "tactics": [
      "TA1574"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection: {\"ImageLoaded|endswith\": \"\\\\mfdetours.dll\"}\nfilter_main_legit_path: {\"ImageLoaded|contains\": \":\\\\Program Files (x86)\\\\Windows Kits\\\\10\\\\bin\\\\\", \"SignatureStatus\": \"Valid\"}",
    "condition": "selection and not 1 of filter_main_*",
    "fields": []
  },
  "falsepositives": [
    "Unlikely"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "image_load"
  ]
}