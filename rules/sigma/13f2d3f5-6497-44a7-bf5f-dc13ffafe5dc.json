{
  "id": "13f2d3f5-6497-44a7-bf5f-dc13ffafe5dc",
  "name": "Azure Login Bypassing Conditional Access Policies",
  "description": "Detects a successful login to the Microsoft Intune Company Portal which could allow bypassing Conditional Access Policies and InTune device trust using a tool like TokenSmith.\n",
  "source": {
    "type": "sigma",
    "id": "13f2d3f5-6497-44a7-bf5f-dc13ffafe5dc",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/microsoft365_bypass_conditional_access.yml",
    "file_path": "tmp/repos/sigma/rules/cloud/m365/audit/microsoft365_bypass_conditional_access.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1078"
  ],
  "author": "Josh Nickels, Marius Rothenb√ºcher",
  "references": [
    "https://labs.jumpsec.com/tokensmith-bypassing-intune-compliant-device-conditional-access/",
    "https://github.com/JumpsecLabs/TokenSmith"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "experimental",
  "created": "2025-01-08",
  "modified": "2025-01-08",
  "mitre": {
    "tactics": [
      "TA1078"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"Operation\": \"UserLoggedIn\", \"ApplicationId\": \"9ba1a5c7-f17a-4de9-a1f1-6178c8d51223\", \"ResultStatus\": \"Success\", \"RequestType\": \"Cmsi:Cmsi\"}\nfilter_main_bjectid: {\"ObjectId\": \"0000000a-0000-0000-c000-000000000000\"}",
    "condition": "selection and not 1 of filter_main_*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "m365",
    "audit"
  ]
}