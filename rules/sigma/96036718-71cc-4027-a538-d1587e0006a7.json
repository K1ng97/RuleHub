{
  "id": "96036718-71cc-4027-a538-d1587e0006a7",
  "name": "Windows Processes Suspicious Parent Directory",
  "description": "Detect suspicious parent processes of well-known Windows processes",
  "source": {
    "type": "sigma",
    "id": "96036718-71cc-4027-a538-d1587e0006a7",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_susp_proc_wrong_parent.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_susp_proc_wrong_parent.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1036003",
    "attackt1036005"
  ],
  "author": "vburov",
  "references": [
    "https://web.archive.org/web/20180718061628/https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2",
    "https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/",
    "https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf"
  ],
  "severity": "low",
  "type": "sigma",
  "status": "test",
  "created": "2019-02-23",
  "modified": "2025-03-06",
  "mitre": {
    "tactics": [
      "TA1036"
    ],
    "techniques": [
      "T003",
      "T005"
    ]
  },
  "detection": {
    "query": "selection: {\"Image|endswith\": [\"\\\\svchost.exe\", \"\\\\taskhost.exe\", \"\\\\lsm.exe\", \"\\\\lsass.exe\", \"\\\\services.exe\", \"\\\\lsaiso.exe\", \"\\\\csrss.exe\", \"\\\\wininit.exe\", \"\\\\winlogon.exe\"]}\nfilter_sys: [{\"ParentImage|endswith\": [\"\\\\SavService.exe\", \"\\\\ngen.exe\"]}, {\"ParentImage|contains\": [\"\\\\System32\\\\\", \"\\\\SysWOW64\\\\\"]}]\nfilter_msmpeng: {\"ParentImage|contains\": [\"\\\\Windows Defender\\\\\", \"\\\\Microsoft Security Client\\\\\"], \"ParentImage|endswith\": \"\\\\MsMpEng.exe\"}\nfilter_null: [{\"ParentImage\": null}, {\"ParentImage\": [\"\", \"-\"]}]",
    "condition": "selection and not 1 of filter_*",
    "fields": []
  },
  "falsepositives": [
    "Some security products seem to spawn these"
  ],
  "level": "low",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}