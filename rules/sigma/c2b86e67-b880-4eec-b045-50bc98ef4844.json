{
  "id": "c2b86e67-b880-4eec-b045-50bc98ef4844",
  "name": "HackTool - LaZagne Execution",
  "description": "Detects the execution of the LaZagne. A utility used to retrieve multiple types of passwords stored on a local computer.\nLaZagne has been leveraged multiple times by threat actors in order to dump credentials.\n",
  "source": {
    "type": "sigma",
    "id": "c2b86e67-b880-4eec-b045-50bc98ef4844",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_hktl_lazagne.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_hktl_lazagne.yml"
  },
  "tags": [
    "attackcredential-access"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://github.com/AlessandroZ/LaZagne/tree/master",
    "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/",
    "https://cloud.google.com/blog/topics/threat-intelligence/alphv-ransomware-backup/",
    "https://securelist.com/defttorero-tactics-techniques-and-procedures/107610/",
    "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/800c0e06571993a54e39571cf27fd474dcc5c0bc/2017/2017.11.14.Muddying_the_Water/muddying-the-water-targeted-attacks.pdf"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "experimental",
  "created": "2024-06-24",
  "modified": "2024-08-16",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: {\"Image|endswith\": \"\\\\lazagne.exe\"}\nselection_clionly: {\"Image|contains\": [\":\\\\PerfLogs\\\\\", \":\\\\ProgramData\\\\\", \":\\\\Temp\\\\\", \":\\\\Tmp\\\\\", \":\\\\Windows\\\\Temp\\\\\", \"\\\\AppData\\\\\", \"\\\\Downloads\\\\\", \"\\\\Users\\\\Public\\\\\"], \"CommandLine|endswith\": [\".exe all\", \".exe browsers\", \".exe chats\", \".exe databases\", \".exe games\", \".exe git\", \".exe mails\", \".exe maven\", \".exe memory\", \".exe multimedia\", \".exe sysadmin\", \".exe unused\", \".exe wifi\", \".exe windows\"]}\nselection_cli_modules: {\"CommandLine|contains\": [\"all \", \"browsers \", \"chats \", \"databases \", \"games \", \"git \", \"mails \", \"maven \", \"memory \", \"multimedia \", \"php \", \"svn \", \"sysadmin \", \"unused \", \"wifi \", \"windows \"]}\nselection_cli_options: {\"CommandLine|contains\": [\"-oA\", \"-oJ\", \"-oN\", \"-output\", \"-password\", \"-1Password\", \"-apachedirectorystudio\", \"-autologon\", \"-ChromiumBased\", \"-composer\", \"-coreftp\", \"-credfiles\", \"-credman\", \"-cyberduck\", \"-dbvis\", \"-EyeCon\", \"-filezilla\", \"-filezillaserver\", \"-ftpnavigator\", \"-galconfusion\", \"-gitforwindows\", \"-hashdump\", \"-iisapppool\", \"-IISCentralCertP\", \"-kalypsomedia\", \"-keepass\", \"-keepassconfig\", \"-lsa_secrets\", \"-mavenrepositories\", \"-memory_dump\", \"-Mozilla\", \"-mRemoteNG\", \"-mscache\", \"-opensshforwindows\", \"-openvpn\", \"-outlook\", \"-pidgin\", \"-postgresql\", \"-psi-im\", \"-puttycm\", \"-pypykatz\", \"-Rclone\", \"-rdpmanager\", \"-robomongo\", \"-roguestale\", \"-skype\", \"-SQLDeveloper\", \"-squirrel\", \"-tortoise\", \"-turba\", \"-UCBrowser\", \"-unattended\", \"-vault\", \"-vaultfiles\", \"-vnc\", \"-windows\", \"-winscp\", \"-wsl\"]}",
    "condition": "selection_img or selection_clionly or (selection_cli_modules and selection_cli_options)",
    "fields": []
  },
  "falsepositives": [
    "Some false positive is expected from tools with similar command line flags."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}