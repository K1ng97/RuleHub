{
  "id": "f41dada5-3f56-4232-8503-3fb7f9cf2d60",
  "name": "ESXi Storage Information Discovery Via ESXCLI",
  "description": "Detects execution of the \"esxcli\" command with the \"storage\" flag in order to retrieve information about the storage status and other related information. Seen used by malware such as DarkSide and LockBit.",
  "source": {
    "type": "sigma",
    "id": "f41dada5-3f56-4232-8503-3fb7f9cf2d60",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_lnx_esxcli_storage_discovery.yml",
    "file_path": "tmp/repos/sigma/rules/linux/process_creation/proc_creation_lnx_esxcli_storage_discovery.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackt1007",
    "attackt1033"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems), Cedric Maurugeon",
  "references": [
    "https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html",
    "https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html",
    "https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/namespace/esxcli_storage.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2023-09-04",
  "modified": "2023-09-04",
  "mitre": {
    "tactics": [
      "TA1007",
      "TA1033"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: {\"Image|endswith\": \"/esxcli\", \"CommandLine|contains\": \"storage\"}\nselection_cli: {\"CommandLine|contains\": [\" get\", \" list\"]}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate administration activities"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "linux",
    "process_creation"
  ]
}