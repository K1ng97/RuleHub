{
  "id": "f748c45a-f8d3-4e6f-b617-fe176f695b8f",
  "name": ".RDP File Created by Outlook Process",
  "description": "Detects the creation of files with the \".rdp\" extensions in the temporary directory that Outlook uses when opening attachments.\nThis can be used to detect spear-phishing campaigns that use RDP files as attachments.\n",
  "source": {
    "type": "sigma",
    "id": "f748c45a-f8d3-4e6f-b617-fe176f695b8f",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/file_event_win_office_outlook_rdp_file_creation.yml",
    "file_path": "tmp/repos/sigma/rules/windows/file/file_event/file_event_win_office_outlook_rdp_file_creation.yml"
  },
  "tags": [
    "attackdefense-evasion"
  ],
  "author": "Florian Roth",
  "references": [
    "https://thecyberexpress.com/rogue-rdp-files-used-in-ukraine-cyberattacks/",
    "https://www.microsoft.com/en-us/security/blog/2024/10/29/midnight-blizzard-conducts-large-scale-spear-phishing-campaign-using-rdp-files/",
    "https://www.linkedin.com/feed/update/urn:li:ugcPost:7257437202706493443?commentUrn=urn%3Ali%3Acomment%3A%28ugcPost%3A7257437202706493443%2C7257522819985543168%29&dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287257522819985543168%2Curn%3Ali%3AugcPost%3A7257437202706493443%29"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "experimental",
  "created": "2024-11-01",
  "modified": "2024-11-03",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection_extension: {\"TargetFilename|endswith\": \".rdp\"}\nselection_location: [{\"TargetFilename|contains\": [\"\\\\AppData\\\\Local\\\\Packages\\\\Microsoft.Outlook_\", \"\\\\AppData\\\\Local\\\\Microsoft\\\\Olk\\\\Attachments\\\\\"]}, {\"TargetFilename|contains|all\": [\"\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\\", \"\\\\Content.Outlook\\\\\"]}]",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Whenever someone receives an RDP file as an email attachment and decides to save or open it right from the attachments"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "file_event"
  ]
}