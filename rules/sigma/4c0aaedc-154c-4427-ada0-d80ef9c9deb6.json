{
  "id": "4c0aaedc-154c-4427-ada0-d80ef9c9deb6",
  "name": "Process Access via TrolleyExpress Exclusion",
  "description": "Detects a possible process memory dump that uses the white-listed Citrix TrolleyExpress.exe filename as a way to dump the lsass process memory",
  "source": {
    "type": "sigma",
    "id": "4c0aaedc-154c-4427-ada0-d80ef9c9deb6",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_citrix_trolleyexpress_procdump.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_citrix_trolleyexpress_procdump.yml"
  },
  "tags": [
    "attackcredential-access",
    "attackdefense-evasion",
    "attackt1003001",
    "attackt1218011"
  ],
  "author": "Florian Roth (Nextron Systems)",
  "references": [
    "https://twitter.com/_xpn_/status/1491557187168178176",
    "https://www.youtube.com/watch?v=Ie831jF0bb0"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2022-02-10",
  "modified": "2022-05-13",
  "mitre": {
    "tactics": [
      "TA1003",
      "TA1218"
    ],
    "techniques": [
      "T001",
      "T011"
    ]
  },
  "detection": {
    "query": "selection: {\"CommandLine|contains\": [\"\\\\TrolleyExpress 7\", \"\\\\TrolleyExpress 8\", \"\\\\TrolleyExpress 9\", \"\\\\TrolleyExpress.exe 7\", \"\\\\TrolleyExpress.exe 8\", \"\\\\TrolleyExpress.exe 9\", \"\\\\TrolleyExpress.exe -ma \"]}\nrenamed: {\"Image|endswith\": \"\\\\TrolleyExpress.exe\"}\nfilter_renamed: {\"OriginalFileName|contains\": \"CtxInstall\"}\nfilter_empty: {\"OriginalFileName\": null}",
    "condition": "selection or ( renamed and not 1 of filter* )",
    "fields": [
      "CommandLine",
      "ParentCommandLine"
    ]
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}