{
  "id": "a10a2c40-2c4d-49f8-b557-1a946bc55d9d",
  "name": "Uncommon File Created In Office Startup Folder",
  "description": "Detects the creation of a file with an uncommon extension in an Office application startup folder",
  "source": {
    "type": "sigma",
    "id": "a10a2c40-2c4d-49f8-b557-1a946bc55d9d",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/file_event_win_office_uncommon_file_startup.yml",
    "file_path": "tmp/repos/sigma/rules/windows/file/file_event/file_event_win_office_uncommon_file_startup.yml"
  },
  "tags": [
    "attackresource-development",
    "attackt1587001"
  ],
  "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://app.any.run/tasks/d6fe6624-6ef8-485d-aa75-3d1bdda2a08c/",
    "http://addbalance.com/word/startup.htm",
    "https://answers.microsoft.com/en-us/msoffice/forum/all/document-in-word-startup-folder-doesnt-open-when/44ab0932-2917-4150-8cdc-2f2cf39e86f3",
    "https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2022-06-05",
  "modified": "2023-12-13",
  "mitre": {
    "tactics": [
      "TA1587"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_word_paths: [{\"TargetFilename|contains\": \"\\\\Microsoft\\\\Word\\\\STARTUP\"}, {\"TargetFilename|contains|all\": [\"\\\\Office\", \"\\\\Program Files\", \"\\\\STARTUP\"]}]\nfilter_exclude_word_ext: {\"TargetFilename|endswith\": [\".docb\", \".docm\", \".docx\", \".dotm\", \".mdb\", \".mdw\", \".pdf\", \".wll\", \".wwl\"]}\nselection_excel_paths: [{\"TargetFilename|contains\": \"\\\\Microsoft\\\\Excel\\\\XLSTART\"}, {\"TargetFilename|contains|all\": [\"\\\\Office\", \"\\\\Program Files\", \"\\\\XLSTART\"]}]\nfilter_exclude_excel_ext: {\"TargetFilename|endswith\": [\".xll\", \".xls\", \".xlsm\", \".xlsx\", \".xlt\", \".xltm\", \".xlw\"]}\nfilter_main_office_click_to_run: {\"Image|contains\": \":\\\\Program Files\\\\Common Files\\\\Microsoft Shared\\\\ClickToRun\\\\\", \"Image|endswith\": \"\\\\OfficeClickToRun.exe\"}\nfilter_main_office_apps: {\"Image|contains\": [\":\\\\Program Files\\\\Microsoft Office\\\\\", \":\\\\Program Files (x86)\\\\Microsoft Office\\\\\"], \"Image|endswith\": [\"\\\\winword.exe\", \"\\\\excel.exe\"]}",
    "condition": "((selection_word_paths and not filter_exclude_word_ext) or (selection_excel_paths and not filter_exclude_excel_ext)) and not 1 of filter_main_*",
    "fields": []
  },
  "falsepositives": [
    "False positive might stem from rare extensions used by other Office utilities."
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "file_event"
  ]
}