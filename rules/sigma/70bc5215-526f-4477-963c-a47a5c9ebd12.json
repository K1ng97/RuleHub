{
  "id": "70bc5215-526f-4477-963c-a47a5c9ebd12",
  "name": "Potential Active Directory Enumeration Using AD Module - ProcCreation",
  "description": "Detects usage of the \"Import-Module\" cmdlet to load the \"Microsoft.ActiveDirectory.Management.dl\" DLL. Which is often used by attackers to perform AD enumeration.",
  "source": {
    "type": "sigma",
    "id": "70bc5215-526f-4477-963c-a47a5c9ebd12",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_powershell_active_directory_module_dll_import.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_powershell_active_directory_module_dll_import.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackimpact",
    "attackreconnaissance"
  ],
  "author": "frack113",
  "references": [
    "https://github.com/samratashok/ADModule",
    "https://twitter.com/cyb3rops/status/1617108657166061568?s=20",
    "https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2023-01-22",
  "modified": "2023-01-22",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: [{\"Image|endswith\": [\"\\\\powershell.exe\", \"\\\\pwsh.exe\"]}, {\"OriginalFileName\": [\"PowerShell.EXE\", \"pwsh.dll\"]}]\nselection_cmdlet: {\"CommandLine|contains\": [\"Import-Module \", \"ipmo \"]}\nselection_dll: {\"CommandLine|contains\": \"Microsoft.ActiveDirectory.Management.dll\"}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use of the library for administrative activity"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}