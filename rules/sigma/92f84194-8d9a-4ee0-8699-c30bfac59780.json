{
  "id": "92f84194-8d9a-4ee0-8699-c30bfac59780",
  "name": "AWS Key Pair Import Activity",
  "description": "Detects the import of SSH key pairs into AWS EC2, which may indicate an attacker attempting to gain unauthorized access to instances. This activity could lead to initial access, persistence, or privilege escalation, potentially compromising sensitive data and operations.\n",
  "source": {
    "type": "sigma",
    "id": "92f84194-8d9a-4ee0-8699-c30bfac59780",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/aws_ec2_import_key_pair_activity.yml",
    "file_path": "tmp/repos/sigma/rules/cloud/aws/cloudtrail/aws_ec2_import_key_pair_activity.yml"
  },
  "tags": [
    "attackinitial-access",
    "attackpersistence",
    "attackprivilege-escalation",
    "attackt1078"
  ],
  "author": "Ivan Saakov",
  "references": [
    "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ImportKeyPair.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "experimental",
  "created": "2024-12-19",
  "modified": "2024-12-19",
  "mitre": {
    "tactics": [
      "TA1078"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"eventSource\": \"ec2.amazonaws.com\", \"eventName\": \"ImportKeyPair\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Legitimate administrative actions by authorized users importing keys for valid purposes.",
    "Automated processes for infrastructure setup may trigger this alert.",
    "Verify the user identity, user agent, and source IP address to ensure they are expected."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "aws",
    "cloudtrail"
  ]
}