{
  "id": "36210e0d-5b19-485d-a087-c096088885f0",
  "name": "Suspicious PowerShell Parameter Substring",
  "description": "Detects suspicious PowerShell invocation with a parameter substring",
  "source": {
    "type": "sigma",
    "id": "36210e0d-5b19-485d-a087-c096088885f0",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_powershell_susp_parameter_variation.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_powershell_susp_parameter_variation.yml"
  },
  "tags": [
    "attackexecution",
    "attackt1059001"
  ],
  "author": "Florian Roth (Nextron Systems), Daniel Bohannon (idea), Roberto Rodriguez (Fix)",
  "references": [
    "http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2019-01-16",
  "modified": "2022-07-14",
  "mitre": {
    "tactics": [
      "TA1059"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection: {\"Image|endswith\": [\"\\\\powershell.exe\", \"\\\\pwsh.exe\"], \"CommandLine|contains\": [\" -windowstyle h \", \" -windowstyl h\", \" -windowsty h\", \" -windowst h\", \" -windows h\", \" -windo h\", \" -wind h\", \" -win h\", \" -wi h\", \" -win h \", \" -win hi \", \" -win hid \", \" -win hidd \", \" -win hidde \", \" -NoPr \", \" -NoPro \", \" -NoProf \", \" -NoProfi \", \" -NoProfil \", \" -nonin \", \" -nonint \", \" -noninte \", \" -noninter \", \" -nonintera \", \" -noninterac \", \" -noninteract \", \" -noninteracti \", \" -noninteractiv \", \" -ec \", \" -encodedComman \", \" -encodedComma \", \" -encodedComm \", \" -encodedCom \", \" -encodedCo \", \" -encodedC \", \" -encoded \", \" -encode \", \" -encod \", \" -enco \", \" -en \", \" -executionpolic \", \" -executionpoli \", \" -executionpol \", \" -executionpo \", \" -executionp \", \" -execution bypass\", \" -executio bypass\", \" -executi bypass\", \" -execut bypass\", \" -execu bypass\", \" -exec bypass\", \" -exe bypass\", \" -ex bypass\", \" -ep bypass\", \" /windowstyle h \", \" /windowstyl h\", \" /windowsty h\", \" /windowst h\", \" /windows h\", \" /windo h\", \" /wind h\", \" /win h\", \" /wi h\", \" /win h \", \" /win hi \", \" /win hid \", \" /win hidd \", \" /win hidde \", \" /NoPr \", \" /NoPro \", \" /NoProf \", \" /NoProfi \", \" /NoProfil \", \" /nonin \", \" /nonint \", \" /noninte \", \" /noninter \", \" /nonintera \", \" /noninterac \", \" /noninteract \", \" /noninteracti \", \" /noninteractiv \", \" /ec \", \" /encodedComman \", \" /encodedComma \", \" /encodedComm \", \" /encodedCom \", \" /encodedCo \", \" /encodedC \", \" /encoded \", \" /encode \", \" /encod \", \" /enco \", \" /en \", \" /executionpolic \", \" /executionpoli \", \" /executionpol \", \" /executionpo \", \" /executionp \", \" /execution bypass\", \" /executio bypass\", \" /executi bypass\", \" /execut bypass\", \" /execu bypass\", \" /exec bypass\", \" /exe bypass\", \" /ex bypass\", \" /ep bypass\"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}