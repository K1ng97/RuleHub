{
  "id": "bae2865c-5565-470d-b505-9496c87d0c30",
  "name": "SMB Spoolss Name Piped Usage",
  "description": "Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.",
  "source": {
    "type": "sigma",
    "id": "bae2865c-5565-470d-b505-9496c87d0c30",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/zeek_dce_rpc_smb_spoolss_named_pipe.yml",
    "file_path": "tmp/repos/sigma/rules/network/zeek/zeek_dce_rpc_smb_spoolss_named_pipe.yml"
  },
  "tags": [
    "attacklateral-movement",
    "attackt1021002"
  ],
  "author": "OTR (Open Threat Research), @neu5ron",
  "references": [
    "https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1",
    "https://dirkjanm.io/a-different-way-of-abusing-zerologon/",
    "https://twitter.com/_dirkjan/status/1309214379003588608"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2018-11-28",
  "modified": "2022-10-09",
  "mitre": {
    "tactics": [
      "TA1021"
    ],
    "techniques": [
      "T002"
    ]
  },
  "detection": {
    "query": "selection: {\"path|endswith\": \"IPC$\", \"name\": \"spoolss\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Domain Controllers that are sometimes, commonly although should not be, acting as printer servers too"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "zeek",
    "smb_files"
  ]
}