{
  "id": "9e620995-f2d8-4630-8430-4afd89f77604",
  "name": "Potential Active Directory Enumeration Using AD Module - PsScript",
  "description": "Detects usage of the \"Import-Module\" cmdlet to load the \"Microsoft.ActiveDirectory.Management.dl\" DLL. Which is often used by attackers to perform AD enumeration.",
  "source": {
    "type": "sigma",
    "id": "9e620995-f2d8-4630-8430-4afd89f77604",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_ps_active_directory_module_dll_import.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_script/posh_ps_active_directory_module_dll_import.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackimpact",
    "attackreconnaissance"
  ],
  "author": "frack113, Nasreddine Bencherchali",
  "references": [
    "https://github.com/samratashok/ADModule",
    "https://twitter.com/cyb3rops/status/1617108657166061568?s=20",
    "https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2023-01-22",
  "modified": "2023-01-22",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection_generic: {\"ScriptBlockText|contains|all\": [\"Import-Module \", \"Microsoft.ActiveDirectory.Management.dll\"]}\nselection_specific: {\"ScriptBlockText|contains\": \"ipmo Microsoft.ActiveDirectory.Management.dll\"}",
    "condition": "1 of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use of the library for administrative activity"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_script"
  ]
}