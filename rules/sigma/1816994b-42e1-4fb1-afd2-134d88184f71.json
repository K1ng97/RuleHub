{
  "id": "1816994b-42e1-4fb1-afd2-134d88184f71",
  "name": "PowerShell Base64 Encoded WMI Classes",
  "description": "Detects calls to base64 encoded WMI class such as \"Win32_ShadowCopy\", \"Win32_ScheduledJob\", etc.",
  "source": {
    "type": "sigma",
    "id": "1816994b-42e1-4fb1-afd2-134d88184f71",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_powershell_base64_wmi_classes.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_powershell_base64_wmi_classes.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackexecution",
    "attackt1027",
    "attackt1059001"
  ],
  "author": "Christian Burkard (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2023-01-30",
  "modified": "2023-01-30",
  "mitre": {
    "tactics": [
      "TA1027",
      "TA1059"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_img: [{\"Image|endswith\": [\"\\\\powershell.exe\", \"\\\\pwsh.exe\"]}, {\"OriginalFileName\": [\"PowerShell.EXE\", \"pwsh.dll\"]}]\nselection_cli_shadowcopy: {\"CommandLine|contains\": [\"VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ\", \"cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA\", \"XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A\", \"V2luMzJfU2hhZG93Y29we\", \"dpbjMyX1NoYWRvd2NvcH\", \"XaW4zMl9TaGFkb3djb3B5\"]}\nselection_cli_scheduledJob: {\"CommandLine|contains\": [\"VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA\", \"cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA\", \"XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg\", \"V2luMzJfU2NoZWR1bGVkSm9i\", \"dpbjMyX1NjaGVkdWxlZEpvY\", \"XaW4zMl9TY2hlZHVsZWRKb2\"]}\nselection_cli_process: {\"CommandLine|contains\": [\"VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw\", \"cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA\", \"XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA\", \"V2luMzJfUHJvY2Vzc\", \"dpbjMyX1Byb2Nlc3\", \"XaW4zMl9Qcm9jZXNz\"]}\nselection_cli_useraccount: {\"CommandLine|contains\": [\"VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A\", \"cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA\", \"XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA\", \"V2luMzJfVXNlckFjY291bn\", \"dpbjMyX1VzZXJBY2NvdW50\", \"XaW4zMl9Vc2VyQWNjb3Vud\"]}\nselection_cli_loggedonuser: {\"CommandLine|contains\": [\"VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA\", \"cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA\", \"XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg\", \"V2luMzJfTG9nZ2VkT25Vc2Vy\", \"dpbjMyX0xvZ2dlZE9uVXNlc\", \"XaW4zMl9Mb2dnZWRPblVzZX\"]}",
    "condition": "selection_img and 1 of selection_cli_*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}