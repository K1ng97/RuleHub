{
  "id": "0e6a9e62-627e-496c-aef5-bfa39da29b5e",
  "name": "MaxMpxCt Registry Value Changed",
  "description": "Detects changes to the \"MaxMpxCt\" registry value.\nMaxMpxCt specifies the maximum outstanding network requests for the server per client, which is used when negotiating a Server Message Block (SMB) connection with a client. Note if the value is set beyond 125 older Windows 9x clients will fail to negotiate.\nRansomware threat actors and operators (specifically BlackCat) were seen increasing this value in order to handle a higher volume of traffic.\n",
  "source": {
    "type": "sigma",
    "id": "0e6a9e62-627e-496c-aef5-bfa39da29b5e",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/registry_set_optimize_file_sharing_network.yml",
    "file_path": "tmp/repos/sigma/rules/windows/registry/registry_set/registry_set_optimize_file_sharing_network.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1070005"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://www.huntress.com/blog/blackcat-ransomware-affiliate-ttps",
    "https://securityscorecard.com/research/deep-dive-into-alphv-blackcat-ransomware",
    "https://www.intrinsec.com/alphv-ransomware-gang-analysis/?cn-reloaded=1",
    "https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/"
  ],
  "severity": "low",
  "type": "sigma",
  "status": "test",
  "created": "2024-03-19",
  "modified": "2024-03-19",
  "mitre": {
    "tactics": [
      "TA1070"
    ],
    "techniques": [
      "T005"
    ]
  },
  "detection": {
    "query": "selection: {\"TargetObject|endswith\": \"\\\\Services\\\\LanmanServer\\\\Parameters\\\\MaxMpxCt\"}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "low",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "registry_set"
  ]
}