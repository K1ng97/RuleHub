{
  "id": "b2317cfa-4a47-4ead-b3ff-297438c0bc2d",
  "name": "HackTool - SharpView Execution",
  "description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems",
  "source": {
    "type": "sigma",
    "id": "b2317cfa-4a47-4ead-b3ff-297438c0bc2d",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_hktl_sharpview.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_hktl_sharpview.yml"
  },
  "tags": [
    "attackdiscovery",
    "attackt1033",
    "attackt1049",
    "attackt1069002",
    "attackt1135",
    "attackt1482"
  ],
  "author": "frack113",
  "references": [
    "https://github.com/tevora-threat/SharpView/",
    "https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1",
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-4---system-discovery-using-sharpview"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2021-12-10",
  "modified": "2023-02-14",
  "mitre": {
    "tactics": [
      "TA1033",
      "TA1049",
      "TA1069",
      "TA1135",
      "TA1482"
    ],
    "techniques": [
      "T002"
    ]
  },
  "detection": {
    "query": "selection: [{\"OriginalFileName\": \"SharpView.exe\"}, {\"Image|endswith\": \"\\\\SharpView.exe\"}, {\"CommandLine|contains\": [\"Add-RemoteConnection\", \"Convert-ADName\", \"ConvertFrom-SID\", \"ConvertFrom-UACValue\", \"Convert-SidToName\", \"Export-PowerViewCSV\", \"Find-DomainObjectPropertyOutlier\", \"Find-DomainProcess\", \"Find-DomainShare\", \"Find-DomainUserEvent\", \"Find-DomainUserLocation\", \"Find-ForeignGroup\", \"Find-ForeignUser\", \"Find-GPOComputerAdmin\", \"Find-GPOLocation\", \"Find-Interesting\", \"Find-LocalAdminAccess\", \"Find-ManagedSecurityGroups\", \"Get-CachedRDPConnection\", \"Get-DFSshare\", \"Get-DomainComputer\", \"Get-DomainController\", \"Get-DomainDFSShare\", \"Get-DomainDNSRecord\", \"Get-DomainFileServer\", \"Get-DomainForeign\", \"Get-DomainGPO\", \"Get-DomainGroup\", \"Get-DomainGUIDMap\", \"Get-DomainManagedSecurityGroup\", \"Get-DomainObject\", \"Get-DomainOU\", \"Get-DomainPolicy\", \"Get-DomainSID\", \"Get-DomainSite\", \"Get-DomainSPNTicket\", \"Get-DomainSubnet\", \"Get-DomainTrust\", \"Get-DomainUserEvent\", \"Get-ForestDomain\", \"Get-ForestGlobalCatalog\", \"Get-ForestTrust\", \"Get-GptTmpl\", \"Get-GroupsXML\", \"Get-LastLoggedOn\", \"Get-LoggedOnLocal\", \"Get-NetComputer\", \"Get-NetDomain\", \"Get-NetFileServer\", \"Get-NetForest\", \"Get-NetGPO\", \"Get-NetGroupMember\", \"Get-NetLocalGroup\", \"Get-NetLoggedon\", \"Get-NetOU\", \"Get-NetProcess\", \"Get-NetRDPSession\", \"Get-NetSession\", \"Get-NetShare\", \"Get-NetSite\", \"Get-NetSubnet\", \"Get-NetUser\", \"Get-PathAcl\", \"Get-PrincipalContext\", \"Get-RegistryMountedDrive\", \"Get-RegLoggedOn\", \"Get-WMIRegCachedRDPConnection\", \"Get-WMIRegLastLoggedOn\", \"Get-WMIRegMountedDrive\", \"Get-WMIRegProxy\", \"Invoke-ACLScanner\", \"Invoke-CheckLocalAdminAccess\", \"Invoke-Kerberoast\", \"Invoke-MapDomainTrust\", \"Invoke-RevertToSelf\", \"Invoke-Sharefinder\", \"Invoke-UserImpersonation\", \"Remove-DomainObjectAcl\", \"Remove-RemoteConnection\", \"Request-SPNTicket\", \"Set-DomainObject\", \"Test-AdminAccess\"]}]",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}