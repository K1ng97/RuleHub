{
  "id": "39f919f3-980b-4e6f-a975-8af7e507ef2b",
  "name": "Critical Hive In Suspicious Location Access Bits Cleared",
  "description": "Detects events from the Kernel-General ETW indicating that the access bits of a hive with a system like hive name located in the temp directory have been reset.\nThis occurs when an application tries to access a hive and the hive has not be recognized since the last 7 days (by default).\nRegistry hive dumping utilities such as QuarksPwDump were seen emitting this behavior.\n",
  "source": {
    "type": "sigma",
    "id": "39f919f3-980b-4e6f-a975-8af7e507ef2b",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/win_system_susp_critical_hive_location_access_bits_cleared.yml",
    "file_path": "tmp/repos/sigma/rules/windows/builtin/system/microsoft_windows_kernel_general/win_system_susp_critical_hive_location_access_bits_cleared.yml"
  },
  "tags": [
    "attackcredential-access",
    "attackt1003002"
  ],
  "author": "Florian Roth (Nextron Systems)",
  "references": [
    "https://github.com/nasbench/Misc-Research/blob/b20da2336de0f342d31ef4794959d28c8d3ba5ba/ETW/Microsoft-Windows-Kernel-General.md"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2017-05-15",
  "modified": "2024-01-18",
  "mitre": {
    "tactics": [
      "TA1003"
    ],
    "techniques": [
      "T002"
    ]
  },
  "detection": {
    "query": "selection: {\"EventID\": 16, \"Provider_Name\": \"Microsoft-Windows-Kernel-General\", \"HiveName|contains\": [\"\\\\Temp\\\\SAM\", \"\\\\Temp\\\\SECURITY\"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "system"
  ]
}