{
  "id": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
  "name": "Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution",
  "description": "Detects potentially suspicious child processes launched via the ScreenConnect client service.\n",
  "source": {
    "type": "sigma",
    "id": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_remote_access_tools_screenconnect_remote_execution_susp.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution_susp.yml"
  },
  "tags": [
    "attackcommand-and-control",
    "attackt1219"
  ],
  "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @Kostastsale",
  "references": [
    "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
    "https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode",
    "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708",
    "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-02-25",
  "modified": "2024-02-28",
  "mitre": {
    "tactics": [
      "TA1219"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"ParentCommandLine|contains|all\": [\":\\\\Windows\\\\TEMP\\\\ScreenConnect\\\\\", \"run.cmd\"], \"Image|endswith\": [\"\\\\bitsadmin.exe\", \"\\\\cmd.exe\", \"\\\\curl.exe\", \"\\\\dllhost.exe\", \"\\\\net.exe\", \"\\\\nltest.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\", \"\\\\rundll32.exe\", \"\\\\wevtutil.exe\"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "If the script being executed make use of any of the utilities mentioned in the detection then they should filtered out or allowed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}