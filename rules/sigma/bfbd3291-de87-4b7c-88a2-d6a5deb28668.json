{
  "id": "bfbd3291-de87-4b7c-88a2-d6a5deb28668",
  "name": "ADCS Certificate Template Configuration Vulnerability with Risky EKU",
  "description": "Detects certificate creation with template allowing risk permission subject and risky EKU",
  "source": {
    "type": "sigma",
    "id": "bfbd3291-de87-4b7c-88a2-d6a5deb28668",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/win_security_adcs_certificate_template_configuration_vulnerability_eku.yml",
    "file_path": "tmp/repos/sigma/rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability_eku.yml"
  },
  "tags": [
    "attackcredential-access",
    "attackprivilege-escalation"
  ],
  "author": "Orlinum , BlueDefenZer",
  "references": [
    "https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2021-11-17",
  "modified": "2022-12-25",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "selection10: {\"EventID\": 4898, \"TemplateContent|contains\": [\"1.3.6.1.5.5.7.3.2\", \"1.3.6.1.5.2.3.4\", \"1.3.6.1.4.1.311.20.2.2\", \"2.5.29.37.0\"]}\nselection11: {\"TemplateContent|contains\": \"CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT\"}\nselection20: {\"EventID\": 4899, \"NewTemplateContent|contains\": [\"1.3.6.1.5.5.7.3.2\", \"1.3.6.1.5.2.3.4\", \"1.3.6.1.4.1.311.20.2.2\", \"2.5.29.37.0\"]}\nselection21: {\"NewTemplateContent|contains\": \"CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT\"}",
    "condition": "(selection10 and selection11) or (selection20 and selection21)",
    "fields": []
  },
  "falsepositives": [
    "Administrator activity",
    "Proxy SSL certificate with subject modification",
    "Smart card enrollement"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "security"
  ]
}