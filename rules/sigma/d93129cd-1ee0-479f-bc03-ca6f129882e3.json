{
  "id": "d93129cd-1ee0-479f-bc03-ca6f129882e3",
  "name": "Powershell Detect Virtualization Environment",
  "description": "Adversaries may employ various system checks to detect and avoid virtualization and analysis environments.\nThis may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox\n",
  "source": {
    "type": "sigma",
    "id": "d93129cd-1ee0-479f-bc03-ca6f129882e3",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_ps_detect_vm_env.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_script/posh_ps_detect_vm_env.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1497001"
  ],
  "author": "frack113, Duc.Le-GTSC",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1497.001/T1497.001.md",
    "https://techgenix.com/malicious-powershell-scripts-evade-detection/"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2021-08-03",
  "modified": "2022-03-03",
  "mitre": {
    "tactics": [
      "TA1497"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_action: {\"ScriptBlockText|contains\": [\"Get-WmiObject\", \"gwmi\"]}\nselection_module: {\"ScriptBlockText|contains\": [\"MSAcpi_ThermalZoneTemperature\", \"Win32_ComputerSystem\"]}",
    "condition": "all of selection*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_script"
  ]
}