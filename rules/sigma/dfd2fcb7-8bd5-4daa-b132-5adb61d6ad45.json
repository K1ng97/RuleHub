{
  "id": "dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45",
  "name": "Windows Hotfix Updates Reconnaissance Via Wmic.EXE",
  "description": "Detects the execution of wmic with the \"qfe\" flag in order to obtain information about installed hotfix updates on the system. This is often used by pentester and attacker enumeration scripts",
  "source": {
    "type": "sigma",
    "id": "dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_wmic_recon_hotfix.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_hotfix.yml"
  },
  "tags": [
    "attackexecution",
    "attackt1047"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://github.com/carlospolop/PEASS-ng/blob/fa0f2e17fbc1d86f1fd66338a40e665e7182501d/winPEAS/winPEASbat/winPEAS.bat",
    "https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-06-20",
  "modified": "2023-02-14",
  "mitre": {
    "tactics": [
      "TA1047"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: [{\"OriginalFileName\": \"wmic.exe\"}, {\"Image|endswith\": \"\\\\WMIC.exe\"}]\nselection_cli: {\"CommandLine|contains\": \" qfe\"}",
    "condition": "all of selection*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}