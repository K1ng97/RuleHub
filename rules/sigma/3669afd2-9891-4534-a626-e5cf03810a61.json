{
  "id": "3669afd2-9891-4534-a626-e5cf03810a61",
  "name": "Load Of RstrtMgr.DLL By An Uncommon Process",
  "description": "Detects the load of RstrtMgr DLL (Restart Manager) by an uncommon process.\nThis library has been used during ransomware campaigns to kill processes that would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware). It has also recently been seen used by the BiBi wiper for Windows.\nIt could also be used for anti-analysis purposes by shut downing specific processes.\n",
  "source": {
    "type": "sigma",
    "id": "3669afd2-9891-4534-a626-e5cf03810a61",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/image_load_dll_rstrtmgr_uncommon_load.yml",
    "file_path": "tmp/repos/sigma/rules/windows/image_load/image_load_dll_rstrtmgr_uncommon_load.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackimpact",
    "attackt1486",
    "attackt1562001"
  ],
  "author": "Luc GÃ©naux",
  "references": [
    "https://www.crowdstrike.com/blog/windows-restart-manager-part-1/",
    "https://www.crowdstrike.com/blog/windows-restart-manager-part-2/",
    "https://web.archive.org/web/20231221193106/https://www.swascan.com/cactus-ransomware-malware-analysis/",
    "https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html"
  ],
  "severity": "low",
  "type": "sigma",
  "status": "test",
  "created": "2023-11-28",
  "modified": "2023-11-28",
  "mitre": {
    "tactics": [
      "TA1486",
      "TA1562"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection: [{\"ImageLoaded|endswith\": \"\\\\RstrtMgr.dll\"}, {\"OriginalFileName\": \"RstrtMgr.dll\"}]\nfilter_main_generic: {\"Image|contains\": [\":\\\\$WINDOWS.~BT\\\\\", \":\\\\$WinREAgent\\\\\", \":\\\\Program Files (x86)\\\\\", \":\\\\Program Files\\\\\", \":\\\\ProgramData\\\\\", \":\\\\Windows\\\\explorer.exe\", \":\\\\Windows\\\\SoftwareDistribution\\\\\", \":\\\\Windows\\\\SysNative\\\\\", \":\\\\Windows\\\\System32\\\\\", \":\\\\Windows\\\\SysWOW64\\\\\", \":\\\\Windows\\\\WinSxS\\\\\", \":\\\\WUDownloadCache\\\\\"]}\nfilter_main_user_software_installations: {\"Image|contains|all\": [\":\\\\Users\\\\\", \"\\\\AppData\\\\Local\\\\Temp\\\\is-\", \".tmp\\\\\"], \"Image|endswith\": \".tmp\"}\nfilter_main_admin_software_installations: {\"Image|contains\": \":\\\\Windows\\\\Temp\\\\\"}",
    "condition": "selection and not 1 of filter_main_*",
    "fields": []
  },
  "falsepositives": [
    "Other legitimate Windows processes not currently listed",
    "Processes related to software installation"
  ],
  "level": "low",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "image_load"
  ]
}