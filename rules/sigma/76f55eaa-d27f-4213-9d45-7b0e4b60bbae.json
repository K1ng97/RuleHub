{
  "id": "76f55eaa-d27f-4213-9d45-7b0e4b60bbae",
  "name": "Service Reconnaissance Via Wmic.EXE",
  "description": "An adversary might use WMI to check if a certain remote service is running on a remote device.\nWhen the test completes, a service information will be displayed on the screen if it exists.\nA common feedback message is that \"No instance(s) Available\" if the service queried is not running.\nA common error message is \"Node - (provided IP or default) ERROR Description =The RPC server is unavailable\" if the provided remote host is unreachable\n",
  "source": {
    "type": "sigma",
    "id": "76f55eaa-d27f-4213-9d45-7b0e4b60bbae",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_wmic_recon_service.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_wmic_recon_service.yml"
  },
  "tags": [
    "attackexecution",
    "attackt1047"
  ],
  "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md",
    "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2023-02-14",
  "modified": "2023-02-14",
  "mitre": {
    "tactics": [
      "TA1047"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection_img: [{\"Image|endswith\": \"\\\\WMIC.exe\"}, {\"OriginalFileName\": \"wmic.exe\"}]\nselection_cli: {\"CommandLine|contains\": \"service\"}",
    "condition": "all of selection_*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}