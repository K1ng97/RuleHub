{
  "id": "91b76b84-8589-47aa-9605-c837583b82a9",
  "name": "Potential Okta Password in AlternateID Field",
  "description": "Detects when a user has potentially entered their password into the\nusername field, which will cause the password to be retained in log files.\n",
  "source": {
    "type": "sigma",
    "id": "91b76b84-8589-47aa-9605-c837583b82a9",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/okta_password_in_alternateid_field.yml",
    "file_path": "tmp/repos/sigma/rules/cloud/okta/okta_password_in_alternateid_field.yml"
  },
  "tags": [
    "attackcredential-access",
    "attackt1552"
  ],
  "author": "kelnage",
  "references": [
    "https://developer.okta.com/docs/reference/api/system-log/",
    "https://www.mitiga.io/blog/how-okta-passwords-can-be-compromised-uncovering-a-risk-to-user-data",
    "https://help.okta.com/en-us/Content/Topics/users-groups-profiles/usgp-create-character-restriction.htm"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2023-04-03",
  "modified": "2023-10-25",
  "mitre": {
    "tactics": [
      "TA1552"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"legacyeventtype\": \"core.user_auth.login_failed\"}\nfilter_main: {\"actor.alternateid|re\": \"(^0oa.*|[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,10})\"}",
    "condition": "selection and not filter_main",
    "fields": []
  },
  "falsepositives": [
    "Unlikely"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "okta",
    "okta"
  ]
}