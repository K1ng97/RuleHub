{
  "id": "552b6b65-df37-4d3e-a258-f2fc4771ae54",
  "name": "Potential Antivirus Software DLL Sideloading",
  "description": "Detects potential DLL sideloading of DLLs that are part of antivirus software suchas McAfee, Symantec...etc",
  "source": {
    "type": "sigma",
    "id": "552b6b65-df37-4d3e-a258-f2fc4771ae54",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/image_load_side_load_antivirus.yml",
    "file_path": "tmp/repos/sigma/rules/windows/image_load/image_load_side_load_antivirus.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackpersistence",
    "attackprivilege-escalation",
    "attackt1574001"
  ],
  "author": "Nasreddine Bencherchali (Nextron Systems), Wietze Beukema (project and research)",
  "references": [
    "https://hijacklibs.net/"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2022-08-17",
  "modified": "2023-03-13",
  "mitre": {
    "tactics": [
      "TA1574"
    ],
    "techniques": [
      "T001"
    ]
  },
  "detection": {
    "query": "selection_bitdefender: {\"ImageLoaded|endswith\": \"\\\\log.dll\"}\nfilter_log_dll_bitdefender: {\"ImageLoaded|startswith\": [\"C:\\\\Program Files\\\\Bitdefender Antivirus Free\\\\\", \"C:\\\\Program Files (x86)\\\\Bitdefender Antivirus Free\\\\\"]}\nfilter_log_dll_dell_sar: {\"Image\": \"C:\\\\Program Files\\\\Dell\\\\SARemediation\\\\audit\\\\TelemetryUtility.exe\", \"ImageLoaded\": [\"C:\\\\Program Files\\\\Dell\\\\SARemediation\\\\plugin\\\\log.dll\", \"C:\\\\Program Files\\\\Dell\\\\SARemediation\\\\audit\\\\log.dll\"]}\nfilter_log_dll_canon: {\"ImageLoaded|startswith\": \"C:\\\\Program Files\\\\Canon\\\\MyPrinter\\\\\"}\nselection_fsecure: {\"ImageLoaded|endswith\": \"\\\\qrt.dll\"}\nfilter_fsecure: {\"ImageLoaded|startswith\": [\"C:\\\\Program Files\\\\F-Secure\\\\Anti-Virus\\\\\", \"C:\\\\Program Files (x86)\\\\F-Secure\\\\Anti-Virus\\\\\"]}\nselection_mcafee: {\"ImageLoaded|endswith\": [\"\\\\ashldres.dll\", \"\\\\lockdown.dll\", \"\\\\vsodscpl.dll\"]}\nfilter_mcafee: {\"ImageLoaded|startswith\": [\"C:\\\\Program Files\\\\McAfee\\\\\", \"C:\\\\Program Files (x86)\\\\McAfee\\\\\"]}\nselection_cyberark: {\"ImageLoaded|endswith\": \"\\\\vftrace.dll\"}\nfilter_cyberark: {\"ImageLoaded|startswith\": [\"C:\\\\Program Files\\\\CyberArk\\\\Endpoint Privilege Manager\\\\Agent\\\\x32\\\\\", \"C:\\\\Program Files (x86)\\\\CyberArk\\\\Endpoint Privilege Manager\\\\Agent\\\\x32\\\\\"]}\nselection_avast: {\"ImageLoaded|endswith\": \"\\\\wsc.dll\"}\nfilter_avast: {\"ImageLoaded|startswith\": [\"C:\\\\program Files\\\\AVAST Software\\\\Avast\\\\\", \"C:\\\\program Files (x86)\\\\AVAST Software\\\\Avast\\\\\"]}\nselection_eset_deslock: {\"ImageLoaded|endswith\": \"\\\\DLPPREM32.dll\"}\nfilter_eset_deslock: {\"ImageLoaded|startswith\": [\"C:\\\\program Files\\\\ESET\", \"C:\\\\program Files (x86)\\\\ESET\"]}\nselection_titanium: {\"ImageLoaded|endswith\": \"\\\\tmdbglog.dll\"}\nfilter_titanium: {\"ImageLoaded|startswith\": [\"C:\\\\program Files\\\\Trend Micro\\\\Titanium\\\\\", \"C:\\\\program Files (x86)\\\\Trend Micro\\\\Titanium\\\\\"]}",
    "condition": "(selection_bitdefender and not 1 of filter_log_dll_*) or (selection_fsecure and not filter_fsecure) or (selection_mcafee and not filter_mcafee) or (selection_cyberark and not filter_cyberark) or (selection_avast and not filter_avast) or (selection_titanium and not filter_titanium) or (selection_eset_deslock and not filter_eset_deslock)",
    "fields": []
  },
  "falsepositives": [
    "Applications that load the same dlls mentioned in the detection section. Investigate them and filter them out if a lot FPs are caused.",
    "Dell SARemediation plugin folder (C:\\Program Files\\Dell\\SARemediation\\plugin\\log.dll) is known to contain the 'log.dll' file.",
    "The Canon MyPrinter folder 'C:\\Program Files\\Canon\\MyPrinter\\' is known to contain the 'log.dll' file"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "image_load"
  ]
}