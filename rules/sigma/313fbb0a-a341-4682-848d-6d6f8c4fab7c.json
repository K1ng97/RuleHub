{
  "id": "313fbb0a-a341-4682-848d-6d6f8c4fab7c",
  "name": "Suspicious PowerShell WindowStyle Option",
  "description": "Adversaries may use hidden windows to conceal malicious activity from the plain sight of users.\nIn some cases, windows that would typically be displayed when an application carries out an operation can be hidden\n",
  "source": {
    "type": "sigma",
    "id": "313fbb0a-a341-4682-848d-6d6f8c4fab7c",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/posh_ps_susp_windowstyle.yml",
    "file_path": "tmp/repos/sigma/rules/windows/powershell/powershell_script/posh_ps_susp_windowstyle.yml"
  },
  "tags": [
    "attackdefense-evasion",
    "attackt1564003"
  ],
  "author": "frack113, Tim Shelton (fp AWS)",
  "references": [
    "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.003/T1564.003.md"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "test",
  "created": "2021-10-20",
  "modified": "2023-01-03",
  "mitre": {
    "tactics": [
      "TA1564"
    ],
    "techniques": [
      "T003"
    ]
  },
  "detection": {
    "query": "selection: {\"ScriptBlockText|contains|all\": [\"powershell\", \"WindowStyle\", \"Hidden\"]}\nfilter: {\"ScriptBlockText|contains|all\": [\":\\\\Program Files\\\\Amazon\\\\WorkSpacesConfig\\\\Scripts\\\\\", \"$PSScriptRoot\\\\Module\\\\WorkspaceScriptModule\\\\WorkspaceScriptModule\"]}",
    "condition": "selection and not filter",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "ps_script"
  ]
}