{
  "id": "1012f107-b8f1-4271-af30-5aed2de89b39",
  "name": "Terminal Service Process Spawn",
  "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)",
  "source": {
    "type": "sigma",
    "id": "1012f107-b8f1-4271-af30-5aed2de89b39",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_svchost_termserv_proc_spawn.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_svchost_termserv_proc_spawn.yml"
  },
  "tags": [
    "attackinitial-access",
    "attacklateral-movement",
    "attackt1190",
    "attackt1210",
    "car2013-07-002"
  ],
  "author": "Florian Roth (Nextron Systems)",
  "references": [
    "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/"
  ],
  "severity": "high",
  "type": "sigma",
  "status": "test",
  "created": "2019-05-22",
  "modified": "2023-01-25",
  "mitre": {
    "tactics": [
      "TA1190",
      "TA1210"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"ParentCommandLine|contains|all\": [\"\\\\svchost.exe\", \"termsvcs\"]}\nfilter_img: {\"Image|endswith\": [\"\\\\rdpclip.exe\", \":\\\\Windows\\\\System32\\\\csrss.exe\", \":\\\\Windows\\\\System32\\\\wininit.exe\", \":\\\\Windows\\\\System32\\\\winlogon.exe\"]}\nfilter_null: {\"Image\": null}",
    "condition": "selection and not 1 of filter_*",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "high",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}