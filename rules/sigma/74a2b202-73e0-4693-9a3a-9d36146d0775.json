{
  "id": "74a2b202-73e0-4693-9a3a-9d36146d0775",
  "name": "Remote Access Tool - MeshAgent Command Execution via MeshCentral",
  "description": "Detects the use of MeshAgent to execute commands on the target host, particularly when threat actors might abuse it to execute commands directly.\nMeshAgent can execute commands on the target host by leveraging win-console to obscure their activities and win-dispatcher to run malicious code through IPC with child processes.\n",
  "source": {
    "type": "sigma",
    "id": "74a2b202-73e0-4693-9a3a-9d36146d0775",
    "url": "https://github.com/SigmaHQ/sigma/blob/master/proc_creation_win_remote_access_tools_meshagent_exec.yml",
    "file_path": "tmp/repos/sigma/rules/windows/process_creation/proc_creation_win_remote_access_tools_meshagent_exec.yml"
  },
  "tags": [
    "attackcommand-and-control",
    "attackt1219"
  ],
  "author": "@Kostastsale",
  "references": [
    "https://github.com/Ylianst/MeshAgent",
    "https://github.com/Ylianst/MeshAgent/blob/52cf129ca43d64743181fbaf940e0b4ddb542a37/modules/win-dispatcher.js#L173",
    "https://github.com/Ylianst/MeshAgent/blob/52cf129ca43d64743181fbaf940e0b4ddb542a37/modules/win-info.js#L55"
  ],
  "severity": "medium",
  "type": "sigma",
  "status": "experimental",
  "created": "2024-09-22",
  "modified": "2024-09-22",
  "mitre": {
    "tactics": [
      "TA1219"
    ],
    "techniques": []
  },
  "detection": {
    "query": "selection: {\"ParentImage|endswith\": \"\\\\meshagent.exe\", \"Image|endswith\": [\"\\\\cmd.exe\", \"\\\\powershell.exe\", \"\\\\pwsh.exe\"]}",
    "condition": "selection",
    "fields": []
  },
  "falsepositives": [
    "False positives can be found in environments using MessAgent for remote management, analysis should prioritize the grandparent process, MessAgent.exe, and scrutinize the resulting child processes triggered by any suspicious interactive commands directed at the target host."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": [
    "windows",
    "process_creation"
  ]
}