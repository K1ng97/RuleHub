{
  "id": "630ea8b2-2800-4f5d-9cbc-d65c567349b0",
  "name": "Confluence CVE-2023-22515 Trigger Vulnerability",
  "description": "The following analytic identifies potential exploitation attempts of the Confluence CVE-2023-22515 vulnerability. It detects successful accesses (HTTP status 200) to specific vulnerable endpoints by analyzing web logs within the Splunk 'Web' Data Model. This activity is significant for a SOC as it indicates possible privilege escalation attempts in Confluence. If confirmed malicious, attackers could gain unauthorized access or create accounts with escalated privileges, leading to potential data breaches or further exploitation within the environment.",
  "source": {
    "type": "splunk",
    "id": "630ea8b2-2800-4f5d-9cbc-d65c567349b0",
    "url": "https://github.com/splunk/security_content/blob/develop/confluence_cve_2023_22515_trigger_vulnerability.yml",
    "file_path": "tmp/repos/splunk/detections/web/confluence_cve_2023_22515_trigger_vulnerability.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/Chocapikk/CVE-2023-22515/blob/main/exploit.py",
    "https://x.com/Shadowserver/status/1712378833536741430?s=20",
    "https://github.com/j3seer/CVE-2023-22515-POC"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"*/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false*\",\"*/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=0&*\") Web.http_method=GET Web.status=200 by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `confluence_cve_2023_22515_trigger_vulnerability_filter`",
    "condition": "To successfully implement this search you need to be ingesting information on Web traffic that include fields relavent for traffic into the `Web` datamodel. Tested with Suricata and nginx:plus:kv.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present with legitimate applications. Attempt to filter by dest IP or use Asset groups to restrict to Confluence servers."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}