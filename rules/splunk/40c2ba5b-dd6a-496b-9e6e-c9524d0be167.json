{
  "id": "40c2ba5b-dd6a-496b-9e6e-c9524d0be167",
  "name": "Windows IIS Components Module Failed to Load",
  "description": "The following analytic detects when an IIS Module DLL fails to load due to a configuration problem, identified by EventCode 2282. This detection leverages Windows Application event logs to identify repeated failures in loading IIS modules. Such failures can indicate misconfigurations or potential tampering with IIS components. If confirmed malicious, this activity could lead to service disruptions or provide an attacker with opportunities to exploit vulnerabilities within the IIS environment. Immediate investigation is required to determine the legitimacy of the failing module and to mitigate any potential security risks.",
  "source": {
    "type": "splunk",
    "id": "40c2ba5b-dd6a-496b-9e6e-c9524d0be167",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_iis_components_module_failed_to_load.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_iis_components_module_failed_to_load.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://social.technet.microsoft.com/wiki/contents/articles/21757.event-id-2282-iis-worker-process-availability.aspx",
    "https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/",
    "https://www.crowdstrike.com/wp-content/uploads/2022/05/crowdstrike-iceapple-a-novel-internet-information-services-post-exploitation-framework-1.pdf",
    "https://unit42.paloaltonetworks.com/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/",
    "https://www.secureworks.com/research/bronze-union",
    "https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1505.004",
    "https://strontic.github.io/xcyclopedia/library/appcmd.exe-055B2B09409F980BF9B5A3969D01E5B2.html"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_application` EventCode=2282 | stats  count min(_time) as firstTime max(_time) as lastTime by  EventCode dest Name ModuleDll | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_iis_components_module_failed_to_load_filter`",
    "condition": "IIS must be installed and Application event logs must be collected in order to utilize this analytic.",
    "fields": []
  },
  "falsepositives": [
    "False positives will be present until all module failures are resolved or reviewed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}