{
  "id": "5ca7ebee-4ee7-4cf2-b3be-0ea26a00d822",
  "name": "Microsoft Intune Manual Device Management",
  "description": "Microsoft Intune device management configuration policies, scripts & apps are a all tools administrators can use to remotely manage intune managed devices. Instead of waiting for the devices to poll for changes to polciies, the policies can be manually pushed to expidite delivery.  This may be useful in a pinch, it may also be a sign of an impatient attacker trying to speed up the delivery of their payload.  This detection identifies when a device management configuration policy sync events, on-demand remediation scripts are triggered or when devices are remotely restarted. ",
  "source": {
    "type": "splunk",
    "id": "5ca7ebee-4ee7-4cf2-b3be-0ea26a00d822",
    "url": "https://github.com/splunk/security_content/blob/develop/microsoft_intune_manual_device_management.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/microsoft_intune_manual_device_management.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Dean Luxton",
  "references": [
    "https://posts.specterops.io/death-from-above-lateral-movement-from-azure-to-on-prem-ad-d18cb3959d4d",
    "https://securityintelligence.com/x-force/detecting-intune-lateral-movement/",
    "https://posts.specterops.io/maestro-9ed71d38d546"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_activity` operationName=\"*ManagedDevice*\"  | rename identity as user, properties.TargetObjectIds{} as TargetObjectId, properties.TargetDisplayNames{} as TargetDisplayName, properties.Actor.IsDelegatedAdmin as user_isDelegatedAdmin | rex field=\"operationName\" \"^(?P<action>\\w+)\\s\" | table _time operationName action user user_type user_isDelegatedAdmin TargetDisplayName TargetObjectId status tenantId correlationId | `microsoft_intune_manual_device_management_filter`",
    "condition": "The Splunk Add-on for Microsoft Cloud Services add-on is required to ingest In-Tune audit logs via Azure EventHub.  To configure this logging, visit Intune > Tenant administration > Diagnostic settings > Add diagnostic settings & send events to the activity audit event hub.  Deploy as a risk based alerting rule for quick deployment or perform baselining & tune accordingly. ",
    "fields": []
  },
  "falsepositives": [
    "Legitimate adminstrative usage of this functionality will trigger this detection."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}