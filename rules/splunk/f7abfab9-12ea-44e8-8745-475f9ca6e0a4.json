{
  "id": "f7abfab9-12ea-44e8-8745-475f9ca6e0a4",
  "name": "Windows Event Triggered Image File Execution Options Injection",
  "description": "The following analytic identifies the creation or modification of Image File Execution Options (IFEO) registry keys, detected via EventCode 3000 in the Application channel. This detection leverages Windows Event Logs to monitor for process names added to IFEO under specific registry paths. This activity is significant as it can indicate attempts to set traps for process monitoring or debugging, often used by attackers for persistence or evasion. If confirmed malicious, this could allow an attacker to execute arbitrary code or manipulate process behavior, leading to potential system compromise.",
  "source": {
    "type": "splunk",
    "id": "f7abfab9-12ea-44e8-8745-475f9ca6e0a4",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_event_triggered_image_file_execution_options_injection.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_event_triggered_image_file_execution_options_injection.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://blog.thinkst.com/2022/09/sensitive-command-token-so-much-offense.html",
    "https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/registry-entries-for-silent-process-exit"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_application` EventCode=3000 | rename param1 AS \"Process\" param2 AS \"Exit_Code\" | stats count min(_time) as firstTime max(_time) as lastTime by Process Exit_Code dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_event_triggered_image_file_execution_options_injection_filter`",
    "condition": "This analytic requires capturing the Windows Event Log Application channel in XML.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present and tuning will be required before turning into a TTP or notable."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}