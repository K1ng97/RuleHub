{
  "id": "7f6b8a95-3fb7-429a-8c53-e5d4f8d92a10",
  "name": "Windows MSC EvilTwin Directory Path Manipulation",
  "description": "The following analytic detects potential MSC EvilTwin loader exploitation, which manipulates directory paths with spaces to bypass security controls. The technique, described as CVE-2025-26633, involves crafting malicious MSC files that leverage MUIPath parameter manipulation. This detection focuses on suspicious MSC file execution patterns with unconventional command-line parameters, particularly those containing unusual spaces in Windows System32 paths or suspicious additional parameters after the MSC file. If confirmed malicious, this behavior could allow an attacker to execute arbitrary code with elevated privileges through DLL side-loading or path traversal techniques.",
  "source": {
    "type": "splunk",
    "id": "7f6b8a95-3fb7-429a-8c53-e5d4f8d92a10",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_msc_eviltwin_directory_path_manipulation.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_msc_eviltwin_directory_path_manipulation.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://securityintelligence.com/posts/new-threat-actor-water-gamayun-targets-telecom-finance/",
    "https://www.ncsc.gov.uk/report/weekly-threat-report-12th-april-2024"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=\"mmc.exe\" by Processes.dest Processes.user Processes.parent_process_name Processes.parent_process_path Processes.process Processes.process_id Processes.process_name Processes.process_path Processes.action Processes.original_file_name Processes.parent_process_exec Processes.parent_process_guid Processes.parent_process_id Processes.process_exec Processes.process_guid Processes.process_hash Processes.process_integrity_level Processes.user_id Processes.vendor_product | `drop_dm_object_name(Processes)` | regex process=\"(?i).*mmc\\.exe.*((Windows\\s+\\\\\\\\System32)|(Windows\\s+System32)|(\\\\\\\\Windows\\s+\\\\\\\\System32)|(Program\\s+Files\\s+\\\\\\\\)|(Program\\s+Files\\s+\\(\\\\w+\\)\\s+\\\\\\\\)|(Progra~1\\s+\\\\\\\\))\" | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_msc_eviltwin_directory_path_manipulation_filter`",
    "condition": "The detection is based on data that originates from Endpoint Detection and Response (EDR) agents. These agents are designed to provide security-related telemetry from the endpoints where the agent is installed. To implement this search, you must ingest logs that contain the process GUID, process name, and parent process. Additionally, you must ingest complete command-line executions. These logs must be processed using the appropriate Splunk Technology Add-ons that are specific to the EDR product. The logs must also be mapped to the `Processes` node of the `Endpoint` data model. Use the Splunk Common Information Model (CIM) to normalize the field names and speed up the data modeling process.",
    "fields": []
  },
  "falsepositives": [
    "Some legitimate system maintenance tools might use MSC files with unusual parameters. Filter for specific known maintenance activities in your environment."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}