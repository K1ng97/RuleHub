{
  "id": "8a2f3ca2-4eb5-4389-a549-14063882e537",
  "name": "AWS Defense Evasion Stop Logging Cloudtrail",
  "description": "The following analytic detects `StopLogging` events in AWS CloudTrail logs. It leverages CloudTrail event data to identify when logging is intentionally stopped, excluding console-based actions and focusing on successful attempts. This activity is significant because adversaries may stop logging to evade detection and operate stealthily within the compromised environment. If confirmed malicious, this action could allow attackers to perform further activities without being logged, hindering incident response and forensic investigations, and potentially leading to unauthorized access or data exfiltration.",
  "source": {
    "type": "splunk",
    "id": "8a2f3ca2-4eb5-4389-a549-14063882e537",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_defense_evasion_stop_logging_cloudtrail.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_defense_evasion_stop_logging_cloudtrail.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1562/008/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName = StopLogging eventSource = cloudtrail.amazonaws.com userAgent!=console.amazonaws.com errorCode = success | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_defense_evasion_stop_logging_cloudtrail_filter`",
    "condition": "You must install Splunk AWS Add on and enable Cloudtrail logs in your AWS Environment.",
    "fields": []
  },
  "falsepositives": [
    "While this search has no known false positives, it is possible that an AWS admin has stopped cloudtrail logging. Please investigate this activity."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}