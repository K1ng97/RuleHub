{
  "id": "4e3c26f2-4fb9-4bd7-ab46-1b76ffa2a23b",
  "name": "AWS New MFA Method Registered For User",
  "description": "The following analytic detects the registration of a new Multi-Factor Authentication (MFA) method for an AWS account. It leverages AWS CloudTrail logs to identify the `CreateVirtualMFADevice` event. This activity is significant because adversaries who gain unauthorized access to an AWS account may register a new MFA method to maintain persistence. If confirmed malicious, this could allow attackers to secure their access, making it difficult to detect and remove their presence, potentially leading to further unauthorized activities and data breaches.",
  "source": {
    "type": "splunk",
    "id": "4e3c26f2-4fb9-4bd7-ab46-1b76ffa2a23b",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_new_mfa_method_registered_for_user.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_new_mfa_method_registered_for_user.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://aws.amazon.com/blogs/security/you-can-now-assign-multiple-mfa-devices-in-iam/",
    "https://attack.mitre.org/techniques/T1556/",
    "https://attack.mitre.org/techniques/T1556/006/",
    "https://twitter.com/jhencinski/status/1618660062352007174"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName=CreateVirtualMFADevice | rename userName as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_new_mfa_method_registered_for_user_filter`",
    "condition": "You must install Splunk AWS add on and Splunk App for AWS. This search works when AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "Newly onboarded users who are registering an MFA method for the first time will also trigger this detection."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}