{
  "id": "23add2a8-ea22-4fd4-8bc0-8c0b822373a1",
  "name": "Windows Group Policy Object Created",
  "description": "The following analytic detects the creation of a new Group Policy Object (GPO) by leveraging Event IDs 5136 and 5137. This detection uses directory service change events to identify when a new GPO is created. Monitoring GPO creation is crucial as adversaries can exploit GPOs to escalate privileges or deploy malware across an Active Directory network. If confirmed malicious, this activity could allow attackers to control system configurations, deploy ransomware, or propagate malware, leading to widespread compromise and significant operational disruption.",
  "source": {
    "type": "splunk",
    "id": "23add2a8-ea22-4fd4-8bc0-8c0b822373a1",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_group_policy_object_created.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_group_policy_object_created.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco",
  "references": [
    "https://attack.mitre.org/techniques/T1484/",
    "https://attack.mitre.org/techniques/T1484/001",
    "https://www.trustedsec.com/blog/weaponizing-group-policy-objects-access/",
    "https://adsecurity.org/?p=2716",
    "https://www.bleepingcomputer.com/news/security/lockbit-ransomware-now-encrypts-windows-domains-using-group-policies/",
    "https://www.varonis.com/blog/group-policy-objects"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=5137 OR (EventCode=5136 AttributeValue!=\"New Group Policy Object\" AND (AttributeLDAPDisplayName=displayName OR AttributeLDAPDisplayName=gPCFileSysPath) ) ObjectClass=groupPolicyContainer | stats values(AttributeValue) as details values(SubjectUserSid) as User values(ObjectDN) as ObjectDN by ObjectGUID Computer dest | eval GPO_Name = mvindex(details, 0) | eval GPO_Path = mvindex(details, 1) | fields - details | `windows_group_policy_object_created_filter`",
    "condition": "To successfully implement this search, the Advanced Security Audit policy setting `Audit Directory Service Changes` within `DS Access` needs to be enabled. Furthermore, the appropriate system access control lists (SACL) need to be created as the used events are not logged by default. A good guide to accomplish this can be found here https://jgspiers.com/audit-group-policy-changes/.",
    "fields": []
  },
  "falsepositives": [
    "Group Policy Objects are created as part of regular administrative operations, filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}