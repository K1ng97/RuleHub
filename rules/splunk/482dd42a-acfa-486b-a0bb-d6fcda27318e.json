{
  "id": "482dd42a-acfa-486b-a0bb-d6fcda27318e",
  "name": "Azure AD Multi-Factor Authentication Disabled",
  "description": "The following analytic detects attempts to disable multi-factor authentication (MFA) for an Azure AD user. It leverages Azure Active Directory AuditLogs to identify the \"Disable Strong Authentication\" operation. This activity is significant because disabling MFA can allow adversaries to maintain persistence using compromised accounts without raising suspicion. If confirmed malicious, this action could enable attackers to bypass an essential security control, potentially leading to unauthorized access and prolonged undetected presence in the environment.",
  "source": {
    "type": "splunk",
    "id": "482dd42a-acfa-486b-a0bb-d6fcda27318e",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_ad_multi_factor_authentication_disabled.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_ad_multi_factor_authentication_disabled.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://docs.microsoft.com/en-us/azure/active-directory/authentication/concept-mfa-howitworks",
    "https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-userstates",
    "https://attack.mitre.org/tactics/TA0005/",
    "https://attack.mitre.org/techniques/T1556/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad` category=AuditLogs operationName=\"Disable Strong Authentication\" | rename properties.* as * | rename targetResources{}.type as type | rename initiatedBy.user.userPrincipalName as initiatedBy | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent initiatedBy signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_multi_factor_authentication_disabled_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase (https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Active Directory events into your Splunk environment through an EventHub. This analytic was written to be used with the azure:monitor:aad sourcetype leveraging the AuditLogs log category.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use case may require for users to disable MFA. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}