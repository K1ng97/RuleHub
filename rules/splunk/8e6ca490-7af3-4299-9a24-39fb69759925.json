{
  "id": "8e6ca490-7af3-4299-9a24-39fb69759925",
  "name": "Ivanti Connect Secure SSRF in SAML Component",
  "description": "The following analytic identifies POST requests targeting endpoints vulnerable to the SSRF issue (CVE-2024-21893) in Ivanti's products. It leverages the Web data model, focusing on endpoints such as /dana-ws/saml20.ws, /dana-ws/saml.ws, /dana-ws/samlecp.ws, and /dana-na/auth/saml-logout.cgi. The detection filters for POST requests that received an HTTP 200 OK response, indicating successful execution. This activity is significant as it may indicate an attempt to exploit SSRF vulnerabilities, potentially allowing attackers to access internal services or sensitive data. If confirmed malicious, this could lead to unauthorized access and data exfiltration.",
  "source": {
    "type": "splunk",
    "id": "8e6ca490-7af3-4299-9a24-39fb69759925",
    "url": "https://github.com/splunk/security_content/blob/develop/ivanti_connect_secure_ssrf_in_saml_component.yml",
    "file_path": "tmp/repos/splunk/detections/web/ivanti_connect_secure_ssrf_in_saml_component.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://attackerkb.com/topics/FGlK1TVnB2/cve-2024-21893/rapid7-analysis",
    "https://www.assetnote.io/resources/research/ivantis-pulse-connect-secure-auth-bypass-round-two"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"*/dana-ws/saml20.ws*\",\"*/dana-ws/saml.ws*\",\"*/dana-ws/samlecp.ws*\",\"*/dana-na/auth/saml-logout.cgi/*\") Web.http_method=POST Web.status=200 by Web.src, Web.dest, Web.http_user_agent, Web.url, Web.status, Web.http_method | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `ivanti_connect_secure_ssrf_in_saml_component_filter`",
    "condition": "This detection requires the Web datamodel to be populated from a supported Technology Add-On like Suricata, Splunk for Apache, Splunk for Nginx, or Splunk for Palo Alto.",
    "fields": []
  },
  "falsepositives": [
    "This analytic is limited to HTTP Status 200; adjust as necessary. False positives may occur if the HTTP Status is removed, as most failed attempts result in a 301. It's recommended to review the context of the alerts and adjust the analytic parameters to better fit the specific environment."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}