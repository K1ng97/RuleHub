{
  "id": "7f398cfb-918d-41f4-8db8-2e2474e02222",
  "name": "High Number of Login Failures from a single source",
  "description": "The following analytic detects multiple failed login attempts in Office365 Azure Active Directory from a single source IP address. It leverages Office365 management activity logs, specifically AzureActiveDirectoryStsLogon records, aggregating these logs in 5-minute intervals to count failed login attempts. This activity is significant as it may indicate brute-force attacks or password spraying, which are critical to monitor. If confirmed malicious, an attacker could gain unauthorized access to Office365 accounts, leading to potential data breaches, lateral movement within the organization, or further malicious activities using the compromised account.",
  "source": {
    "type": "splunk",
    "id": "7f398cfb-918d-41f4-8db8-2e2474e02222",
    "url": "https://github.com/splunk/security_content/blob/develop/high_number_of_login_failures_from_a_single_source.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/high_number_of_login_failures_from_a_single_source.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/001/",
    "https://docs.microsoft.com/en-us/security/compass/incident-response-playbook-password-spray",
    "https://www.cisa.gov/uscert/ncas/alerts/aa21-008a",
    "https://docs.microsoft.com/azure/active-directory/reports-monitoring/reference-sign-ins-error-codes"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`o365_management_activity` Workload=AzureActiveDirectory Operation=UserLoginFailed record_type=AzureActiveDirectoryStsLogon | bucket span=5m _time | stats dc(_raw) AS failed_attempts values(user) as user values(LogonError) as LogonError values(signature) as signature values(UserAgent) as UserAgent values(dest) as dest values(vendor_account) as vendor_account values(vendor_product) as vendor_product by _time, src_ip | where failed_attempts > 10 | `high_number_of_login_failures_from_a_single_source_filter`",
    "condition": "You must install the Splunk Microsoft Office 365 Add-on and ingest Office 365 management activity events. Adjust the threshold value to suit the specific environment, as environments with naturally higher login failures might generate false positives at a lower threshold.",
    "fields": []
  },
  "falsepositives": [
    "An Ip address with more than 10 failed authentication attempts in the span of 5 minutes may also be triggered by a broken application."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}