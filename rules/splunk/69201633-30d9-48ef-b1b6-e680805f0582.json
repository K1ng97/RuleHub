{
  "id": "69201633-30d9-48ef-b1b6-e680805f0582",
  "name": "Windows Admon Group Policy Object Created",
  "description": "The following analytic detects the creation of a new Group Policy Object (GPO) using Splunk's Admon data. It identifies events where a new GPO is created, excluding default \"New Group Policy Object\" entries. Monitoring GPO creation is crucial as adversaries can exploit GPOs to escalate privileges or deploy malware across an Active Directory network. If confirmed malicious, this activity could allow attackers to control system configurations, deploy ransomware, or propagate malware, significantly compromising the network's security.",
  "source": {
    "type": "splunk",
    "id": "69201633-30d9-48ef-b1b6-e680805f0582",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_admon_group_policy_object_created.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_admon_group_policy_object_created.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1484/",
    "https://attack.mitre.org/techniques/T1484/001",
    "https://www.trustedsec.com/blog/weaponizing-group-policy-objects-access/",
    "https://adsecurity.org/?p=2716",
    "https://docs.splunk.com/Documentation/SplunkCloud/8.1.2101/Data/MonitorActiveDirectory"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`admon` admonEventType=Update objectCategory=\"CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=*\" versionNumber=0 displayName!=\"New Group Policy Object\" | stats min(_time) as firstTime max(_time) as lastTime values(gPCFileSysPath) by dcName, displayName | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_admon_group_policy_object_created_filter`",
    "condition": "To successfully implement this search, you need to be monitoring Active Directory logs using Admon. Details can be found here https://docs.splunk.com/Documentation/SplunkCloud/8.1.2101/Data/MonitorActiveDirectory",
    "fields": []
  },
  "falsepositives": [
    "Group Policy Objects are created as part of regular administrative operations, filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}