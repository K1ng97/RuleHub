{
  "id": "1adc9548-da7c-11eb-8f13-acde48001122",
  "name": "Print Spooler Failed to Load a Plug-in",
  "description": "The following analytic detects driver load errors in the Windows PrintService Admin logs, specifically identifying issues related to CVE-2021-34527 (PrintNightmare). It triggers on error messages indicating the print spooler failed to load a plug-in module, such as \"meterpreter.dll,\" with error code 0x45A. This detection method leverages specific event codes and error messages. This activity is significant as it may indicate an exploitation attempt of a known vulnerability. If confirmed malicious, an attacker could gain unauthorized code execution on the affected system, leading to potential system compromise.",
  "source": {
    "type": "splunk",
    "id": "1adc9548-da7c-11eb-8f13-acde48001122",
    "url": "https://github.com/splunk/security_content/blob/develop/print_spooler_failed_to_load_a_plug_in.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/print_spooler_failed_to_load_a_plug_in.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Michael Haag, Splunk",
  "references": [
    "https://www.truesec.com/hub/blog/fix-for-printnightmare-cve-2021-1675-exploit-to-keep-your-print-servers-running-while-a-patch-is-not-available",
    "https://www.truesec.com/hub/blog/exploitable-critical-rce-vulnerability-allows-regular-users-to-fully-compromise-active-directory-printnightmare-cve-2021-1675",
    "https://www.reddit.com/r/msp/comments/ob6y02/critical_vulnerability_printnightmare_exposes"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`printservice` ((ErrorCode=\"0x45A\" (EventCode=\"808\" OR EventCode=\"4909\")) OR (\"The print spooler failed to load a plug-in module\" OR \"\\\\drivers\\\\x64\\\\\")) | stats count min(_time) as firstTime max(_time) as lastTime by OpCode EventCode ComputerName Message | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `print_spooler_failed_to_load_a_plug_in_filter`",
    "condition": "You will need to ensure PrintService Admin and Operational logs are being logged to Splunk from critical or all systems.",
    "fields": []
  },
  "falsepositives": [
    "False positives are unknown and filtering may be required."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}