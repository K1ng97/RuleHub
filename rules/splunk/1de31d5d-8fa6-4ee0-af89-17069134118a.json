{
  "id": "1de31d5d-8fa6-4ee0-af89-17069134118a",
  "name": "Detect Baron Samedit CVE-2021-3156 via OSQuery",
  "description": "The following analytic detects the execution of the \"sudoedit -s *\" command, which is associated with the Baron Samedit CVE-2021-3156 heap-based buffer overflow vulnerability. This detection leverages the `osquery_process` data source to identify instances where this specific command is run. This activity is significant because it indicates an attempt to exploit a known vulnerability that allows privilege escalation. If confirmed malicious, an attacker could gain full control of the system, execute arbitrary code, or access sensitive data, leading to potential data breaches and system disruptions.",
  "source": {
    "type": "splunk",
    "id": "1de31d5d-8fa6-4ee0-af89-17069134118a",
    "url": "https://github.com/splunk/security_content/blob/develop/detect_baron_samedit_cve_2021_3156_via_osquery.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/detect_baron_samedit_cve_2021_3156_via_osquery.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Shannon Davis, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`osquery_process` | search \"columns.cmdline\"=\"sudoedit -s \\\\*\" | `detect_baron_samedit_cve_2021_3156_via_osquery_filter`",
    "condition": "OSQuery installed and configured to pick up process events (info at https://osquery.io) as well as using the Splunk OSQuery Add-on https://splunkbase.splunk.com/app/4402. The vulnerability is exposed when a non privledged user tries passing in a single \\ character at the end of the command while using the shell and edit flags.",
    "fields": []
  },
  "falsepositives": [
    "unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}