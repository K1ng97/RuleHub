{
  "id": "82eb7f64-d219-4e21-acfe-956de84c1a35",
  "name": "CrushFTP Authentication Bypass Exploitation",
  "description": "The following analytic detects potential exploitation of the CrushFTP authentication bypass vulnerability (CVE-2025-31161). This detection identifies suspicious command execution patterns associated with exploitation of this vulnerability, such as executing mesch.exe with specific arguments like b64exec or fullinstall. This activity is indicative of an attacker exploiting CVE-2025-31161 to gain unauthorized access to the CrushFTP server and perform post-exploitation activities.",
  "source": {
    "type": "splunk",
    "id": "82eb7f64-d219-4e21-acfe-956de84c1a35",
    "url": "https://github.com/splunk/security_content/blob/develop/crushftp_authentication_bypass_exploitation.yml",
    "file_path": "tmp/repos/splunk/detections/web/crushftp_authentication_bypass_exploitation.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://www.huntress.com/blog/crushftp-cve-2025-31161-auth-bypass-and-post-exploitation",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-31161",
    "https://www.crushftp.com/crush11wiki/Wiki.jsp?page=Update"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`crushftp` | rex field=_raw \"\\\\[HTTP:[^:]+:(?<user>[^:]+):(?<src_ip>[^\\\\]]+)\\\\]\" | rex field=_raw \"cmd:(?<process>[^\\\\*\\\\r\\\\n]+)\" | where isnotnull(process) AND (match(process, \"mesch\\.exe\") OR match(process, \"b64exec\") OR match(process, \"fullinstall\") OR match(process, \"run\")) | stats count min(_time) as firstTime max(_time) as lastTime by src_ip, user, process | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `crushftp_authentication_bypass_exploitation_filter`",
    "condition": "To implement this detection, you need to ingest CrushFTP logs into your Splunk environment. Configure CrushFTP to forward logs to Splunk via a syslog forwarder or direct file monitoring. This detection searches for CrushFTP logs containing suspicious command execution patterns commonly associated with exploitation of the CVE-2025-31161 vulnerability.",
    "fields": []
  },
  "falsepositives": [
    "False positives may occur if there are legitimate administrative commands being executed on the CrushFTP server that match the suspicious patterns. Review the commands being executed to determine if the activity is legitimate administrative work or potential malicious activity."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}