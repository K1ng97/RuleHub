{
  "id": "a1c5a85e-a162-410c-a5d9-99ff639e5a52",
  "name": "GCP Detect gcploit framework",
  "description": "The following analytic identifies the use of the GCPloit exploitation framework within Google Cloud Platform (GCP). It detects specific GCP Pub/Sub messages with a function timeout of 539 seconds, which is indicative of GCPloit activity. This detection is significant as GCPloit can be used to escalate privileges and facilitate lateral movement from compromised high-privilege accounts. If confirmed malicious, this activity could allow attackers to gain unauthorized access, escalate their privileges, and move laterally within the GCP environment, potentially compromising sensitive data and critical resources.",
  "source": {
    "type": "splunk",
    "id": "a1c5a85e-a162-410c-a5d9-99ff639e5a52",
    "url": "https://github.com/splunk/security_content/blob/develop/gcp_detect_gcploit_framework.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/gcp_detect_gcploit_framework.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Rod Soto, Splunk",
  "references": [
    "https://github.com/dxa4481/gcploit",
    "https://www.youtube.com/watch?v=Ml09R38jpok"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`google_gcp_pubsub_message` data.protoPayload.request.function.timeout=539s | table src src_user data.resource.labels.project_id data.protoPayload.request.function.serviceAccountEmail data.protoPayload.authorizationInfo{}.permission data.protoPayload.request.location http_user_agent | `gcp_detect_gcploit_framework_filter`",
    "condition": "You must install splunk GCP add-on. This search works with gcp:pubsub:message logs",
    "fields": []
  },
  "falsepositives": [
    "Payload.request.function.timeout value can possibly be match with other functions or requests however the source user and target request account may indicate an attempt to move laterally accross acounts or projects"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}