{
  "id": "eeb432d6-2212-43b6-9e89-fcd753f7da4c",
  "name": "AWS Exfiltration via Bucket Replication",
  "description": "The following analytic detects API calls to enable S3 bucket replication services. It leverages AWS CloudTrail logs to identify `PutBucketReplication` events, focusing on fields like `bucketName`, `ReplicationConfiguration.Rule.Destination.Bucket`, and user details. This activity is significant as it can indicate unauthorized data replication, potentially leading to data exfiltration. If confirmed malicious, attackers could replicate sensitive data to external accounts, leading to data breaches and compliance violations.",
  "source": {
    "type": "splunk",
    "id": "eeb432d6-2212-43b6-9e89-fcd753f7da4c",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_exfiltration_via_bucket_replication.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_exfiltration_via_bucket_replication.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://hackingthe.cloud/aws/exploitation/s3-bucket-replication-exfiltration/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail`  eventName = PutBucketReplication eventSource = s3.amazonaws.com | rename user_name as user, requestParameters.ReplicationConfiguration.Rule.Destination.Bucket as bucket_name | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product bucket_name | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_exfiltration_via_bucket_replication_filter`",
    "condition": "You must install splunk AWS add on and Splunk App for AWS. This search works with AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "It is possible that an AWS admin has legitimately implemented data replication to ensure data availability and improve data protection/backup strategies."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}