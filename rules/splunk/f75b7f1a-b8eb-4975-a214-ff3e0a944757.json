{
  "id": "f75b7f1a-b8eb-4975-a214-ff3e0a944757",
  "name": "AWS High Number Of Failed Authentications From Ip",
  "description": "The following analytic detects an IP address with 20 or more failed authentication attempts to the AWS Web Console within a 5-minute window. This detection leverages CloudTrail logs, aggregating failed login events by IP address and time span. This activity is significant as it may indicate a brute force attack aimed at gaining unauthorized access or escalating privileges within an AWS environment. If confirmed malicious, this could lead to unauthorized access, data breaches, or further exploitation of AWS resources.",
  "source": {
    "type": "splunk",
    "id": "f75b7f1a-b8eb-4975-a214-ff3e0a944757",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_high_number_of_failed_authentications_from_ip.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_high_number_of_failed_authentications_from_ip.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/003/",
    "https://www.whiteoaksecurity.com/blog/goawsconsolespray-password-spraying-tool/",
    "https://softwaresecuritydotblog.wordpress.com/2019/09/28/how-to-protect-against-credential-stuffing-on-aws/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName=ConsoleLogin action=failure | bucket span=10m _time | rename user_name as user | stats dc(_raw) AS failed_attempts values(user) as user values(user_agent) as user_agent by _time, src, signature, dest, vendor_account vendor_region, vendor_product | where failed_attempts > 20 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_high_number_of_failed_authentications_from_ip_filter`",
    "condition": "You must install Splunk Add-on for AWS in order to ingest Cloudtrail. We recommend the users to try different combinations of the bucket span time and the tried account threshold to tune this search according to their environment.",
    "fields": []
  },
  "falsepositives": [
    "An Ip address with more than 20 failed authentication attempts in the span of 5 minutes may also be triggered by a broken application."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}