{
  "id": "05c4b09f-ea28-4c7c-a7aa-a246f665c8a2",
  "name": "AWS Exfiltration via DataSync Task",
  "description": "The following analytic detects the creation of an AWS DataSync task, which could indicate potential data exfiltration. It leverages AWS CloudTrail logs to identify the `CreateTask` event from the DataSync service. This activity is significant because attackers can misuse DataSync to transfer sensitive data from a private AWS location to a public one, leading to data compromise. If confirmed malicious, this could result in unauthorized access to sensitive information, causing severe data breaches and compliance violations.",
  "source": {
    "type": "splunk",
    "id": "05c4b09f-ea28-4c7c-a7aa-a246f665c8a2",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_exfiltration_via_datasync_task.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_exfiltration_via_datasync_task.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://labs.nettitude.com/blog/how-to-exfiltrate-aws-ec2-data/",
    "https://www.shehackske.com/how-to/data-exfiltration-on-cloud-1606/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName = CreateTask eventSource=\"datasync.amazonaws.com\" | rename  requestParameters.*  as * | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product destinationLocationArn sourceLocationArn | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_exfiltration_via_datasync_task_filter`",
    "condition": "You must install splunk AWS add on and Splunk App for AWS. This search works with AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "It is possible that an AWS Administrator has legitimately created this task for creating backup. Please check the `sourceLocationArn` and `destinationLocationArn` of this task"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}