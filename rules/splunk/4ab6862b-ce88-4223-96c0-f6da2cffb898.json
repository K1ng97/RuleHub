{
  "id": "4ab6862b-ce88-4223-96c0-f6da2cffb898",
  "name": "Windows Obfuscated Files or Information via RAR SFX",
  "description": "The following analytic detects the creation of RAR Self-Extracting (SFX) files by monitoring the generation of file related to rar sfx .tmp file creation during sfx installation. This method leverages a heuristic to identify RAR SFX archives based on specific markers that indicate a combination of executable code and compressed RAR data. By tracking such activity, the analytic helps pinpoint potentially unauthorized or suspicious file creation events, which are often associated with malware packaging or data exfiltration. Legitimate usage may include custom installers or compressed file delivery.",
  "source": {
    "type": "splunk",
    "id": "4ab6862b-ce88-4223-96c0-f6da2cffb898",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_obfuscated_files_or_information_via_rar_sfx.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_obfuscated_files_or_information_via_rar_sfx.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [
    "https://www.splunk.com/en_us/blog/security/-applocker-rules-as-defense-evasion-complete-analysis.html"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`sysmon` EventCode=11 TargetFilename IN (\"*__tmp_rar_sfx_access_check*\") | stats count min(_time) as firstTime max(_time) as lastTime by action dest file_name file_path  process_guid process_id user user_id vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_obfuscated_files_or_information_via_rar_sfx_filter`",
    "condition": "To successfully implement this search, you need to be ingesting logs with the process name, TargetFilename, and eventcode 11 executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA. Tune and filter known instances where rar sfx executable may be used.",
    "fields": []
  },
  "falsepositives": [
    "It can detect a third part utility software tool compiled to rar sfx."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}