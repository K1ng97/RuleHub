{
  "id": "bce3ed7c-9b1f-42a0-abdf-d8b123a34836",
  "name": "Detect New Login Attempts to Routers",
  "description": "The following analytic identifies new login attempts to routers. It leverages authentication logs from the ES Assets and Identity Framework, focusing on assets categorized as routers. The detection flags connections that have not been observed in the past 30 days. This activity is significant because unauthorized access to routers can lead to network disruptions or data interception. If confirmed malicious, attackers could gain control over network traffic, potentially leading to data breaches or further network compromise.",
  "source": {
    "type": "splunk",
    "id": "bce3ed7c-9b1f-42a0-abdf-d8b123a34836",
    "url": "https://github.com/splunk/security_content/blob/develop/detect_new_login_attempts_to_routers.yml",
    "file_path": "tmp/repos/splunk/detections/application/detect_new_login_attempts_to_routers.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count earliest(_time) as earliest latest(_time) as latest from datamodel=Authentication where Authentication.dest_category=router by Authentication.dest Authentication.user| eval isOutlier=if(earliest >= relative_time(now(), \"-30d@d\"), 1, 0) | where isOutlier=1| `security_content_ctime(earliest)`| `security_content_ctime(latest)` | `drop_dm_object_name(\"Authentication\")` | `detect_new_login_attempts_to_routers_filter`",
    "condition": "To successfully implement this search, you must ensure the network router devices are categorized as \"router\" in the Assets and identity table. You must also populate the Authentication data model with logs related to users authenticating to routing infrastructure.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate router connections may appear as new connections"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}