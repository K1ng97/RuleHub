{
  "id": "908bf0d5-0983-4afd-b6a4-e9eb5d361a7d",
  "name": "Windows Remote Desktop Network Bruteforce Attempt",
  "description": "The following analytic identifies potential Remote Desktop Protocol (RDP) brute force attacks by monitoring network traffic for RDP application activity. This query detects potential RDP brute force attacks by identifying source IPs that have made more than 10 connection attempts to the same RDP port on a host within a one-hour window. The results are presented in a table that includes the source and destination IPs, destination port, number of attempts, and the times of the first and last connection attempts, helping to prioritize IPs based on the intensity of activity.",
  "source": {
    "type": "splunk",
    "id": "908bf0d5-0983-4afd-b6a4-e9eb5d361a7d",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_remote_desktop_network_bruteforce_attempt.yml",
    "file_path": "tmp/repos/splunk/detections/network/windows_remote_desktop_network_bruteforce_attempt.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Jose Hernandez, Bhavin Patel, Splunk",
  "references": [
    "https://www.zscaler.com/blogs/security-research/ransomware-delivered-using-rdp-brute-force-attack",
    "https://www.reliaquest.com/blog/rdp-brute-force-attacks/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count, min(_time) as firstTime, max(_time) as lastTime values(Al_Traffic.src_port) as src_port from datamodel=Network_Traffic where (All_Traffic.app=rdp OR All_Traffic.dest_port=3389)   by All_Traffic.action All_Traffic.app All_Traffic.dest All_Traffic.dest_ip All_Traffic.dest_port All_Traffic.direction  All_Traffic.dvc All_Traffic.protocol All_Traffic.protocol_version All_Traffic.src All_Traffic.src_ip  All_Traffic.transport All_Traffic.user All_Traffic.vendor_product | `drop_dm_object_name(\"All_Traffic\")`  | eval duration=lastTime-firstTime  | where count > 10 AND duration < 3600  | `security_content_ctime(firstTime)`  | `security_content_ctime(lastTime)`  | `windows_remote_desktop_network_bruteforce_attempt_filter`",
    "condition": "You must ensure that your network traffic data is populating the Network_Traffic data model. Adjust the count and duration thresholds as necessary to tune the sensitivity of your detection.",
    "fields": []
  },
  "falsepositives": [
    "RDP gateways may have unusually high amounts of traffic from all other hosts' RDP applications in the network.Any legitimate RDP traffic using wrong/expired credentials will be also detected as a false positive."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}