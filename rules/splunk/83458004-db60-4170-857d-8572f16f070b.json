{
  "id": "83458004-db60-4170-857d-8572f16f070b",
  "name": "Windows Admon Default Group Policy Object Modified",
  "description": "The following analytic detects modifications to the default Group Policy Objects (GPOs) in an Active Directory environment. It leverages Splunk's Admon to monitor updates to the \"Default Domain Policy\" and \"Default Domain Controllers Policy.\" This activity is significant because changes to these default GPOs can indicate an adversary with privileged access attempting to gain further control, establish persistence, or deploy malware across multiple hosts. If confirmed malicious, such modifications could lead to widespread policy enforcement changes, unauthorized access, and potential compromise of the entire domain environment.",
  "source": {
    "type": "splunk",
    "id": "83458004-db60-4170-857d-8572f16f070b",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_admon_default_group_policy_object_modified.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_admon_default_group_policy_object_modified.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1484/",
    "https://attack.mitre.org/techniques/T1484/001",
    "https://www.trustedsec.com/blog/weaponizing-group-policy-objects-access/",
    "https://adsecurity.org/?p=2716",
    "https://docs.splunk.com/Documentation/SplunkCloud/8.1.2101/Data/MonitorActiveDirectory"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`admon` admonEventType=Update objectCategory=\"CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=*\" (displayName=\"Default Domain Policy\" OR displayName=\"Default Domain Controllers Policy\") | stats min(_time) as firstTime max(_time) as lastTime values(gPCFileSysPath) by dcName, displayName | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_admon_default_group_policy_object_modified_filter`",
    "condition": "To successfully implement this search, you need to be monitoring Active Directory logs using Admon. Details can be found here https://docs.splunk.com/Documentation/SplunkCloud/8.1.2101/Data/MonitorActiveDirectory",
    "fields": []
  },
  "falsepositives": [
    "The default Group Policy Objects within an AD network may be legitimately updated for administrative operations, filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}