{
  "id": "bb1c2c30-107a-4e56-a4b9-1f7022867bfe",
  "name": "F5 BIG-IP iControl REST Vulnerability CVE-2022-1388",
  "description": "The following analytic detects attempts to exploit the F5 BIG-IP iControl REST API vulnerability (CVE-2022-1388) for unauthenticated remote code execution. It identifies suspicious URI paths and POST HTTP methods, along with specific request headers containing potential commands in the `utilcmdargs` field and a random base64 encoded value in the `X-F5-Auth-Token` field. This activity is significant as it targets a critical vulnerability that can allow attackers to execute arbitrary commands on the affected system. If confirmed malicious, this could lead to full system compromise and unauthorized access to sensitive data.",
  "source": {
    "type": "splunk",
    "id": "bb1c2c30-107a-4e56-a4b9-1f7022867bfe",
    "url": "https://github.com/splunk/security_content/blob/develop/f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388.yml",
    "file_path": "tmp/repos/splunk/detections/network/f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/dk4trin/templates-nuclei/blob/main/CVE-2022-1388.yaml",
    "https://www.randori.com/blog/vulnerability-analysis-cve-2022-1388/",
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388",
    "https://twitter.com/da_667/status/1523770267327250438?s=20&t=-JnB_aNWuJFsmcOmxGUWLQ",
    "https://github.com/horizon3ai/CVE-2022-1388/blob/main/CVE-2022-1388.py"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count from datamodel=Web where Web.url=\"*/mgmt/tm/util/bash*\" Web.http_method=\"POST\" by Web.http_user_agent Web.http_method, Web.url,Web.url_length Web.src, Web.dest | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388_filter`",
    "condition": "To successfully implement this search, you need to be ingesting web or proxy logs, or ensure it is being filled by a proxy like device, into the Web Datamodel. For additional filtering, allow list private IP space or restrict by known good.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present if the activity is blocked or was not successful. Filter known vulnerablity scanners. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}