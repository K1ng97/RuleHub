{
  "id": "81263de4-160a-11ec-944f-acde48001122",
  "name": "Non Chrome Process Accessing Chrome Default Dir",
  "description": "The following analytic detects a non-Chrome process accessing files in the Chrome user default folder. It leverages Windows Security Event logs, specifically event code 4663, to identify unauthorized access attempts. This activity is significant because the Chrome default folder contains sensitive user data such as login credentials, browsing history, and cookies. If confirmed malicious, this behavior could indicate an attempt to exfiltrate sensitive information, often associated with RATs, trojans, and advanced persistent threats like FIN7. Such access could lead to data theft and further compromise of the affected system.",
  "source": {
    "type": "splunk",
    "id": "81263de4-160a-11ec-944f-acde48001122",
    "url": "https://github.com/splunk/security_content/blob/develop/non_chrome_process_accessing_chrome_default_dir.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/non_chrome_process_accessing_chrome_default_dir.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4663 NOT (ProcessName IN (\"*\\\\chrome.exe\", \"*\\\\explorer.exe\", \"*sql*\")) ObjectName=\"*\\\\Google\\\\Chrome\\\\User Data\\\\Default*\" | stats count min(_time) as firstTime max(_time) as lastTime by ObjectName ObjectType ProcessName AccessMask EventCode dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `non_chrome_process_accessing_chrome_default_dir_filter`",
    "condition": "To successfully implement this search, you must ingest Windows Security Event logs and track event code 4663. For 4663, enable \"Audit Object Access\" in Group Policy. Then check the two boxes listed for both \"Success\" and \"Failure.\"",
    "fields": []
  },
  "falsepositives": [
    "other browser not listed related to chrome may catch by this rule."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}