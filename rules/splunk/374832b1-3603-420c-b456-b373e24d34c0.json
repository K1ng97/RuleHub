{
  "id": "374832b1-3603-420c-b456-b373e24d34c0",
  "name": "AWS Multi-Factor Authentication Disabled",
  "description": "The following analytic detects attempts to disable multi-factor authentication (MFA) for an AWS IAM user. It leverages AWS CloudTrail logs to identify events where MFA devices are deleted or deactivated. This activity is significant because disabling MFA can indicate an adversary attempting to weaken account security, potentially to maintain persistence using a compromised account. If confirmed malicious, this action could allow attackers to retain access to the AWS environment without detection, posing a significant risk to the security and integrity of the cloud infrastructure.",
  "source": {
    "type": "splunk",
    "id": "374832b1-3603-420c-b456-b373e24d34c0",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_multi_factor_authentication_disabled.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_multi_factor_authentication_disabled.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1621/",
    "https://aws.amazon.com/what-is/mfa/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` (eventName= DeleteVirtualMFADevice OR eventName=DeactivateMFADevice) | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_multi_factor_authentication_disabled_filter`",
    "condition": "The Splunk AWS Add-on is required to utilize this data. The search requires AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "AWS Administrators may disable MFA but it is highly unlikely for this event to occur without prior notice to the company"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}