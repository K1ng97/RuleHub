{
  "id": "c783dd98-c703-4252-9e8a-f19d9f5c949e",
  "name": "O365 Disable MFA",
  "description": "The following analytic identifies instances where Multi-Factor Authentication (MFA) is disabled for a user within the Office 365 environment. It leverages O365 audit logs, specifically focusing on events related to MFA settings. Disabling MFA removes a critical security layer, making accounts more vulnerable to unauthorized access. If confirmed malicious, this activity could indicate an attacker attempting to maintain persistence or an insider threat, significantly increasing the risk of unauthorized access. Immediate investigation is required to validate the reason for disabling MFA, potentially re-enable it, and assess any other suspicious activities related to the affected account.",
  "source": {
    "type": "splunk",
    "id": "c783dd98-c703-4252-9e8a-f19d9f5c949e",
    "url": "https://github.com/splunk/security_content/blob/develop/o365_disable_mfa.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/o365_disable_mfa.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Rod Soto, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1556/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`o365_management_activity` Operation=\"Disable Strong Authentication.\" | rename UserId as user object as src_user | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user src vendor_account vendor_product src_user | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `o365_disable_mfa_filter`",
    "condition": "You must install the Splunk Microsoft Office 365 add-on. This search works with o365:management:activity",
    "fields": []
  },
  "falsepositives": [
    "Unless it is a special case, it is uncommon to disable MFA or Strong Authentication"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}