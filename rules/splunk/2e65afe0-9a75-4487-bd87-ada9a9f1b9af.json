{
  "id": "2e65afe0-9a75-4487-bd87-ada9a9f1b9af",
  "name": "Windows Credentials from Password Stores Chrome Extension Access",
  "description": "The following analytic detects non-Chrome processes attempting to access the Chrome extensions file. It leverages Windows Security Event logs, specifically event code 4663, to identify this behavior. This activity is significant because adversaries may exploit this file to extract sensitive information from the Chrome browser, posing a security risk. If confirmed malicious, this could lead to unauthorized access to stored credentials and other sensitive data, potentially compromising the security of the affected system and broader network.",
  "source": {
    "type": "splunk",
    "id": "2e65afe0-9a75-4487-bd87-ada9a9f1b9af",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_credentials_from_password_stores_chrome_extension_access.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_credentials_from_password_stores_chrome_extension_access.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [
    "https://malpedia.caad.fkie.fraunhofer.de/details/win.redline_stealer"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4663 object_file_path=\"*\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Local Extension Settings\\\\*\" AND NOT (process_path IN (\"*:\\\\Windows\\\\explorer.exe\", \"*\\\\chrome.exe\")) | stats count min(_time) as firstTime max(_time) as lastTime by object_file_name object_file_path process_name process_path  process_id EventCode dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_credentials_from_password_stores_chrome_extension_access_filter`",
    "condition": "To successfully implement this search, you must ingest Windows Security Event logs and track event code 4663. For 4663, enable \"Audit Object Access\" in Group Policy. Then check the two boxes listed for both \"Success\" and \"Failure.\"",
    "fields": []
  },
  "falsepositives": [
    "Uninstall chrome browser extension application may access this file and folder path to removed chrome installation in the target host. Filter is needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}