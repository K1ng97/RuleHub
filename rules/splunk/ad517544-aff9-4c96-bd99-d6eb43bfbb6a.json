{
  "id": "ad517544-aff9-4c96-bd99-d6eb43bfbb6a",
  "name": "Windows Event Log Cleared",
  "description": "The following analytic detects the clearing of Windows event logs by identifying Windows Security Event ID 1102 or System log event 104. This detection leverages Windows event logs to monitor for log clearing activities. Such behavior is significant as it may indicate an attempt to cover tracks after malicious activities. If confirmed malicious, this action could hinder forensic investigations and allow attackers to persist undetected, making it crucial to investigate further and correlate with other alerts and data sources.",
  "source": {
    "type": "splunk",
    "id": "ad517544-aff9-4c96-bd99-d6eb43bfbb6a",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_event_log_cleared.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_event_log_cleared.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Rico Valdez, Michael Haag, Splunk",
  "references": [
    "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-1102",
    "https://www.ired.team/offensive-security/defense-evasion/disabling-windows-event-logs-by-suspending-eventlog-service-threads",
    "https://attack.mitre.org/techniques/T1070/001/",
    "https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.001/T1070.001.md"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "(`wineventlog_security` EventCode=1102) OR (`wineventlog_system` EventCode=104) | stats count min(_time) as firstTime max(_time) as lastTime by action app change_type dest dvc name object_attrs object_category signature signature_id src_user status subject user vendor_product object EventCode | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_event_log_cleared_filter`",
    "condition": "To successfully implement this search, you need to be ingesting Windows event logs from your hosts. In addition, the Splunk Windows TA is needed.",
    "fields": []
  },
  "falsepositives": [
    "It is possible that these logs may be legitimately cleared by Administrators. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}