{
  "id": "8b4e3d62-f743-11ee-9f6e-acde48001123",
  "name": "AWS Bedrock Delete Knowledge Base",
  "description": "The following analytic identifies attempts to delete AWS Bedrock Knowledge Bases, which are resources that store and manage domain-specific information for AI models. It monitors AWS CloudTrail logs for DeleteKnowledgeBase API calls. This activity could indicate an adversary attempting to remove knowledge bases after compromising credentials, potentially to disrupt business operations or remove traces of data access. Deleting knowledge bases could impact model performance, remove critical business context, or be part of a larger attack to degrade AI capabilities. If confirmed malicious, this could represent a deliberate attempt to cause service disruption or data loss.",
  "source": {
    "type": "splunk",
    "id": "8b4e3d62-f743-11ee-9f6e-acde48001123",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_bedrock_delete_knowledge_base.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_bedrock_delete_knowledge_base.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://www.sumologic.com/blog/defenders-guide-to-aws-bedrock/",
    "https://attack.mitre.org/techniques/T1562/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventSource=bedrock.amazonaws.com eventName=DeleteKnowledgeBase  | rename user_name as user  | stats count min(_time) as firstTime max(_time) as lastTime values(requestParameters.knowledgeBaseId) as knowledgeBaseIds by src user user_agent vendor_account vendor_product dest signature vendor_region  | `security_content_ctime(firstTime)`  | `security_content_ctime(lastTime)` | `aws_bedrock_delete_knowledge_base_filter`",
    "condition": "The Splunk AWS Add-on is required to utilize this data. The search requires AWS CloudTrail logs with Bedrock service events enabled. You must install and configure the AWS App for Splunk (version 6.0.0 or later) and Splunk Add-on for AWS (version 5.1.0 or later) to collect CloudTrail logs from AWS. Ensure the CloudTrail is capturing Bedrock Knowledge Base management events.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate administrators may delete Knowledge Bases as part of normal operations, such as when replacing outdated knowledge bases, removing test resources, or consolidating information. Consider implementing an allowlist for expected administrators who regularly manage Knowledge Base configurations."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}