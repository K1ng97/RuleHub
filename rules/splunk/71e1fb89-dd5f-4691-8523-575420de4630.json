{
  "id": "71e1fb89-dd5f-4691-8523-575420de4630",
  "name": "AWS Multiple Users Failing To Authenticate From Ip",
  "description": "The following analytic identifies a single source IP failing to authenticate into the AWS Console with 30 unique valid users within 10 minutes. It leverages CloudTrail logs to detect multiple failed login attempts from the same IP address. This behavior is significant as it may indicate a Password Spraying attack, where an adversary attempts to gain unauthorized access or elevate privileges by trying common passwords across many accounts. If confirmed malicious, this activity could lead to unauthorized access, data breaches, or further exploitation within the AWS environment.",
  "source": {
    "type": "splunk",
    "id": "71e1fb89-dd5f-4691-8523-575420de4630",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_multiple_users_failing_to_authenticate_from_ip.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_multiple_users_failing_to_authenticate_from_ip.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "manual_test",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel",
  "references": [
    "https://attack.mitre.org/techniques/T1110/003/",
    "https://www.whiteoaksecurity.com/blog/goawsconsolespray-password-spraying-tool/",
    "https://softwaresecuritydotblog.wordpress.com/2019/09/28/how-to-protect-against-credential-stuffing-on-aws/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName=ConsoleLogin action=failure | bucket span=10m _time | rename user_name as user | stats  dc(user) AS unique_accounts values(user) as user values(user_agent) as user_agent by _time, src, signature, dest, vendor_account, vendor_region, vendor_product | where unique_accounts>30 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_multiple_users_failing_to_authenticate_from_ip_filter`",
    "condition": "You must install Splunk Add-on for AWS in order to ingest Cloudtrail. We recommend the users to try different combinations of the bucket span time and the tried account threshold to tune this search according to their environment.",
    "fields": []
  },
  "falsepositives": [
    "No known false postives for this detection. Please review this alert"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}