{
  "id": "b04be6e5-2002-4349-8742-52285635b8f5",
  "name": "Ivanti VTM New Account Creation",
  "description": "This analytic detects potential exploitation of the Ivanti Virtual Traffic Manager (vTM) authentication bypass vulnerability (CVE-2024-7593) to create new administrator accounts. The vulnerability allows unauthenticated remote attackers to bypass authentication on the admin panel and create new admin users. This detection looks for suspicious new account creation events in the Ivanti vTM audit logs that lack expected authentication details, which may indicate exploitation attempts.",
  "source": {
    "type": "splunk",
    "id": "b04be6e5-2002-4349-8742-52285635b8f5",
    "url": "https://github.com/splunk/security_content/blob/develop/ivanti_vtm_new_account_creation.yml",
    "file_path": "tmp/repos/splunk/detections/application/ivanti_vtm_new_account_creation.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://www.ivanti.com/security/security-advisories/ivanti-virtual-traffic-manager-vtm-cve-2024-7593",
    "https://nvd.nist.gov/vuln/detail/CVE-2024-7593"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`ivanti_vtm_audit` OPERATION=\"adduser\" MODGROUP=\"admin\" IP=\"!!ABSENT!!\" | stats count min(_time) as firstTime max(_time) as lastTime by IP, MODUSER, OPERATION, MODGROUP, AUTH | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `ivanti_vtm_new_account_creation_filter`",
    "condition": "To implement this detection, ensure that Ivanti vTM audit logs are being ingested into Splunk. Configure the Ivanti vTM to send its audit logs to Splunk via syslog or by monitoring the log files directly. The sourcetype should be set to \"ivanti_vtm_audit\" or a similar custom sourcetype for these logs.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate new account creation by authorized administrators will generate similar log entries. However, those should include proper authentication details. Verify any detected events against expected administrative activities and authorized user lists."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}