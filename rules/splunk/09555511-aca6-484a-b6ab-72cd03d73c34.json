{
  "id": "09555511-aca6-484a-b6ab-72cd03d73c34",
  "name": "Windows Local Administrator Credential Stuffing",
  "description": "The following analytic detects attempts to authenticate using the built-in local Administrator account across more than 30 endpoints within a 5-minute window. It leverages Windows Event Logs, specifically events 4625 and 4624, to identify this behavior. This activity is significant as it may indicate an adversary attempting to validate stolen local credentials across multiple hosts, potentially leading to privilege escalation. If confirmed malicious, this could allow the attacker to gain widespread access and control over numerous systems within the network, posing a severe security risk.",
  "source": {
    "type": "splunk",
    "id": "09555511-aca6-484a-b6ab-72cd03d73c34",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_local_administrator_credential_stuffing.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_local_administrator_credential_stuffing.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/004/",
    "https://attack.mitre.org/techniques/T1110/",
    "https://www.blackhillsinfosec.com/wide-spread-local-admin-testing/",
    "https://www.pentestpartners.com/security-blog/admin-password-re-use-dont-do-it/",
    "https://www.praetorian.com/blog/microsofts-local-administrator-password-solution-laps/",
    "https://wiki.porchetta.industries/smb-protocol/password-spraying"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4625 OR EventCode=4624 Logon_Type=3 TargetUserName=Administrator | bucket span=5m _time | stats dc(Computer) AS unique_targets values(Computer) as host_targets values(dest) as dest values(src) as src values(user) as user by _time, IpAddress, TargetUserName, EventCode, action, app, authentication_method, signature, signature_id | where unique_targets > 30 | `windows_local_administrator_credential_stuffing_filter`",
    "condition": "To successfully implement this search, you need to be ingesting Windows Event Logs from domain controllers as well as member servers and workstations. The Advanced Security Audit policy setting `Audit Logon` within `Logon/Logoff` needs to be enabled.",
    "fields": []
  },
  "falsepositives": [
    "Vulnerability scanners or system administration tools may also trigger this detection. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}