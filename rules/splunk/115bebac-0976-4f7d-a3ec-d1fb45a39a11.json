{
  "id": "115bebac-0976-4f7d-a3ec-d1fb45a39a11",
  "name": "Confluence Data Center and Server Privilege Escalation",
  "description": "The following analytic identifies potential exploitation attempts on a known vulnerability in Atlassian Confluence, specifically targeting the /setup/*.action* URL pattern. It leverages web logs within the Splunk 'Web' Data Model, filtering for successful accesses (HTTP status 200) to these endpoints. This activity is significant as it suggests attackers might be exploiting a privilege escalation flaw in Confluence. If confirmed malicious, it could result in unauthorized access or account creation with escalated privileges, leading to potential data breaches or further exploitation within the environment.",
  "source": {
    "type": "splunk",
    "id": "115bebac-0976-4f7d-a3ec-d1fb45a39a11",
    "url": "https://github.com/splunk/security_content/blob/develop/confluence_data_center_and_server_privilege_escalation.yml",
    "file_path": "tmp/repos/splunk/detections/web/confluence_data_center_and_server_privilege_escalation.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://confluence.atlassian.com/security/cve-2023-22515-privilege-escalation-vulnerability-in-confluence-data-center-and-server-1295682276.html",
    "https://confluence.atlassian.com/security/cve-2023-22518-improper-authorization-vulnerability-in-confluence-data-center-and-server-1311473907.html",
    "https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/",
    "https://attackerkb.com/topics/Q5f0ItSzw5/cve-2023-22515/rapid7-analysis"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"*/setup/setupadministrator.action*\", \"*/setup/finishsetup.action*\", \"*/json/setup-restore-local.action*\", \"*/json/setup-restore-progress.action*\", \"*/json/setup-restore.action*\", \"*/bootstrap/selectsetupstep.action*\") Web.status=200 by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `confluence_data_center_and_server_privilege_escalation_filter`",
    "condition": "To successfully implement this search you need to be ingesting information on Web traffic that include fields relavent for traffic into the `Web` datamodel.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present with legitimate applications. Attempt to filter by dest IP or use Asset groups to restrict to confluence servers."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}