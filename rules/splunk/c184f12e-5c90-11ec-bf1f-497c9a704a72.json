{
  "id": "c184f12e-5c90-11ec-bf1f-497c9a704a72",
  "name": "Log4Shell JNDI Payload Injection Attempt",
  "description": "The following analytic identifies attempts to inject Log4Shell JNDI payloads via web calls. It leverages the Web datamodel and uses regex to detect patterns like `${jndi:ldap://` in raw web event data, including HTTP headers. This activity is significant because it targets vulnerabilities in Java web applications using Log4j, such as Apache Struts and Solr. If confirmed malicious, this could allow attackers to execute arbitrary code, potentially leading to full system compromise. Immediate investigation is required to determine if the attempt was successful and to mitigate any potential exploitation.",
  "source": {
    "type": "splunk",
    "id": "c184f12e-5c90-11ec-bf1f-497c9a704a72",
    "url": "https://github.com/splunk/security_content/blob/develop/log4shell_jndi_payload_injection_attempt.yml",
    "file_path": "tmp/repos/splunk/detections/web/log4shell_jndi_payload_injection_attempt.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Jose Hernandez",
  "references": [
    "https://www.lunasec.io/docs/blog/log4j-zero-day/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| from datamodel Web.Web | regex _raw=\"[jJnNdDiI]{4}(\\:|\\%3A|\\/|\\%2F)\\w+(\\:\\/\\/|\\%3A\\%2F\\%2F)(\\$\\{.*?\\}(\\.)?)?\" | fillnull | stats count by action, category, dest, dest_port, http_content_type, http_method, http_referrer, http_user_agent, site, src, url, url_domain, user | `log4shell_jndi_payload_injection_attempt_filter`",
    "condition": "This detection requires the Web datamodel to be populated from a supported Technology Add-On like Splunk for Apache or Splunk for Nginx.",
    "fields": []
  },
  "falsepositives": [
    "If there is a vulnerablility scannner looking for log4shells this will trigger, otherwise likely to have low false positives."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}