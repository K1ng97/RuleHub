{
  "id": "b9bc5513-6fc1-4821-85a3-e1d81e451c83",
  "name": "GCP Multi-Factor Authentication Disabled",
  "description": "The following analytic detects an attempt to disable multi-factor authentication (MFA) for a Google Cloud Platform (GCP) user. It leverages Google Workspace Admin log events, specifically the `UNENROLL_USER_FROM_STRONG_AUTH` command. This activity is significant because disabling MFA can allow an adversary to maintain persistence within the environment using a compromised account without raising suspicion. If confirmed malicious, this action could enable attackers to bypass additional security layers, potentially leading to unauthorized access, data exfiltration, or further exploitation of the compromised account.",
  "source": {
    "type": "splunk",
    "id": "b9bc5513-6fc1-4821-85a3-e1d81e451c83",
    "url": "https://github.com/splunk/security_content/blob/develop/gcp_multi_factor_authentication_disabled.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/gcp_multi_factor_authentication_disabled.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Mauricio Velazco, Splunk",
  "references": [
    "https://support.google.com/cloudidentity/answer/2537800?hl=en",
    "https://attack.mitre.org/tactics/TA0005/",
    "https://attack.mitre.org/techniques/T1556/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`gws_reports_admin` command=UNENROLL_USER_FROM_STRONG_AUTH | stats count min(_time) as firstTime max(_time) as lastTime by user, command, actor.email, status, id.applicationName, event.name, vendor_account, action | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `gcp_multi_factor_authentication_disabled_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Google Workspace from Splunkbase (https://splunkbase.splunk.com/app/5556) which allows Splunk administrators to collect Google Workspace event data in Splunk using Google Workspace APIs. Specifically, this analytic leverages the Admin log events.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use case may require for users to disable MFA. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}