{
  "id": "04455dd3-ced7-480f-b8e6-5469b99e98e2",
  "name": "AWS Exfiltration via Batch Service",
  "description": "The following analytic identifies the creation of AWS Batch jobs that could potentially abuse the AWS Bucket Replication feature on S3 buckets. It leverages AWS CloudTrail logs to detect the `JobCreated` event, analyzing job details and their status. This activity is significant because attackers can exploit this feature to exfiltrate data by creating malicious batch jobs. If confirmed malicious, this could lead to unauthorized data transfer between S3 buckets, resulting in data breaches and loss of sensitive information.",
  "source": {
    "type": "splunk",
    "id": "04455dd3-ced7-480f-b8e6-5469b99e98e2",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_exfiltration_via_batch_service.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_exfiltration_via_batch_service.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://hackingthe.cloud/aws/exploitation/s3-bucket-replication-exfiltration/",
    "https://bleemb.medium.com/data-exfiltration-with-native-aws-s3-features-c94ae4d13436"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName = JobCreated | fillnull | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_exfiltration_via_batch_service_filter`",
    "condition": "You must install splunk AWS add on and Splunk App for AWS. This search works with AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "It is possible that an AWS Administrator or a user has legitimately created this job for some tasks."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}