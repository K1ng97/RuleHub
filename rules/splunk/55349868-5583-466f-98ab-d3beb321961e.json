{
  "id": "55349868-5583-466f-98ab-d3beb321961e",
  "name": "AWS Console Login Failed During MFA Challenge",
  "description": "The following analytic identifies failed authentication attempts to the AWS Console during the Multi-Factor Authentication (MFA) challenge. It leverages AWS CloudTrail logs, specifically the `additionalEventData` field, to detect when MFA was used but the login attempt still failed. This activity is significant as it may indicate an adversary attempting to access an account with compromised credentials but being thwarted by MFA. If confirmed malicious, this could suggest an ongoing attempt to breach the account, potentially leading to unauthorized access and further attacks if MFA is bypassed.",
  "source": {
    "type": "splunk",
    "id": "55349868-5583-466f-98ab-d3beb321961e",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_console_login_failed_during_mfa_challenge.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_console_login_failed_during_mfa_challenge.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1621/",
    "https://aws.amazon.com/what-is/mfa/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName= ConsoleLogin errorMessage=\"Failed authentication\" additionalEventData.MFAUsed = \"Yes\" | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product additionalEventData.MFAUsed errorMessage | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_console_login_failed_during_mfa_challenge_filter`",
    "condition": "The Splunk AWS Add-on is required to utilize this data. The search requires AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate users may miss to reply the MFA challenge within the time window or deny it by mistake."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}