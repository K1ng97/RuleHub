{
  "id": "c0d89118-3f89-4cd7-8140-1f39e7210681",
  "name": "Windows Credentials Access via VaultCli Module",
  "description": "The following analytic detects potentially abnormal interactions with VaultCLI.dll, particularly those initiated by processes located in publicly writable Windows folder paths. The VaultCLI.dll module allows processes to extract credentials from the Windows Credential Vault. It was seen being abused by information stealers such as Meduza. The analytic monitors suspicious API calls, unauthorized credential access patterns, and anomalous process behaviors indicative of malicious activity. By leveraging a combination of signature-based detection and behavioral analysis, it effectively flags attempts to misuse the vault for credential theft, enabling swift response to protect sensitive user data and ensure system security.",
  "source": {
    "type": "splunk",
    "id": "c0d89118-3f89-4cd7-8140-1f39e7210681",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_credentials_access_via_vaultcli_module.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_credentials_access_via_vaultcli_module.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [
    "https://hijacklibs.net/entries/microsoft/built-in/vaultcli.html",
    "https://www.fortinet.com/blog/threat-research/exploiting-cve-2024-21412-stealer-campaign-unleashed",
    "https://cert.gov.ua/article/6276652",
    "https://cert.gov.ua/article/6281018",
    "https://g0njxa.medium.com/approaching-stealers-devs-a-brief-interview-with-meduza-f1bbd2efb84f"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`sysmon` EventCode=7  ImageLoaded =\"*\\\\vaultcli.dll\" process_path IN(\"*\\\\windows\\\\fonts\\\\*\", \"*\\\\windows\\\\temp\\\\*\", \"*\\\\users\\\\public\\\\*\", \"*\\\\windows\\\\debug\\\\*\", \"*\\\\Users\\\\Administrator\\\\Music\\\\*\", \"*\\\\Windows\\\\servicing\\\\*\", \"*\\\\Users\\\\Default\\\\*\", \"*Recycle.bin*\", \"*\\\\Windows\\\\Media\\\\*\", \"\\\\Windows\\\\repair\\\\*\", \"*\\\\appdata\\\\local\\\\temp\\\\*\", \"*\\\\PerfLogs\\\\*\", \"*:\\\\temp\\\\*\") | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by Image ImageLoaded dest loaded_file loaded_file_path original_file_name process_exec process_guid process_hash process_id process_name process_path service_dll_signature_exists service_dll_signature_verified signature signature_id user_id vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_credentials_access_via_vaultcli_module_filter`",
    "condition": "To successfully implement this search, you need to be ingesting logs with the process name and imageloaded executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
    "fields": []
  },
  "falsepositives": [
    "Third party software might leverage this DLL in order to make use of the Credential Manager feature via the provided exports. Typically the vaultcli.dll module is loaded by the vaultcmd.exe Windows Utility to interact with the Windows Credential Manager for secure storage and retrieval of credentials."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}