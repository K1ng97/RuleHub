{
  "id": "860902fd-2e76-46b3-b050-ba548dab576c",
  "name": "Azure Automation Account Created",
  "description": "The following analytic detects the creation of a new Azure Automation account within an Azure tenant. It leverages Azure Audit events, specifically the Azure Activity log category, to identify when an account is created or updated. This activity is significant because Azure Automation accounts can be used to automate tasks and orchestrate actions across Azure and on-premise environments. If an attacker creates an Automation account with elevated privileges, they could maintain persistence, execute malicious runbooks, and potentially escalate privileges or execute code on virtual machines, posing a significant security risk.",
  "source": {
    "type": "splunk",
    "id": "860902fd-2e76-46b3-b050-ba548dab576c",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_automation_account_created.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_automation_account_created.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://docs.microsoft.com/en-us/azure/automation/overview",
    "https://docs.microsoft.com/en-us/azure/automation/automation-create-standalone-account?tabs=azureportal",
    "https://docs.microsoft.com/en-us/azure/automation/automation-hybrid-runbook-worker",
    "https://www.inversecos.com/2021/12/how-to-detect-malicious-azure.html",
    "https://www.netspi.com/blog/technical/cloud-penetration-testing/maintaining-azure-persistence-via-automation-accounts/",
    "https://microsoft.github.io/Azure-Threat-Research-Matrix/Persistence/AZT503/AZT503-3/",
    "https://attack.mitre.org/techniques/T1136/003/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_audit` operationName.localizedValue=\"Create or Update an Azure Automation account\" status.value=Succeeded | dedup object | rename claims.ipaddr as src, subscriptionId as vendor_account, operationName.localizedValue as signature | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product object object_path signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_automation_account_created_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase (https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Audit events into your Splunk environment. Specifically, this analytic leverages the Azure Activity log category.",
    "fields": []
  },
  "falsepositives": [
    "Administrators may legitimately create Azure Automation accounts. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}