{
  "id": "a19b354d-0d7f-47f3-8ea6-1a7c36434968",
  "name": "AWS Credential Access Failed Login",
  "description": "The following analytic identifies unsuccessful login attempts to the AWS Management Console using a specific user identity. It leverages AWS CloudTrail logs to detect failed authentication events associated with the AWS ConsoleLogin action. This activity is significant for a SOC because repeated failed login attempts may indicate a brute force attack or unauthorized access attempts. If confirmed malicious, an attacker could potentially gain access to AWS account services and resources, leading to data breaches, resource manipulation, or further exploitation within the AWS environment.",
  "source": {
    "type": "splunk",
    "id": "a19b354d-0d7f-47f3-8ea6-1a7c36434968",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_credential_access_failed_login.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_credential_access_failed_login.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Gowthamaraj Rajendran, Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/001/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName = ConsoleLogin errorMessage=\"Failed authentication\" | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_credential_access_failed_login_filter`",
    "condition": "You must install splunk AWS add on and Splunk App for AWS. This search works with AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "Users may genuinely mistype or forget the password."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}