{
  "id": "35eb6d19-a497-400c-93c5-645562804b11",
  "name": "Windows Service Created with Suspicious Service Name",
  "description": "The following analytic detects the creation of a Windows Service with a known suspicious or malicious name using Windows Event ID 7045. It leverages logs from the `wineventlog_system` to identify these services installations. This activity is significant as adversaries, including those deploying Clop ransomware, often create malicious services for lateral movement, remote code execution, persistence, and execution. If confirmed malicious, this could allow attackers to maintain persistence, execute arbitrary code, and potentially escalate privileges, posing a severe threat to the environment.",
  "source": {
    "type": "splunk",
    "id": "35eb6d19-a497-400c-93c5-645562804b11",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_service_created_with_suspicious_service_name.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_service_created_with_suspicious_service_name.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Steven Dick",
  "references": [
    "https://attack.mitre.org/techniques/T1569/002/",
    "https://github.com/BishopFox/sliver/blob/71f94928bf36c1557ea5fbeffa161b71116f56b2/client/command/exec/psexec.go#LL61C5-L61C16",
    "https://www.microsoft.com/en-us/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/",
    "https://github.com/mthcht/awesome-lists/blob/main/Lists/suspicious_windows_services_names_list.csv"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_system` EventCode=7045 \n| stats values(ImagePath) as process, count, min(_time) as firstTime, max(_time) as lastTime values(EventCode) as signature by Computer, ServiceName, StartType, ServiceType, UserID\n| eval process_name = replace(mvindex(split(process,\"\\\\\"),-1), \"\\\"\", \"\")\n| rename Computer as dest, ServiceName as object_name, ServiceType as object_type, UserID as user_id\n| lookup windows_suspicious_services service_name as object_name\n| where isnotnull(tool_name)\n| `security_content_ctime(firstTime)` \n| `security_content_ctime(lastTime)` \n| `windows_service_created_with_suspicious_service_name_filter`",
    "condition": "To successfully implement this search, you need to be ingesting logs with the Service name, Service File Name Service Start type, and Service Type from your endpoints.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate applications may install services with uncommon services paths."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}