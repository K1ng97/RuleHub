{
  "id": "31641378-2fa9-42b1-948e-25e281cb98f7",
  "name": "O365 High Number Of Failed Authentications for User",
  "description": "The following analytic identifies an O365 account experiencing more than 20 failed authentication attempts within 5 minutes. It uses O365 Unified Audit Logs, specifically \"UserLoginFailed\" events, to monitor and flag accounts exceeding this threshold. This activity is significant as it may indicate a brute force attack or password guessing attempt. If confirmed malicious, an attacker could gain unauthorized access to the O365 environment, potentially compromising sensitive emails, documents, and other data. Prompt investigation and action are crucial to prevent unauthorized access and data breaches.",
  "source": {
    "type": "splunk",
    "id": "31641378-2fa9-42b1-948e-25e281cb98f7",
    "url": "https://github.com/splunk/security_content/blob/develop/o365_high_number_of_failed_authentications_for_user.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/o365_high_number_of_failed_authentications_for_user.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/",
    "https://attack.mitre.org/techniques/T1110/001/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`o365_management_activity` Operation=UserLoginFailed record_type=AzureActiveDirectoryStsLogon Workload=AzureActiveDirectory | bucket span=5m _time | fillnull | stats dc(_raw) AS failed_attempts values(src_ip) as src by signature user _time dest vendor_account vendor_product | where failed_attempts > 10 | `o365_high_number_of_failed_authentications_for_user_filter`",
    "condition": "You must install the Splunk Microsoft Office 365 Add-on and ingest Office 365 management activity events.",
    "fields": []
  },
  "falsepositives": [
    "Although unusual, users who have lost their passwords may trigger this detection. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}