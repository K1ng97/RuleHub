{
  "id": "ae874ad8-e353-40a7-87d4-420cdfb27d1a",
  "name": "Zscaler Malware Activity Threat Blocked",
  "description": "The following analytic identifies potential malware activities within a network that are blocked by Zscaler. It leverages web proxy logs to filter for blocked actions associated with malware, aggregating occurrences by user, URL, and threat category. This detection is significant for SOC as it highlights attempts to access malicious content, indicating potential compromise or targeted attacks. If confirmed malicious, this activity could signify an ongoing attempt to infiltrate the network, necessitating immediate investigation to prevent further threats and ensure network integrity.",
  "source": {
    "type": "splunk",
    "id": "ae874ad8-e353-40a7-87d4-420cdfb27d1a",
    "url": "https://github.com/splunk/security_content/blob/develop/zscaler_malware_activity_threat_blocked.yml",
    "file_path": "tmp/repos/splunk/detections/web/zscaler_malware_activity_threat_blocked.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Rod Soto, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://help.zscaler.com/zia/nss-feed-output-format-web-logs"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`zscaler_proxy` action=blocked threatname=*malware* threatcategory!=None | stats count min(_time) as firstTime max(_time) as lastTime by action deviceowner user urlcategory url src dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `zscaler_malware_activity_threat_blocked_filter`",
    "condition": "You must install the latest version of Zscaler Add-on from Splunkbase. You must be ingesting Zscaler events into your Splunk environment through an ingester. This analytic was written to be used with the \"zscalernss-web\" sourcetype leveraging the Zscaler proxy data. This enables the integration with Splunk Enterprise Security. Security teams are encouraged to adjust the detection parameters, ensuring the detection is tailored to their specific environment.",
    "fields": []
  },
  "falsepositives": [
    "False positives are limited to Zscalar configuration."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}