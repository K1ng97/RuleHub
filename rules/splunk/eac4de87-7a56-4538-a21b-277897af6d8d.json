{
  "id": "eac4de87-7a56-4538-a21b-277897af6d8d",
  "name": "Azure AD Application Administrator Role Assigned",
  "description": "The following analytic identifies the assignment of the Application Administrator role to an Azure AD user. It leverages Azure Active Directory events, specifically monitoring the \"Add member to role\" operation. This activity is significant because users in this role can manage all aspects of enterprise applications, including credentials, which can be used to impersonate application identities. If confirmed malicious, an attacker could escalate privileges, manage application settings, and potentially access sensitive resources by impersonating application identities, posing a significant security risk to the Azure AD tenant.",
  "source": {
    "type": "splunk",
    "id": "eac4de87-7a56-4538-a21b-277897af6d8d",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_ad_application_administrator_role_assigned.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_ad_application_administrator_role_assigned.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/",
    "https://posts.specterops.io/azure-privilege-escalation-via-service-principal-abuse-210ae2be2a5",
    "https://docs.microsoft.com/en-us/azure/active-directory/roles/concept-understand-roles",
    "https://attack.mitre.org/techniques/T1098/003/",
    "https://learn.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#application-administrator"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad`  operationName=\"Add member to role\"  \"properties.targetResources{}.modifiedProperties{}.newValue\"=\"*Application Administrator*\" | rename properties.* as * | rename initiatedBy.user.userPrincipalName as initiatedBy, userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product initiatedBy user_agent signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_application_administrator_role_assigned_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase(https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Active Directory events into your Splunk environment. This analytic was written to be used with the azure:monitor:aad sourcetype leveraging the Auditlog log category",
    "fields": []
  },
  "falsepositives": [
    "Administrators may legitimately assign the Application Administrator role to a user. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}