{
  "id": "2038f5c6-5aba-4221-8ae2-ca76e2ca8b97",
  "name": "Exploit Public-Facing Fortinet FortiNAC CVE-2022-39952",
  "description": "The following analytic detects attempts to exploit the Fortinet FortiNAC CVE-2022-39952 vulnerability. It identifies HTTP POST requests to the URI configWizard/keyUpload.jsp with a payload.zip file. The detection leverages the Web datamodel, analyzing fields such as URL, HTTP method, and user agent. This activity is significant as it indicates an attempt to exploit a known vulnerability, potentially leading to remote code execution. If confirmed malicious, attackers could gain control over the affected system, schedule malicious tasks, and establish persistent access via a remote command and control (C2) server.",
  "source": {
    "type": "splunk",
    "id": "2038f5c6-5aba-4221-8ae2-ca76e2ca8b97",
    "url": "https://github.com/splunk/security_content/blob/develop/exploit_public_facing_fortinet_fortinac_cve_2022_39952.yml",
    "file_path": "tmp/repos/splunk/detections/web/exploit_public_facing_fortinet_fortinac_cve_2022_39952.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/horizon3ai/CVE-2022-39952",
    "https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/",
    "https://viz.greynoise.io/tag/fortinac-rce-attempt?days=30"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"*configWizard/keyUpload.jsp*\") by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `exploit_public_facing_fortinet_fortinac_cve_2022_39952_filter`",
    "condition": "This detection requires the Web datamodel to be populated from a supported Technology Add-On like Splunk for Apache, Splunk for Nginx, or Splunk for Palo Alto.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present. Modify the query as needed to POST, or add additional filtering (based on log source)."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}