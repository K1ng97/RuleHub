{
  "id": "289ad59f-8939-4331-b805-f2bd51d36fb8",
  "name": "Zscaler Behavior Analysis Threat Blocked",
  "description": "The following analytic identifies threats blocked by the Zscaler proxy based on behavior analysis. It leverages web proxy logs to detect entries where actions are blocked and threat names and classes are specified. This detection is significant as it highlights potential malicious activities that were intercepted by Zscaler's behavior analysis, providing early indicators of threats. If confirmed malicious, these blocked threats could indicate attempted breaches or malware infections, helping security teams to understand and mitigate potential risks in their environment.",
  "source": {
    "type": "splunk",
    "id": "289ad59f-8939-4331-b805-f2bd51d36fb8",
    "url": "https://github.com/splunk/security_content/blob/develop/zscaler_behavior_analysis_threat_blocked.yml",
    "file_path": "tmp/repos/splunk/detections/web/zscaler_behavior_analysis_threat_blocked.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Rod Soto, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://help.zscaler.com/zia/nss-feed-output-format-web-logs"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`zscaler_proxy` action=blocked threatname!=\"None\" threatclass=\"Behavior Analysis\" | stats count min(_time) as firstTime max(_time) as lastTime by action deviceowner user threatname url src dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `zscaler_behavior_analysis_threat_blocked_filter`",
    "condition": "You must install the latest version of Zscaler Add-on from Splunkbase. You must be ingesting Zscaler events into your Splunk environment through an ingester. This analytic was written to be used with the \"zscalernss-web\" sourcetype leveraging the Zscaler proxy data. This enables the integration with Splunk Enterprise Security. Security teams are encouraged to adjust the detection parameters, ensuring the detection is tailored to their specific environment.",
    "fields": []
  },
  "falsepositives": [
    "False positives are limited to Zscalar configuration."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}