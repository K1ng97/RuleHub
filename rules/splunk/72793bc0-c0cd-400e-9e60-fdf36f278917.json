{
  "id": "72793bc0-c0cd-400e-9e60-fdf36f278917",
  "name": "Windows AD GPO Disabled",
  "description": "This detection identifies when an Active Directory Group Policy is disabled using the Group Policy Management Console.",
  "source": {
    "type": "splunk",
    "id": "72793bc0-c0cd-400e-9e60-fdf36f278917",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_ad_gpo_disabled.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_ad_gpo_disabled.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Dean Luxton",
  "references": [
    "https://lantern.splunk.com/Security/Product_Tips/Enterprise_Security/Enabling_an_audit_trail_from_Active_Directory"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=5136 AttributeLDAPDisplayName=flags OperationType=\"%%14674\" AttributeValue!=0 | eval AttributeValueExp=case(AttributeValue==0,\"Enabled\",AttributeValue==1,\"User configuration settings disabled\",AttributeValue==2,\"Computer configuration settings disabled\",AttributeValue==3,\"Disabled\"), ObjectDN=upper(ObjectDN) | join ObjectDN type=inner [| search `admon` objectCategory=\"CN=Group-Policy-Container*\" admonEventType=Update | eval ObjectDN=upper(distinguishedName) | stats latest(displayName) as displayName by ObjectDN ] | stats min(_time) as _time values(AttributeValue) as AttributeValue values(AttributeValueExp) as AttributeValueExp values(OpCorrelationID) as OpCorrelationID values(displayName) as policyName values(src_user) as src_user by ObjectDN SubjectLogonId dest | `windows_ad_gpo_disabled_filter`",
    "condition": "Ensure you are ingesting Active Directory audit logs - specifically event 5136, admon data is also used to display the display name of the GPO. See lantern article in references for further on how to onboard AD audit data. Ensure the wineventlog_security and admon macros are configured with the correct indexes.",
    "fields": []
  },
  "falsepositives": [
    "Unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}