{
  "id": "bb27cbce-d4de-432c-932f-2e206e9130fb",
  "name": "Okta New Device Enrolled on Account",
  "description": "The following analytic identifies when a new device is enrolled on an Okta account. It uses OktaIm2 logs ingested via the Splunk Add-on for Okta Identity Cloud to detect the creation of new device enrollments. This activity is significant as it may indicate a legitimate user setting up a new device or an adversary adding a device to maintain unauthorized access. If confirmed malicious, this could lead to potential account takeover, unauthorized access, and persistent control over the compromised Okta account. Monitoring this behavior is crucial for detecting and mitigating unauthorized access attempts.",
  "source": {
    "type": "splunk",
    "id": "bb27cbce-d4de-432c-932f-2e206e9130fb",
    "url": "https://github.com/splunk/security_content/blob/develop/okta_new_device_enrolled_on_account.yml",
    "file_path": "tmp/repos/splunk/detections/application/okta_new_device_enrolled_on_account.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1098/005/",
    "https://developer.okta.com/docs/reference/api/event-types/?q=device.enrollment.create"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count max(_time) as lastTime, min(_time) as firstTime from datamodel=Change where All_Changes.action=created All_Changes.command=device.enrollment.create by _time span=5m All_Changes.user All_Changes.result All_Changes.command sourcetype All_Changes.src All_Changes.action All_Changes.object_category All_Changes.dest | `drop_dm_object_name(\"All_Changes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `okta_new_device_enrolled_on_account_filter`",
    "condition": "The analytic leverages Okta OktaIm2 logs to be ingested using the Splunk Add-on for Okta Identity Cloud (https://splunkbase.splunk.com/app/6553).",
    "fields": []
  },
  "falsepositives": [
    "It is possible that the user has legitimately added a new device to their account. Please verify this activity."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}