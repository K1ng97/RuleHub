{
  "id": "fb3b2bb3-75a4-4279-848a-165b42624770",
  "name": "Windows Computer Account Requesting Kerberos Ticket",
  "description": "The following analytic detects a computer account requesting a Kerberos ticket, which is unusual as typically user accounts request these tickets. This detection leverages Windows Security Event Logs, specifically EventCode 4768, to identify instances where the TargetUserName ends with a dollar sign ($), indicating a computer account. This activity is significant because it may indicate the use of tools like KrbUpRelay or other Kerberos-based attacks. If confirmed malicious, this could allow attackers to impersonate computer accounts, potentially leading to unauthorized access and lateral movement within the network.",
  "source": {
    "type": "splunk",
    "id": "fb3b2bb3-75a4-4279-848a-165b42624770",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_computer_account_requesting_kerberos_ticket.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_computer_account_requesting_kerberos_ticket.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/Dec0ne/KrbRelayUp"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security`  EventCode=4768 TargetUserName=\"*$\"  src_ip!=\"::1\" | stats  count min(_time) as firstTime max(_time) as lastTime by dest, subject, action, user, TargetUserName, src_ip | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_computer_account_requesting_kerberos_ticket_filter`",
    "condition": "To successfully implement this search, you need to be ingesting Windows Security Event Logs with 4768 EventCode enabled. The Windows TA is also required.",
    "fields": []
  },
  "falsepositives": [
    "It is possible false positives will be present based on third party applications. Filtering may be needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}