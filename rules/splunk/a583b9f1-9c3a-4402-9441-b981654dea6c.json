{
  "id": "a583b9f1-9c3a-4402-9441-b981654dea6c",
  "name": "SAP NetWeaver Visual Composer Exploitation Attempt",
  "description": "Detects potential exploitation attempts targeting CVE-2025-31324, a critical unauthenticated file upload vulnerability in SAP NetWeaver Visual Composer. This flaw allows remote attackers to send specially crafted POST requests to the /developmentserver/metadatauploader endpoint, enabling arbitrary file uploads—commonly webshells—resulting in full system compromise. The detection looks for HTTP HEAD or POST requests with a 200 OK status to sensitive Visual Composer endpoints, which may indicate reconnaissance or active exploitation. Successful exploitation can lead to attackers gaining privileged access, deploying malware, and impacting business-critical SAP resources. Immediate patching and investigation of suspicious activity are strongly recommended, as this vulnerability is being actively exploited in the wild.\n",
  "source": {
    "type": "splunk",
    "id": "a583b9f1-9c3a-4402-9441-b981654dea6c",
    "url": "https://github.com/splunk/security_content/blob/develop/sap_netweaver_visual_composer_exploitation_attempt.yml",
    "file_path": "tmp/repos/splunk/detections/web/sap_netweaver_visual_composer_exploitation_attempt.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://onapsis.com/blog/active-exploitation-of-sap-vulnerability-cve-2025-31324/",
    "https://reliaquest.com/blog/threat-spotlight-reliaquest-uncovers-vulnerability-behind-sap-netweaver-compromise/",
    "https://www.rapid7.com/blog/post/2025/04/28/etr-active-exploitation-of-sap-netweaver-visual-composer-cve-2025-31324/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web.Web where (Web.url IN (\"/CTCWebService/CTCWebServiceBean\", \"/VisualComposer/services/DesignTimeService\", \"/ctc/CTCWebService/CTCWebServiceBean\")) AND Web.http_method IN (\"HEAD\", \"POST\") AND Web.status=200 by Web.src, Web.dest, Web.http_method, Web.url, Web.http_user_agent, Web.url_length, sourcetype | `drop_dm_object_name(\"Web\")` | eval action=case(http_method=\"HEAD\", \"Recon/Probe\", http_method=\"POST\", \"Possible Exploitation\") | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | table firstTime, lastTime, src, dest, http_method, action, url, user_agent, url_length, sourcetype | `sap_netweaver_visual_composer_exploitation_attempt_filter`",
    "condition": "Ensure that the Web data model is accelerated and populated with web server or web proxy logs capturing HTTP request and response data.\nThis search relies on HTTP method, status code, and URL path fields to identify suspicious access patterns against SAP NetWeaver endpoints.\n",
    "fields": []
  },
  "falsepositives": [
    "Some legitimate administrative activity may access SAP NetWeaver services. However, HEAD or POST requests directly resulting in a 200 OK \nto Visual Composer endpoints are uncommon and should be investigated carefully.\n"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}