{
  "id": "fbcc04c7-8a79-453c-b3a9-c232c423bdd3",
  "name": "JetBrains TeamCity Authentication Bypass Suricata CVE-2024-27198",
  "description": "The following analytic detects attempts to exploit the CVE-2024-27198 vulnerability in JetBrains TeamCity on-premises servers, which allows attackers to bypass authentication mechanisms. It leverages Suricata HTTP traffic logs to identify suspicious POST requests to the `/app/rest/users` and `/app/rest/users/id:1/tokens` endpoints. This activity is significant because it can lead to unauthorized administrative access, enabling attackers to gain full control over the TeamCity server, including projects, builds, agents, and artifacts. If confirmed malicious, this could result in severe security breaches and compromise the integrity of the development environment.",
  "source": {
    "type": "splunk",
    "id": "fbcc04c7-8a79-453c-b3a9-c232c423bdd3",
    "url": "https://github.com/splunk/security_content/blob/develop/jetbrains_teamcity_authentication_bypass_suricata_cve_2024_27198.yml",
    "file_path": "tmp/repos/splunk/detections/web/jetbrains_teamcity_authentication_bypass_suricata_cve_2024_27198.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/projectdiscovery/nuclei-templates/pull/9279/files",
    "https://www.rapid7.com/blog/post/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/",
    "https://blog.jetbrains.com/teamcity/2024/03/teamcity-2023-11-4-is-out/",
    "https://blog.jetbrains.com/teamcity/2024/03/additional-critical-security-issues-affecting-teamcity-on-premises-cve-2024-27198-and-cve-2024-27199-update-to-2023-11-4-now/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`suricata` ((http.url=\"*?jsp=*\" AND http.url=\"*;.jsp*\") http.status=200 http_method=POST) OR (http.url IN (\"*jsp=/app/rest/users;.jsp\",\"*?jsp=/app/rest/users;.jsp\",\"*?jsp=.*/app/rest/users/id:*/tokens;*\") http.status=200 http_method=POST ) | stats count min(_time) as firstTime max(_time) as lastTime by src, dest, http.http_user_agent, http.url, http.status,http_method | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)`| `jetbrains_teamcity_authentication_bypass_suricata_cve_2024_27198_filter`",
    "condition": "The following detection relies on the Suricata TA and ensuring it is properly configured to monitor HTTP traffic. Modify the query for your environment and log sources as needed.",
    "fields": []
  },
  "falsepositives": [
    "False positives are not expected, as this detection is based on the presence of specific URI paths and HTTP methods that are indicative of the CVE-2024-27198 vulnerability exploitation. Monitor, filter and tune as needed based on organization log sources."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}