{
  "id": "187bf937-c436-4c65-bbcb-7539ffe02da1",
  "name": "Windows AD Privileged Group Modification",
  "description": "Detect users added to privileged AD Groups.",
  "source": {
    "type": "splunk",
    "id": "187bf937-c436-4c65-bbcb-7539ffe02da1",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_ad_privileged_group_modification.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_ad_privileged_group_modification.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "manual_test",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Dean Luxton",
  "references": [
    "https://splunkbase.splunk.com/app/6853"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode IN (4728) | stats min(_time) as _time dc(user) as usercount, values(user) as user values(user_category) as user_category values(src_user_category) as src_user_category values(dvc) as dvc by signature, Group_Name,src_user | lookup admon_groups_def  cn as Group_Name OUTPUT category | where category=\"privileged\" | `windows_ad_privileged_group_modification_filter`",
    "condition": "This analytic requires eventCode 4728 to be ingested along with the admon_groups_def lookup being configured to include a list of AD groups along with a category to identify privileged groups. See splunkbase app listed in the references for further details.",
    "fields": []
  },
  "falsepositives": [
    "None"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}