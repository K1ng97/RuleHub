{
  "id": "345f7e1d-a3fe-4158-abd8-e630f9878323",
  "name": "GCP Authentication Failed During MFA Challenge",
  "description": "The following analytic detects failed authentication attempts during the Multi-Factor Authentication (MFA) challenge on a Google Cloud Platform (GCP) tenant. It uses Google Workspace login failure events to identify instances where MFA methods were challenged but not successfully completed. This activity is significant as it may indicate an adversary attempting to access an account with compromised credentials despite MFA protection. If confirmed malicious, this could lead to unauthorized access attempts, potentially compromising sensitive data and resources within the GCP environment.",
  "source": {
    "type": "splunk",
    "id": "345f7e1d-a3fe-4158-abd8-e630f9878323",
    "url": "https://github.com/splunk/security_content/blob/develop/gcp_authentication_failed_during_mfa_challenge.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/gcp_authentication_failed_during_mfa_challenge.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1621/",
    "https://attack.mitre.org/techniques/T1078/004/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`gws_reports_login` event.name=login_failure `gws_login_mfa_methods` | stats count min(_time) as firstTime max(_time) as lastTime by user, src_ip, login_challenge_method | `gcp_authentication_failed_during_mfa_challenge_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Google Workspace from Splunkbase (https://splunkbase.splunk.com/app/5556) which allows Splunk administrators to collect Google Workspace event data in Splunk using Google Workspace APIs. Specifically, this analytic leverages the User log events.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate users may miss to reply the MFA challenge within the time window or deny it by mistake."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}