{
  "id": "98f6ad4f-4325-4096-9d69-45dc8e638e82",
  "name": "Okta Successful Single Factor Authentication",
  "description": "The following analytic identifies successful single-factor authentication events against the Okta Dashboard for accounts without Multi-Factor Authentication (MFA) enabled. It detects this activity by analyzing Okta logs for successful authentication events where \"Okta Verify\" is not used. This behavior is significant as it may indicate a misconfiguration, policy violation, or potential account takeover. If confirmed malicious, an attacker could gain unauthorized access to the account, potentially leading to data breaches or further exploitation within the environment.",
  "source": {
    "type": "splunk",
    "id": "98f6ad4f-4325-4096-9d69-45dc8e638e82",
    "url": "https://github.com/splunk/security_content/blob/develop/okta_successful_single_factor_authentication.yml",
    "file_path": "tmp/repos/splunk/detections/application/okta_successful_single_factor_authentication.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://sec.okta.com/everythingisyes",
    "https://attack.mitre.org/techniques/T1078/004/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`okta`  action=success src_user_type = User eventType = user.authentication.verify OR eventType = user.authentication.auth_via_mfa| stats dc(eventType) values(eventType) as eventType values(target{}.displayName) as targets values(debugContext.debugData.url) min(_time) as firstTime max(_time) as lastTime values(authentication_method) by src_ip user action dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | search targets !=\"Okta Verify\" | `okta_successful_single_factor_authentication_filter`",
    "condition": "This detection utilizes logs from Okta environments and requires the ingestion of OktaIm2 logs through the Splunk Add-on for Okta Identity Cloud (https://splunkbase.splunk.com/app/6553).",
    "fields": []
  },
  "falsepositives": [
    "Although not recommended, certain users may be exempt from multi-factor authentication. Adjust the filter as necessary."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}