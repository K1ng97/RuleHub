{
  "id": "bf471c94-0324-4b19-a113-d02749b969bc",
  "name": "Windows Known GraphicalProton Loaded Modules",
  "description": "The following analytic detects the loading of DLL modules associated with the GraphicalProton backdoor implant, commonly used by SVR in targeted attacks. It leverages Sysmon EventCode 7 to identify specific DLLs loaded by processes. This activity is significant as it may indicate the presence of a sophisticated backdoor, warranting immediate investigation. If confirmed malicious, the attacker could gain persistent access to the compromised host, potentially leading to further exploitation and data exfiltration.",
  "source": {
    "type": "splunk",
    "id": "bf471c94-0324-4b19-a113-d02749b969bc",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_known_graphicalproton_loaded_modules.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_known_graphicalproton_loaded_modules.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [
    "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`sysmon` EventCode=7 ImageLoaded IN (\"*\\\\AclNumsInvertHost.dll\", \"*\\\\ModeBitmapNumericAnimate.dll\", \"*\\\\UnregisterAncestorAppendAuto.dll\", \"*\\\\DeregisterSeekUsers.dll\", \"*\\\\ScrollbarHandleGet.dll\", \"*\\\\PerformanceCaptionApi.dll\", \"*\\\\WowIcmpRemoveReg.dll\", \"*\\\\BlendMonitorStringBuild.dll\", \"*\\\\HandleFrequencyAll.dll\", \"*\\\\HardSwapColor.dll\", \"*\\\\LengthInMemoryActivate.dll\", \"*\\\\ParametersNamesPopup.dll\", \"*\\\\ModeFolderSignMove.dll\", \"*\\\\ChildPaletteConnected.dll\", \"*\\\\AddressResourcesSpec.dll\") | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by Image ImageLoaded dest loaded_file loaded_file_path original_file_name process_exec process_guid process_hash process_id process_name process_path service_dll_signature_exists service_dll_signature_verified signature signature_id user_id vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_known_graphicalproton_loaded_modules_filter`",
    "condition": "To successfully implement this search, you need to be ingesting logs with the process name and imageloaded executions from your endpoints. If you are using Sysmon, you must have at least version 6.0.4 of the Sysmon TA.",
    "fields": []
  },
  "falsepositives": [
    "unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}