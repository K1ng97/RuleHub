{
  "id": "b25f6f62-0712-43c1-b203-083231ffd97d",
  "name": "Detect New Local Admin account",
  "description": "The following analytic detects the creation of new accounts elevated to local administrators. It uses Windows event logs, specifically EventCode 4720 (user account creation) and EventCode 4732 (user added to Administrators group). This activity is significant as it indicates potential unauthorized privilege escalation, which is critical for SOC monitoring. If confirmed malicious, this could allow attackers to gain administrative access, leading to unauthorized data access, system modifications, and disruption of services. Immediate investigation is required to mitigate risks and prevent further unauthorized actions.",
  "source": {
    "type": "splunk",
    "id": "b25f6f62-0712-43c1-b203-083231ffd97d",
    "url": "https://github.com/splunk/security_content/blob/develop/detect_new_local_admin_account.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/detect_new_local_admin_account.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "David Dorsey, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4720 OR (EventCode=4732 Group_Name=Administrators) | transaction user dest connected=false maxspan=180m | stats count min(_time) as firstTime max(_time) as lastTime dc(EventCode) as distinct_eventcodes by src_user user dest | where distinct_eventcodes>1 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `detect_new_local_admin_account_filter`",
    "condition": "You must be ingesting Windows event logs using the Splunk Windows TA and collecting event code 4720 and 4732",
    "fields": []
  },
  "falsepositives": [
    "The activity may be legitimate. For this reason, it's best to verify the account with an administrator and ask whether there was a valid service request for the account creation. If your local administrator group name is not \"Administrators\", this search may generate an excessive number of false positives"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}