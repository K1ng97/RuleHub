{
  "id": "244a77bb-3b2a-46f1-bf2c-b4f7cd29276d",
  "name": "Cisco Secure Firewall - Possibly Compromised Host",
  "description": "The following analytic highlights high-impact intrusion events assigned by Cisco Secure Firewall.\nThis detection leverages Cisco Secure Firewall Threat Defense logs and specifically the IntrusionEvent event type and `Impact` field assigned by Cisco Secure Firewall looking for an impact score of 1 or 2. If confirmed malicious this may indicate a potential compromised host.\n",
  "source": {
    "type": "splunk",
    "id": "244a77bb-3b2a-46f1-bf2c-b4f7cd29276d",
    "url": "https://github.com/splunk/security_content/blob/develop/cisco_secure_firewall___possibly_compromised_host.yml",
    "file_path": "tmp/repos/splunk/detections/network/cisco_secure_firewall___possibly_compromised_host.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Nasreddine Bencherchali, Splunk",
  "references": [
    "https://www.cisco.com/c/en/us/td/docs/security/firepower/741/api/FQE/secure_firewall_estreamer_fqe_guide_740.pdf"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cisco_secure_firewall` EventType=IntrusionEvent Impact IN (1,2)\n| stats count as TotalDetections values(signature_id) as signature_id \n        values(signature) as signature \n        values(rule) as rule \n        min(_time) as firstTime max(_time) as lastTime \n        by src_ip dest dest_port transport Impact app impact_desc class_desc MitreAttackGroups InlineResult InlineResultReason\n| `security_content_ctime(firstTime)`\n| `security_content_ctime(lastTime)`\n| `cisco_secure_firewall___possibly_compromised_host_filter`\n",
    "condition": "This search requires Cisco Secure Firewall Threat Defense Logs, which\nincludes the IntrusionEvent EventType. This search uses an input macro named `cisco_secure_firewall`.\nWe strongly recommend that you specify your environment-specific configurations\n(index, source, sourcetype, etc.) for Cisco Secure Firewall Threat Defense logs. Replace the macro definition\nwith configurations for your Splunk environment. The search also uses a post-filter\nmacro designed to filter out known false positives.\nThe logs are to be ingested using the Splunk Add-on for Cisco Security Cloud (https://splunkbase.splunk.com/app/7404).\nThe intrusion access policy must also be configured.\n",
    "fields": []
  },
  "falsepositives": [
    "False positives are directly related to their snort rules triggering and the firewall scoring. Apply additional filters if the rules are too noisy by disabling them or simply ignoring certain IP ranges that trigger it."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}