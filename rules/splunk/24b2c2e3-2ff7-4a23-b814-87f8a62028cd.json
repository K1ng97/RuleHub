{
  "id": "24b2c2e3-2ff7-4a23-b814-87f8a62028cd",
  "name": "Cisco Secure Firewall - Binary File Type Download",
  "description": "The following analytic detects file downloads involving executable, archive, or scripting-related file types that are commonly used in malware delivery. \nThese file types include formats like PE executables, shell scripts, autorun files, installers, and known testing samples such as EICAR.\nThis detection leverages Cisco Secure Firewall Threat Defense logs and enriches the results using a filetype lookup to provide context.\nIf confirmed malicious, these downloads could indicate the initial infection vector, malware staging, or scripting abuse.\n",
  "source": {
    "type": "splunk",
    "id": "24b2c2e3-2ff7-4a23-b814-87f8a62028cd",
    "url": "https://github.com/splunk/security_content/blob/develop/cisco_secure_firewall___binary_file_type_download.yml",
    "file_path": "tmp/repos/splunk/detections/network/cisco_secure_firewall___binary_file_type_download.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Nasreddine Bencherchali, Splunk",
  "references": [
    "https://www.cisco.com/c/en/us/td/docs/security/firepower/741/api/FQE/secure_firewall_estreamer_fqe_guide_740.pdf"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cisco_secure_firewall` EventType=FileEvent FileDirection=\"Download\" \nFileType IN (\"ISHIELD_MSI\", \"BINHEX\", \"BINARY_DATA\", \"ELF\", \"MACHO\", \"JARPACK\", \"TORRENT\", \"AUTORUN\", \"EICAR\", \"LNK\", \"SCR\", \"UNIX_SCRIPT\")\n| lookup cisco_secure_firewall_filetype_lookup Name as FileType OUTPUT Description\n| stats count min(_time) as firstTime max(_time) as lastTime\n        values(uri) as uri\n        values(ClientApplication) as ClientApplication\n        values(file_hash) as file_hash\n        values(SHA_Disposition) as SHA_Disposition\n        by FileDirection FileType src_ip dest app file_name ThreatName dest_port Description\n| `security_content_ctime(firstTime)`\n| `security_content_ctime(lastTime)`\n| table firstTime lastTime src_ip dest dest_port FileDirection FileType Description uri file_name file_hash app ClientApplication SHA_Disposition ThreatName\n| `cisco_secure_firewall___binary_file_type_download_filter`\n",
    "condition": "This search requires Cisco Secure Firewall Threat Defense Logs, which\nincludes the FileEvent EventType. This search uses an input macro named `cisco_secure_firewall`.\nWe strongly recommend that you specify your environment-specific configurations\n(index, source, sourcetype, etc.) for Cisco Secure Firewall Threat Defense logs. Replace the macro definition\nwith configurations for your Splunk environment. The search also uses a post-filter\nmacro designed to filter out known false positives.\nThe logs are to be ingested using the Splunk Add-on for Cisco Security Cloud (https://splunkbase.splunk.com/app/7404).\nThe malware & file access policy must also enable logging.\n",
    "fields": []
  },
  "falsepositives": [
    "IT admins or developers may legitimately download executables or scripts as part of their normal workflow. Apply additional filters accordingly."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}