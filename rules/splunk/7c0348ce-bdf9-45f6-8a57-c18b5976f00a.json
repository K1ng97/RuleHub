{
  "id": "7c0348ce-bdf9-45f6-8a57-c18b5976f00a",
  "name": "Okta Multi-Factor Authentication Disabled",
  "description": "The following analytic identifies an attempt to disable multi-factor authentication (MFA) for an Okta user. It leverages OktaIM2 logs to detect when the 'user.mfa.factor.deactivate' command is executed. This activity is significant because disabling MFA can allow an adversary to maintain persistence within the environment using a compromised valid account. If confirmed malicious, this action could enable attackers to bypass additional security layers, potentially leading to unauthorized access to sensitive information and prolonged undetected presence in the network.",
  "source": {
    "type": "splunk",
    "id": "7c0348ce-bdf9-45f6-8a57-c18b5976f00a",
    "url": "https://github.com/splunk/security_content/blob/develop/okta_multi_factor_authentication_disabled.yml",
    "file_path": "tmp/repos/splunk/detections/application/okta_multi_factor_authentication_disabled.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1556/",
    "https://splunkbase.splunk.com/app/6553"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count max(_time) as lastTime, min(_time) as firstTime from datamodel=Change where sourcetype=\"OktaIM2:log\" All_Changes.object_category=User AND All_Changes.action=modified All_Changes.command=user.mfa.factor.deactivate by All_Changes.user All_Changes.result All_Changes.command sourcetype All_Changes.src All_Changes.dest | `drop_dm_object_name(\"All_Changes\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `okta_multi_factor_authentication_disabled_filter`",
    "condition": "The analytic leverages Okta OktaIm2 logs to be ingested using the Splunk Add-on for Okta Identity Cloud (https://splunkbase.splunk.com/app/6553).",
    "fields": []
  },
  "falsepositives": [
    "Legitimate use case may require for users to disable MFA. Filter lightly and monitor for any unusual activity."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}