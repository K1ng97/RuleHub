{
  "id": "1fece617-e614-4329-9e61-3ba228c0f353",
  "name": "AWS Multiple Failed MFA Requests For User",
  "description": "The following analytic identifies multiple failed multi-factor authentication (MFA) requests to an AWS Console for a single user. It leverages AWS CloudTrail logs, specifically the `additionalEventData` field, to detect more than 10 failed MFA prompts within 5 minutes. This activity is significant as it may indicate an adversary attempting to bypass MFA by bombarding the user with repeated authentication requests. If confirmed malicious, this could lead to unauthorized access to the AWS environment, potentially compromising sensitive data and resources.",
  "source": {
    "type": "splunk",
    "id": "1fece617-e614-4329-9e61-3ba228c0f353",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_multiple_failed_mfa_requests_for_user.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_multiple_failed_mfa_requests_for_user.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel",
  "references": [
    "https://attack.mitre.org/techniques/T1621/",
    "https://aws.amazon.com/what-is/mfa/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName= ConsoleLogin \"additionalEventData.MFAUsed\"=Yes errorMessage=\"Failed authentication\" | bucket span=5m _time | rename user_name as user | stats dc(_raw) as mfa_prompts min(_time) as firstTime max(_time) as lastTime values(user_agent) as user_agent values(src) as src values(dest) as dest by _time user signature vendor_account vendor_region vendor_product errorMessage | where mfa_prompts > 10 | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_multiple_failed_mfa_requests_for_user_filter`",
    "condition": "The Splunk AWS Add-on is required to utilize this data. The search requires AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "Multiple Failed MFA requests may also be a sign of authentication or application issues. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}