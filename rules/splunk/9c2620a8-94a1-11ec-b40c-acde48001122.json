{
  "id": "9c2620a8-94a1-11ec-b40c-acde48001122",
  "name": "Windows Event For Service Disabled",
  "description": "The following analytic detects when a Windows service is modified from a start type to disabled. It leverages system event logs, specifically EventCode 7040, to identify this change. This activity is significant because adversaries often disable security or other critical services to evade detection and maintain control over a compromised host. If confirmed malicious, this action could allow attackers to bypass security defenses, leading to further exploitation and persistence within the environment.",
  "source": {
    "type": "splunk",
    "id": "9c2620a8-94a1-11ec-b40c-acde48001122",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_event_for_service_disabled.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_event_for_service_disabled.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [
    "https://blog.talosintelligence.com/2018/02/olympic-destroyer.html"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_system` EventCode=7040  EventData_Xml=\"*disabled*\" | stats count min(_time) as firstTime max(_time) as lastTime by Computer EventCode Name UserID service ServiceName | rename Computer as dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_event_for_service_disabled_filter`",
    "condition": "To successfully implement this search, you need to be ingesting logs with the Service name, Service File Name Service Start type, and Service Type from your endpoints.",
    "fields": []
  },
  "falsepositives": [
    "Windows service update may cause this event. In that scenario, filtering is needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}