{
  "id": "f4cabbc7-c19a-4e41-8be5-98daeaccbb50",
  "name": "O365 Compliance Content Search Started",
  "description": "The following analytic detects when a content search is initiated within the Office 365 Security and Compliance Center. It leverages the SearchCreated operation from the o365_management_activity logs under the SecurityComplianceCenter workload. This activity is significant as it may indicate an attempt to access sensitive organizational data, including emails and documents. If confirmed malicious, this could lead to unauthorized data access, potential data exfiltration, and compliance violations. Monitoring this behavior helps ensure the integrity and security of organizational data.",
  "source": {
    "type": "splunk",
    "id": "f4cabbc7-c19a-4e41-8be5-98daeaccbb50",
    "url": "https://github.com/splunk/security_content/blob/develop/o365_compliance_content_search_started.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/o365_compliance_content_search_started.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1114/002/",
    "https://learn.microsoft.com/en-us/purview/ediscovery-content-search-overview",
    "https://learn.microsoft.com/en-us/purview/ediscovery-keyword-queries-and-search-conditions",
    "https://learn.microsoft.com/en-us/purview/ediscovery-search-for-activities-in-the-audit-log"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`o365_management_activity` Workload=SecurityComplianceCenter Operation=SearchCreated | rename user_id as user | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user src vendor_account vendor_product ExchangeLocations Query | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `o365_compliance_content_search_started_filter`",
    "condition": "You must install the Splunk Microsoft Office 365 Add-on and ingest Office 365 management activity events.",
    "fields": []
  },
  "falsepositives": [
    "Compliance content searches may be executed for legitimate purposes, filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}