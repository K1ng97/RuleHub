{
  "id": "3a1d8f62-5b9c-4e7d-b8f3-9d6a8e2f5e1f",
  "name": "Detect Web Access to Decommissioned S3 Bucket",
  "description": "This detection identifies web requests to domains that match previously decommissioned S3 buckets through web proxy logs. This activity is significant because attackers may attempt to access or recreate deleted S3 buckets that were previously public to hijack them for malicious purposes. If successful, this could allow attackers to host malicious content or exfiltrate data through compromised bucket names that may still be referenced by legitimate applications.",
  "source": {
    "type": "splunk",
    "id": "3a1d8f62-5b9c-4e7d-b8f3-9d6a8e2f5e1f",
    "url": "https://github.com/splunk/security_content/blob/develop/detect_web_access_to_decommissioned_s3_bucket.yml",
    "file_path": "tmp/repos/splunk/detections/web/detect_web_access_to_decommissioned_s3_bucket.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Jose Hernandez, Splunk",
  "references": [
    "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
    "https://labs.watchtowr.com/8-million-requests-later-we-made-the-solarwinds-supply-chain-attack-look-amateur/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime values(Web.http_method) as http_method values(Web.http_user_agent) as http_user_agent values(Web.url) as url values(Web.user) as user from datamodel=Web where Web.url_domain!=\"\" by Web.src Web.url_domain | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | eval bucket_domain = lower(url_domain) | lookup decommissioned_buckets bucketName as bucket_domain OUTPUT bucketName as match | where isnotnull(match) | `detect_web_access_to_decommissioned_s3_bucket_filter`",
    "condition": "To successfully implement this detection, you need to be ingesting web proxy logs and have them mapped to the Web data model. Additionally, ensure that the baseline search \"Baseline Of Open S3 Bucket Decommissioning\" is running and populating the decommissioned_buckets KVStore Lookup.",
    "fields": []
  },
  "falsepositives": [
    "Some applications or web pages may continue to reference old S3 bucket URLs after they have been decommissioned. These should be investigated and updated to prevent potential security risks."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}