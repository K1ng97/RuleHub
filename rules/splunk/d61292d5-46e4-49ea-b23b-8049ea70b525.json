{
  "id": "d61292d5-46e4-49ea-b23b-8049ea70b525",
  "name": "MOVEit Certificate Store Access Failure",
  "description": "This detection identifies potential exploitation attempts of the CVE-2024-5806 vulnerability in Progress MOVEit Transfer. It looks for log entries indicating failures to access the certificate store, which can occur when an attacker attempts to exploit the authentication bypass vulnerability. This behavior is a key indicator of attempts to impersonate valid users without proper credentials. While certificate store access failures can occur during normal operations, an unusual increase in such events, especially from unexpected sources, may indicate malicious activity.",
  "source": {
    "type": "splunk",
    "id": "d61292d5-46e4-49ea-b23b-8049ea70b525",
    "url": "https://github.com/splunk/security_content/blob/develop/moveit_certificate_store_access_failure.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/moveit_certificate_store_access_failure.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://labs.watchtowr.com/auth-bypass-in-un-limited-scenarios-progress-moveit-transfer-cve-2024-5806/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`moveit_sftp_logs` \"IpWorksKeyService: Caught exception of type IPWorksSSHException: The certificate store could not be opened\"| stats count by source _raw | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `moveit_certificate_store_access_failure_filter`",
    "condition": "The MOVEit logs must be collected in Splunk. Currently, there is no TA available for MOVEit. Modify the analytic as needed to match the log format of your environment.",
    "fields": []
  },
  "falsepositives": [
    "False positives may occur, therefore utilize the analytic as a jump off point to identifiy potential certificate store errors."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}