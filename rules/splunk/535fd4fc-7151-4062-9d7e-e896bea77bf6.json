{
  "id": "535fd4fc-7151-4062-9d7e-e896bea77bf6",
  "name": "Windows Query Registry UnInstall Program List",
  "description": "The following analytic detects an access request on the uninstall registry key. It leverages Windows Security Event logs, specifically event code 4663. This activity is significant because adversaries or malware can exploit this key to gather information about installed applications, aiding in further attacks. If confirmed malicious, this behavior could allow attackers to map out installed software, potentially identifying vulnerabilities or software to exploit, leading to further system compromise.",
  "source": {
    "type": "splunk",
    "id": "535fd4fc-7151-4062-9d7e-e896bea77bf6",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_query_registry_uninstall_program_list.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_query_registry_uninstall_program_list.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras, Splunk",
  "references": [
    "https://malpedia.caad.fkie.fraunhofer.de/details/win.redline_stealer"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4663 object_file_path=\"*\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\*\" | stats count min(_time) as firstTime max(_time) as lastTime by object_file_name object_file_path process_name process_path  process_id EventCode dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_query_registry_uninstall_program_list_filter`",
    "condition": "To successfully implement this search, you must ingest Windows Security Event logs and track event code 4663. For Event code 4663, enable the \"Audit Object Access\" in Group Policy. Then check the two boxes listed for both \"Success\" and \"Failure.\"",
    "fields": []
  },
  "falsepositives": [
    "Uninstallers may access this registry to remove the entry of the target application. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}