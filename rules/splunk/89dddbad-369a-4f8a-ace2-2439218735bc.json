{
  "id": "89dddbad-369a-4f8a-ace2-2439218735bc",
  "name": "Web Spring Cloud Function FunctionRouter",
  "description": "The following analytic identifies HTTP POST requests to the Spring Cloud Function endpoint containing \"functionRouter\" in the URL. It leverages the Web data model to detect these requests based on specific fields such as http_method, url, and http_user_agent. This activity is significant because it targets CVE-2022-22963, a known vulnerability in Spring Cloud Function, which has multiple proof-of-concept exploits available. If confirmed malicious, this activity could allow attackers to execute arbitrary code, potentially leading to unauthorized access, data exfiltration, or further compromise of the affected system.",
  "source": {
    "type": "splunk",
    "id": "89dddbad-369a-4f8a-ace2-2439218735bc",
    "url": "https://github.com/splunk/security_content/blob/develop/web_spring_cloud_function_functionrouter.yml",
    "file_path": "tmp/repos/splunk/detections/web/web_spring_cloud_function_functionrouter.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/rapid7/metasploit-framework/pull/16395",
    "https://github.com/hktalent/spring-spel-0day-poc"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count from datamodel=Web where Web.http_method IN (\"POST\") Web.url=\"*/functionRouter*\" by Web.http_user_agent Web.http_method, Web.url,Web.url_length Web.src, Web.dest Web.status sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `web_spring_cloud_function_functionrouter_filter`",
    "condition": "To successfully implement this search you need to be ingesting information on Web traffic that include fields relavent for traffic into the `Web` datamodel.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present with legitimate applications. Attempt to filter by dest IP or use Asset groups to restrict to servers."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}