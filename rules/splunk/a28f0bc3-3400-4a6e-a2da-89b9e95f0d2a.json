{
  "id": "a28f0bc3-3400-4a6e-a2da-89b9e95f0d2a",
  "name": "Azure AD Privileged Role Assigned",
  "description": "The following analytic detects the assignment of privileged Azure Active Directory roles to a user. It leverages Azure AD audit logs, specifically monitoring the \"Add member to role\" operation. This activity is significant as adversaries may assign privileged roles to compromised accounts to maintain persistence within the Azure AD environment. If confirmed malicious, this could allow attackers to escalate privileges, access sensitive information, and maintain long-term control over the Azure AD infrastructure.",
  "source": {
    "type": "splunk",
    "id": "a28f0bc3-3400-4a6e-a2da-89b9e95f0d2a",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_ad_privileged_role_assigned.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_ad_privileged_role_assigned.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://docs.microsoft.com/en-us/azure/active-directory/roles/concept-understand-roles",
    "https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference",
    "https://adsecurity.org/?p=4277",
    "https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors",
    "https://docs.microsoft.com/en-us/azure/active-directory/roles/security-planning",
    "https://attack.mitre.org/techniques/T1098/003/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad` \"operationName\"=\"Add member to role\" | rename properties.* as * | rename initiatedBy.user.userPrincipalName as initiatedBy | rename targetResources{}.modifiedProperties{}.newValue as roles | eval role=mvindex(roles,1) | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product initiatedBy result role signature | lookup privileged_azure_ad_roles azureadrole AS role OUTPUT isprvilegedadrole description | search isprvilegedadrole = True | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_privileged_role_assigned_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase (https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Active Directory events into your Splunk environment. This analytic was written to be used with the azure:monitor:aad sourcetype leveraging the AuditLog log category.",
    "fields": []
  },
  "falsepositives": [
    "Administrators will legitimately assign the privileged roles users as part of administrative tasks. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}