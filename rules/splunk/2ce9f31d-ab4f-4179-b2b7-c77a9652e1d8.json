{
  "id": "2ce9f31d-ab4f-4179-b2b7-c77a9652e1d8",
  "name": "O365 Compliance Content Search Exported",
  "description": "The following analytic identifies when the results of a content search within the Office 365 Security and Compliance Center are exported. It uses the SearchExported operation from the SecurityComplianceCenter workload in the o365_management_activity data source. This activity is significant because exporting search results can involve sensitive or critical organizational data, potentially leading to data exfiltration. If confirmed malicious, an attacker could gain access to and exfiltrate sensitive information, posing a severe risk to the organization's data security and compliance posture.",
  "source": {
    "type": "splunk",
    "id": "2ce9f31d-ab4f-4179-b2b7-c77a9652e1d8",
    "url": "https://github.com/splunk/security_content/blob/develop/o365_compliance_content_search_exported.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/o365_compliance_content_search_exported.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1114/002/",
    "https://learn.microsoft.com/en-us/purview/ediscovery-content-search-overview",
    "https://learn.microsoft.com/en-us/purview/ediscovery-keyword-queries-and-search-conditions",
    "https://learn.microsoft.com/en-us/purview/ediscovery-search-for-activities-in-the-audit-log"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`o365_management_activity` Workload=SecurityComplianceCenter Operation=\"SearchExported\" | rename user_id as user | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user src vendor_account vendor_product ExchangeLocations Query | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `o365_compliance_content_search_exported_filter`",
    "condition": "You must install the Splunk Microsoft Office 365 Add-on and ingest Office 365 management activity events.",
    "fields": []
  },
  "falsepositives": [
    "Compliance content searche exports may be executed for legitimate purposes, filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}