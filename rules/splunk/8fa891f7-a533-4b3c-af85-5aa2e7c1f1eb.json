{
  "id": "8fa891f7-a533-4b3c-af85-5aa2e7c1f1eb",
  "name": "Large Volume of DNS ANY Queries",
  "description": "The following analytic identifies a large volume of DNS ANY queries, which may indicate a DNS amplification attack. It leverages the Network_Resolution data model to count DNS queries of type \"ANY\" directed to specific destinations. This activity is significant because DNS amplification attacks can overwhelm network resources, leading to Denial of Service (DoS) conditions. If confirmed malicious, this activity could disrupt services, degrade network performance, and potentially be part of a larger Distributed Denial of Service (DDoS) attack, impacting the availability of critical infrastructure.",
  "source": {
    "type": "splunk",
    "id": "8fa891f7-a533-4b3c-af85-5aa2e7c1f1eb",
    "url": "https://github.com/splunk/security_content/blob/develop/large_volume_of_dns_any_queries.yml",
    "file_path": "tmp/repos/splunk/detections/network/large_volume_of_dns_any_queries.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count from datamodel=Network_Resolution where nodename=DNS \"DNS.message_type\"=\"QUERY\" \"DNS.record_type\"=\"ANY\" by \"DNS.dest\" | `drop_dm_object_name(\"DNS\")` | where count>200 | `large_volume_of_dns_any_queries_filter`",
    "condition": "To successfully implement this search you must ensure that DNS data is populating the Network_Resolution data model.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate ANY requests may trigger this search, however it is unusual to see a large volume of them under typical circumstances. You may modify the threshold in the search to better suit your environment."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}