{
  "id": "fcf4bd3f-a79f-4b7a-83bf-2692d60b859d",
  "name": "Microsoft SharePoint Server Elevation of Privilege",
  "description": "The following analytic detects potential exploitation attempts against Microsoft SharePoint Server vulnerability CVE-2023-29357. It leverages the Web datamodel to monitor for specific API calls and HTTP methods indicative of privilege escalation attempts. This activity is significant as it may indicate an attacker is trying to gain unauthorized privileged access to the SharePoint environment. If confirmed malicious, the impact could include unauthorized access to sensitive data, potential data theft, and further compromise of the SharePoint server, leading to a broader security breach.",
  "source": {
    "type": "splunk",
    "id": "fcf4bd3f-a79f-4b7a-83bf-2692d60b859d",
    "url": "https://github.com/splunk/security_content/blob/develop/microsoft_sharepoint_server_elevation_of_privilege.yml",
    "file_path": "tmp/repos/splunk/detections/web/microsoft_sharepoint_server_elevation_of_privilege.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://socradar.io/microsoft-sharepoint-server-elevation-of-privilege-vulnerability-exploit-cve-2023-29357/",
    "https://github.com/LuemmelSec/CVE-2023-29357/blob/main/CVE-2023-29357/Program.cs"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"/_api/web/siteusers*\",\"/_api/web/currentuser*\") Web.status=200 Web.http_method=GET by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `microsoft_sharepoint_server_elevation_of_privilege_filter`",
    "condition": "This detection requires the Web datamodel to be populated from a supported Technology Add-On like Splunk for Microsoft SharePoint.",
    "fields": []
  },
  "falsepositives": [
    "False positives may occur if there are legitimate activities that mimic the exploitation pattern. It's recommended to review the context of the alerts and adjust the analytic parameters to better fit the specific environment."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}