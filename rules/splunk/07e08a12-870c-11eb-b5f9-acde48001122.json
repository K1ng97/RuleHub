{
  "id": "07e08a12-870c-11eb-b5f9-acde48001122",
  "name": "Clop Ransomware Known Service Name",
  "description": "The following analytic identifies the creation of a service with a known name used by CLOP ransomware for persistence and high-privilege code execution. It detects this activity by monitoring Windows Event Logs (EventCode 7045) for specific service names (\"SecurityCenterIBM\", \"WinCheckDRVs\"). This activity is significant because the creation of such services is a common tactic used by ransomware to maintain control over infected systems. If confirmed malicious, this could allow attackers to execute code with elevated privileges, maintain persistence, and potentially disrupt or encrypt critical data.",
  "source": {
    "type": "splunk",
    "id": "07e08a12-870c-11eb-b5f9-acde48001122",
    "url": "https://github.com/splunk/security_content/blob/develop/clop_ransomware_known_service_name.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/clop_ransomware_known_service_name.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Teoderick Contreras",
  "references": [
    "https://www.mandiant.com/resources/fin11-email-campaigns-precursor-for-ransomware-data-theft",
    "https://blog.virustotal.com/2020/11/keep-your-friends-close-keep-ransomware.html"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_system` EventCode=7045 ServiceName IN (\"SecurityCenterIBM\", \"WinCheckDRVs\") | stats count min(_time) as firstTime max(_time) as lastTime by Computer EventCode ServiceName StartType ServiceType | rename Computer as dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `clop_ransomware_known_service_name_filter`",
    "condition": "To successfully implement this search, you need to be ingesting logs with the Service name, Service File Name Service Start type, and Service Type from your endpoints.",
    "fields": []
  },
  "falsepositives": [
    "unknown"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}