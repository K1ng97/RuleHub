{
  "id": "f56936c0-ae6f-4eeb-91ff-ecc1448c6105",
  "name": "Confluence Pre-Auth RCE via OGNL Injection CVE-2023-22527",
  "description": "The following analytic identifies attempts to exploit a critical template injection vulnerability (CVE-2023-22527) in outdated Confluence Data Center and Server versions. It detects POST requests to the \"/template/aui/text-inline.vm\" endpoint with HTTP status codes 200 or 202, indicating potential OGNL injection attacks. This activity is significant as it allows unauthenticated attackers to execute arbitrary code remotely. If confirmed malicious, attackers could gain full control over the affected Confluence instance, leading to data breaches, system compromise, and further network infiltration. Immediate patching is essential to mitigate this threat.",
  "source": {
    "type": "splunk",
    "id": "f56936c0-ae6f-4eeb-91ff-ecc1448c6105",
    "url": "https://github.com/splunk/security_content/blob/develop/confluence_pre_auth_rce_via_ognl_injection_cve_2023_22527.yml",
    "file_path": "tmp/repos/splunk/detections/web/confluence_pre_auth_rce_via_ognl_injection_cve_2023_22527.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://github.com/cleverg0d/CVE-2023-22527",
    "https://confluence.atlassian.com/security/cve-2023-22527-rce-remote-code-execution-vulnerability-in-confluence-data-center-and-confluence-server-1333990257.html"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url=\"*/template/aui/text-inline.vm*\" Web.http_method=POST Web.status IN (200, 202) by Web.src, Web.dest, Web.http_user_agent, Web.url, Web.status | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `confluence_pre_auth_rce_via_ognl_injection_cve_2023_22527_filter`",
    "condition": "To successfully implement this search you need to be ingesting information on Web traffic that include fields relavent for traffic into the `Web` datamodel.",
    "fields": []
  },
  "falsepositives": [
    "False positives may be present with legitimate applications. Attempt to filter by dest IP or use Asset groups to restrict to confluence servers."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}