{
  "id": "68d3e2c1-e97f-4310-b080-dea180b48aa9",
  "name": "Zscaler Phishing Activity Threat Blocked",
  "description": "The following analytic identifies potential phishing attempts blocked by Zscaler within a network. It leverages web proxy logs to detect actions tagged as HTML.Phish. The detection method involves analyzing critical data points such as user, threat name, URL, and hostname. This activity is significant for a SOC as it serves as an early warning system for phishing threats, enabling prompt investigation and mitigation. If confirmed malicious, this activity could indicate an attempt to deceive users into divulging sensitive information, potentially leading to data breaches or credential theft.",
  "source": {
    "type": "splunk",
    "id": "68d3e2c1-e97f-4310-b080-dea180b48aa9",
    "url": "https://github.com/splunk/security_content/blob/develop/zscaler_phishing_activity_threat_blocked.yml",
    "file_path": "tmp/repos/splunk/detections/web/zscaler_phishing_activity_threat_blocked.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Gowthamaraj Rajendran, Rod Soto, Splunk",
  "references": [
    "https://help.zscaler.com/zia/nss-feed-output-format-web-logs"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`zscaler_proxy` action=blocked threatname=\"HTML.Phish*\" | stats count min(_time) as firstTime max(_time) as lastTime by action deviceowner user threatname url src dest | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `zscaler_phishing_activity_threat_blocked_filter`",
    "condition": "You must install the latest version of Zscaler Add-on from Splunkbase. You must be ingesting Zscaler events into your Splunk environment through an ingester. This analytic was written to be used with the \"zscalernss-web\" sourcetype leveraging the Zscaler proxy data. This enables the integration with Splunk Enterprise Security. Security teams are encouraged to adjust the detection parameters, ensuring the detection is tailored to their specific environment.",
    "fields": []
  },
  "falsepositives": [
    "False positives are limited to Zscalar configuration."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}