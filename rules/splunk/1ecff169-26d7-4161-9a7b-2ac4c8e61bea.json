{
  "id": "1ecff169-26d7-4161-9a7b-2ac4c8e61bea",
  "name": "Azure Active Directory High Risk Sign-in",
  "description": "The following analytic detects high-risk sign-in attempts against Azure Active Directory, identified by Azure Identity Protection. It leverages the RiskyUsers and UserRiskEvents log categories from Azure AD events ingested via EventHub. This activity is significant as it indicates potentially compromised accounts, flagged by heuristics and machine learning. If confirmed malicious, attackers could gain unauthorized access to sensitive resources, leading to data breaches or further exploitation within the environment.",
  "source": {
    "type": "splunk",
    "id": "1ecff169-26d7-4161-9a7b-2ac4c8e61bea",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_active_directory_high_risk_sign_in.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_active_directory_high_risk_sign_in.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/003/",
    "https://docs.microsoft.com/en-us/security/compass/incident-response-playbook-password-spray",
    "https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection",
    "https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/concept-identity-protection-risks"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad` `azure_monitor_aad` category=UserRiskEvents properties.riskLevel=high | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product category | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_active_directory_high_risk_sign_in_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase (https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Active Directory events into your Splunk environment through an EventHub. Specifically, this analytic leverages the RiskyUsers and UserRiskEvents log category in the azure:monitor:aad sourcetype.",
    "fields": []
  },
  "falsepositives": [
    "Details for the risk calculation algorithm used by Identity Protection are unknown and may be prone to false positives."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}