{
  "id": "a4c76d0a-56b6-44be-814b-939746c4d406",
  "name": "Cisco Secure Firewall - Snort Rule Triggered Across Multiple Hosts",
  "description": "This analytic identifies Snort intrusion signatures that have been triggered by ten or more distinct internal IP addresses within a one-hour window. It leverages Cisco Secure Firewall Threat Defense logs and focuses on the IntrusionEvent event type to detect activity that may indicate broad targeting or mass exploitation attempts. This behavior is often associated with opportunistic scanning, worm propagation, or automated exploitation of known vulnerabilities across multiple systems. If confirmed malicious, this could represent the early phase of a coordinated attack aiming to gain a foothold on several hosts or move laterally across the environment.\n",
  "source": {
    "type": "splunk",
    "id": "a4c76d0a-56b6-44be-814b-939746c4d406",
    "url": "https://github.com/splunk/security_content/blob/develop/cisco_secure_firewall___snort_rule_triggered_across_multiple_hosts.yml",
    "file_path": "tmp/repos/splunk/detections/network/cisco_secure_firewall___snort_rule_triggered_across_multiple_hosts.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Nasreddine Bencherchali, Splunk",
  "references": [
    "https://www.cisco.com/c/en/us/td/docs/security/firepower/741/api/FQE/secure_firewall_estreamer_fqe_guide_740.pdf"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cisco_secure_firewall` EventType=IntrusionEvent\n| bin _time span=1h\n| stats dc(src_ip) as unique_src_ips, values(src_ip) as src_ip \n        min(_time) as firstTime max(_time) as lastTime\n        Values(dest) as dest\n        Values(dest_port) as dest_port\n        Values(rule) as rule\n        Values(transport) as transport\n        Values(app) as app\n        by signature_id, signature class_desc MitreAttackGroups InlineResult InlineResultReason \n| where unique_src_ips >= 10\n| `security_content_ctime(firstTime)`\n| `security_content_ctime(lastTime)`\n| `cisco_secure_firewall___snort_rule_triggered_across_multiple_hosts_filter`\n",
    "condition": "This search requires Cisco Secure Firewall Threat Defense Logs, which\nincludes the IntrusionEvent EventType. This search uses an input macro named `cisco_secure_firewall`.\nWe strongly recommend that you specify your environment-specific configurations\n(index, source, sourcetype, etc.) for Cisco Secure Firewall Threat Defense logs. Replace the macro definition\nwith configurations for your Splunk environment. The search also uses a post-filter\nmacro designed to filter out known false positives.\nThe logs are to be ingested using the Splunk Add-on for Cisco Security Cloud (https://splunkbase.splunk.com/app/7404).\nThe intrusion access policy must also be configured.\n",
    "fields": []
  },
  "falsepositives": [
    "False positives should be minimal. Simultaneous vulnerability scanning across multiple internal hosts might trigger this, as well as some snort rules that are noisy. Disable those if necessary or increase the threshold."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}