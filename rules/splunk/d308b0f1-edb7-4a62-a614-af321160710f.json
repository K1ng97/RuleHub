{
  "id": "d308b0f1-edb7-4a62-a614-af321160710f",
  "name": "AWS Defense Evasion Delete CloudWatch Log Group",
  "description": "The following analytic detects the deletion of CloudWatch log groups in AWS, identified through `DeleteLogGroup` events in CloudTrail logs. This detection leverages CloudTrail data to monitor for successful log group deletions, excluding console-based actions. This activity is significant as it indicates potential attempts to evade logging and monitoring, which is crucial for maintaining visibility into AWS activities. If confirmed malicious, this could allow attackers to hide their tracks, making it difficult to detect further malicious actions or investigate incidents within the compromised AWS environment.",
  "source": {
    "type": "splunk",
    "id": "d308b0f1-edb7-4a62-a614-af321160710f",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_defense_evasion_delete_cloudwatch_log_group.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_defense_evasion_delete_cloudwatch_log_group.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Gowthamaraj Rajendran, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1562/008/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName = DeleteLogGroup eventSource = logs.amazonaws.com userAgent !=console.amazonaws.com errorCode = success | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)`| `security_content_ctime(lastTime)`| `aws_defense_evasion_delete_cloudwatch_log_group_filter`",
    "condition": "You must install Splunk AWS Add on and enable CloudTrail logs in your AWS Environment.",
    "fields": []
  },
  "falsepositives": [
    "While this search has no known false positives, it is possible that an AWS admin has deleted CloudWatch logging. Please investigate this activity."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}