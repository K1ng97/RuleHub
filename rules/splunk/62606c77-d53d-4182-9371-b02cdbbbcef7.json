{
  "id": "62606c77-d53d-4182-9371-b02cdbbbcef7",
  "name": "Windows Rapid Authentication On Multiple Hosts",
  "description": "The following analytic detects a source computer authenticating to 30 or more remote endpoints within a 5-minute timespan using Event ID 4624. This behavior is identified by analyzing Windows Event Logs for LogonType 3 events and counting unique target computers. Such activity is significant as it may indicate lateral movement or network share enumeration by an adversary. If confirmed malicious, this could lead to unauthorized access to multiple systems, potentially compromising sensitive data and escalating privileges within the network.",
  "source": {
    "type": "splunk",
    "id": "62606c77-d53d-4182-9371-b02cdbbbcef7",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_rapid_authentication_on_multiple_hosts.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_rapid_authentication_on_multiple_hosts.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1135/",
    "https://thedfirreport.com/2023/01/23/sharefinder-how-threat-actors-discover-file-shares/",
    "https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4624 LogonType=3 TargetUserName!=\"ANONYMOUS LOGON\" TargetUserName!=\"*$\" | bucket span=5m _time | stats dc(Computer) AS unique_targets values(Computer) as host_targets values(dest) as dest values(src) as src values(user) as user by _time, IpAddress, TargetUserName, action, app, authentication_method, signature, signature_id | where unique_targets > 30 | `windows_rapid_authentication_on_multiple_hosts_filter`",
    "condition": "To successfully implement this search, you need to be ingesting Windows Event Logs from domain controllers as well as member servers and workstations. The Advanced Security Audit policy setting `Audit Logon` within `Logon/Logoff` needs to be enabled.",
    "fields": []
  },
  "falsepositives": [
    "Vulnerability scanners or system administration tools may also trigger this detection. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}