{
  "id": "825fed20-309d-4fd1-8aaf-cd49c1bb093c",
  "name": "Azure AD Global Administrator Role Assigned",
  "description": "The following analytic detects the assignment of the Azure AD Global Administrator role to a user. It leverages Azure Active Directory AuditLogs to identify when the \"Add member to role\" operation includes the \"Global Administrator\" role. This activity is significant because the Global Administrator role grants extensive access to data, resources, and settings, similar to a Domain Administrator in traditional AD environments. If confirmed malicious, this could allow an attacker to establish persistence, escalate privileges, and potentially gain control over Azure resources, posing a severe security risk.",
  "source": {
    "type": "splunk",
    "id": "825fed20-309d-4fd1-8aaf-cd49c1bb093c",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_ad_global_administrator_role_assigned.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_ad_global_administrator_role_assigned.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Gowthamaraj Rajendran, Mauricio Velazco, Splunk",
  "references": [
    "https://o365blog.com/post/admin/",
    "https://adsecurity.org/?p=4277",
    "https://www.mandiant.com/resources/detecting-microsoft-365-azure-active-directory-backdoors",
    "https://docs.microsoft.com/en-us/azure/active-directory/roles/security-planning",
    "https://docs.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin",
    "https://attack.mitre.org/techniques/T1098/003/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad` operationName=\"Add member to role\" properties.targetResources{}.modifiedProperties{}.newValue=\"*Global Administrator*\" | rename properties.* as * | rename initiatedBy.user.userPrincipalName as initiatedBy | rename userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent initiatedBy signature | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_global_administrator_role_assigned_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase(https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Active Directory events into your Splunk environment through an EventHub. This analytic was written to be used with the azure:monitor:aad sourcetype leveraging the AuditLogs log category.",
    "fields": []
  },
  "falsepositives": [
    "Administrators may legitimately assign the Global Administrator role to a user. Filter as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}