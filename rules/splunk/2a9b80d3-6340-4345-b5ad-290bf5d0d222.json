{
  "id": "2a9b80d3-6340-4345-b5ad-290bf5d0d222",
  "name": "Detect Spike in AWS Security Hub Alerts for EC2 Instance",
  "description": "The following analytic identifies a spike in the number of AWS Security Hub alerts for an EC2 instance within a 4-hour interval. It leverages AWS Security Hub findings data, calculating the average and standard deviation of alerts to detect anomalies. This activity is significant for a SOC as a sudden increase in alerts may indicate potential security incidents or misconfigurations requiring immediate attention. If confirmed malicious, this could signify an ongoing attack, leading to unauthorized access, data exfiltration, or disruption of services on the affected EC2 instance.",
  "source": {
    "type": "splunk",
    "id": "2a9b80d3-6340-4345-b5ad-290bf5d0d222",
    "url": "https://github.com/splunk/security_content/blob/develop/detect_spike_in_aws_security_hub_alerts_for_ec2_instance.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/detect_spike_in_aws_security_hub_alerts_for_ec2_instance.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`aws_securityhub_finding` \"Resources{}.Type\"=AWSEC2Instance | bucket span=4h _time | stats count AS alerts values(Title) as Title values(Types{}) as Types values(vendor_account) as vendor_account values(vendor_region) as vendor_region values(severity) as severity by _time dest | eventstats avg(alerts) as total_alerts_avg, stdev(alerts) as total_alerts_stdev | eval threshold_value = 3 | eval isOutlier=if(alerts > total_alerts_avg+(total_alerts_stdev * threshold_value), 1, 0) | search isOutlier=1 | table _time dest alerts Title Types vendor_account vendor_region severity isOutlier total_alerts_avg | `detect_spike_in_aws_security_hub_alerts_for_ec2_instance_filter`",
    "condition": "You must install the AWS App for Splunk (version 5.1.0 or later) and Splunk Add-on for AWS (version 4.4.0 or later), then configure your Security Hub inputs. The threshold_value should be tuned to your environment and schedule these searches according to the bucket span interval.",
    "fields": []
  },
  "falsepositives": [
    "None"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}