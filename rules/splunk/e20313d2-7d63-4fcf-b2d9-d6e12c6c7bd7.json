{
  "id": "e20313d2-7d63-4fcf-b2d9-d6e12c6c7bd7",
  "name": "Cisco Secure Firewall - Rare Snort Rule Triggered",
  "description": "This analytic identifies Snort signatures that have triggered only once in the past 7 days across all Cisco Secure Firewall IntrusionEvent logs. While these rules typically do not trigger in day-to-day network activity, their sudden appearance may indicate early-stage compromise, previously unseen malware, or reconnaissance activity against less commonly exposed services. Investigating these outliers can provide valuable insight into new or low-noise adversary behaviors.\n",
  "source": {
    "type": "splunk",
    "id": "e20313d2-7d63-4fcf-b2d9-d6e12c6c7bd7",
    "url": "https://github.com/splunk/security_content/blob/develop/cisco_secure_firewall___rare_snort_rule_triggered.yml",
    "file_path": "tmp/repos/splunk/detections/network/cisco_secure_firewall___rare_snort_rule_triggered.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "manual_test",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Nasreddine Bencherchali, Splunk",
  "references": [
    "https://www.cisco.com/c/en/us/td/docs/security/firepower/741/api/FQE/secure_firewall_estreamer_fqe_guide_740.pdf"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cisco_secure_firewall` EventType=IntrusionEvent earliest=-7d\n| stats dc(_time) as TriggerCount min(_time) as firstTime max(_time) as lastTime \n        values(signature) as signature \n        values(src_ip) as src_ip \n        values(dest) as dest \n        values(dest_port) as dest_port\n        values(transport) as transport\n        values(app) as app \n        values(rule) as rule \n        by signature_id class_desc MitreAttackGroups InlineResult InlineResultReason\n| where TriggerCount = 1\n| `security_content_ctime(firstTime)`\n| `security_content_ctime(lastTime)`\n| `cisco_secure_firewall___rare_snort_rule_triggered_filter`\n",
    "condition": "This search requires Cisco Secure Firewall Threat Defense Logs, which\nincludes the IntrusionEvent EventType. This search uses an input macro named `cisco_secure_firewall`.\nWe strongly recommend that you specify your environment-specific configurations\n(index, source, sourcetype, etc.) for Cisco Secure Firewall Threat Defense logs. Replace the macro definition\nwith configurations for your Splunk environment. The search also uses a post-filter\nmacro designed to filter out known false positives.\nThe logs are to be ingested using the Splunk Add-on for Cisco Security Cloud (https://splunkbase.splunk.com/app/7404).\nThe intrusion access policy must also be configured.\n",
    "fields": []
  },
  "falsepositives": [
    "False positives may occur with certain rare activity. Apply additional filters where required."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}