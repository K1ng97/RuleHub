{
  "id": "e5ab41bf-745d-4f72-a393-2611151afd8e",
  "name": "Azure AD High Number Of Failed Authentications From Ip",
  "description": "The following analytic detects an IP address with 20 or more failed authentication attempts to an Azure AD tenant within 10 minutes. It leverages Azure AD SignInLogs to identify repeated failed logins from the same IP. This behavior is significant as it may indicate a brute force attack aimed at gaining unauthorized access or escalating privileges. If confirmed malicious, the attacker could potentially compromise user accounts, leading to unauthorized access to sensitive information and resources within the Azure environment.",
  "source": {
    "type": "splunk",
    "id": "e5ab41bf-745d-4f72-a393-2611151afd8e",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_ad_high_number_of_failed_authentications_from_ip.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_ad_high_number_of_failed_authentications_from_ip.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1110/",
    "https://attack.mitre.org/techniques/T1110/001/",
    "https://attack.mitre.org/techniques/T1110/003/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad` category= SignInLogs properties.status.errorCode=50126 properties.authenticationDetails{}.succeeded=false | rename properties.* as * | bucket span=10m _time | rename properties.userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime values(dest) as dest values(user) as user values(user_agent) as user_agent by src _time vendor_account vendor_product | where count > 20  | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_high_number_of_failed_authentications_from_ip_filter`",
    "condition": "You must install the latest version of Splunk Add-on for Microsoft Cloud Services from Splunkbase (https://splunkbase.splunk.com/app/3110/#/details). You must be ingesting Azure Active Directory events into your Splunk environment through an EventHub. This analytic was written to be used with the azure:monitor:aad sourcetype leveraging the SignInLogs log category.",
    "fields": []
  },
  "falsepositives": [
    "An Ip address with more than 20 failed authentication attempts in the span of 10 minutes may also be triggered by a broken application."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}