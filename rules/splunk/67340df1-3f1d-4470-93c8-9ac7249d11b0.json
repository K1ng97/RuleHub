{
  "id": "67340df1-3f1d-4470-93c8-9ac7249d11b0",
  "name": "Windows RDPClient Connection Sequence Events",
  "description": "This analytic monitors Windows RDP client connection sequence events (EventCode 1024) from the Microsoft-Windows-TerminalServices-RDPClient/Operational log. These events track when RDP ClientActiveX initiates connection attempts to remote servers. The connection sequence is a critical phase of RDP where the client and server exchange settings and establish common parameters for the session. Monitoring these events can help identify unusual RDP connection patterns, potential lateral movement attempts, unauthorized remote access activity, and RDP connection chains that may indicate compromised systems. NOTE the analytic was written for Multi-Line as XML was not properly parsed out.",
  "source": {
    "type": "splunk",
    "id": "67340df1-3f1d-4470-93c8-9ac7249d11b0",
    "url": "https://github.com/splunk/security_content/blob/develop/windows_rdpclient_connection_sequence_events.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/windows_rdpclient_connection_sequence_events.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://gist.github.com/MHaggis/acd5dcbf1d4fb705b77f0a48e772eefc",
    "https://www.microsoft.com/en-us/security/blog/2024/10/29/midnight-blizzard-conducts-large-scale-spear-phishing-campaign-using-rdp-files/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_rdp` EventCode=1024 | rename host as dest | stats count as \"Event Count\", min(_time) as firstTime, max(_time) as lastTime, values(Message) as messages by dest, source, LogName, EventCode, category | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `windows_rdpclient_connection_sequence_events_filter`",
    "condition": "To successfully implement this detection, ensure Windows RDP Client Operational logs are being collected and forwarded to Splunk. Enable logging for \"Microsoft-Windows-TerminalServices-RDPClient/Operational\", via a new inputs.conf input. See references for more details.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate RDP connections from authorized administrators and users will generate these events. To reduce false positives, you should baseline normal RDP connection patterns in your environment, whitelist expected RDP connection chains between known administrative workstations and servers, and track authorized remote support sessions."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}