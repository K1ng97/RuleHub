{
  "id": "3d8536b6-52b4-4c3e-b695-3f2e90bb22be",
  "name": "Cisco Secure Firewall - Potential Data Exfiltration",
  "description": "The following analytic detects potentially suspicious large outbound data transfers from internal to external networks. It leverages Cisco Secure Firewall Threat Defense logs and calculates the total volume of data exchanged per connection by summing InitiatorBytes and ResponderBytes. Connections exceeding 100 MB are flagged, as these may indicate unauthorized data exfiltration, especially if initiated by unusual users, hosts, or processes. This analytic is scoped to inside-to-outside flows using a macro (cisco_secure_firewall_inside_to_outside) to abstract environment-specific zone definitions. If confirmed malicious, this behavior may reflect data staging and exfiltration over an encrypted or stealthy transport.\n",
  "source": {
    "type": "splunk",
    "id": "3d8536b6-52b4-4c3e-b695-3f2e90bb22be",
    "url": "https://github.com/splunk/security_content/blob/develop/cisco_secure_firewall___potential_data_exfiltration.yml",
    "file_path": "tmp/repos/splunk/detections/network/cisco_secure_firewall___potential_data_exfiltration.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Nasreddine Bencherchali, Splunk",
  "references": [
    "https://www.cisco.com/c/en/us/td/docs/security/firepower/741/api/FQE/secure_firewall_estreamer_fqe_guide_740.pdf"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cisco_secure_firewall` EventType=ConnectionEvent `cisco_secure_firewall_inside_to_outside`\n| eval total_bytes = InitiatorBytes + ResponderBytes\n| eval total_mb = round(total_bytes / 1024 / 1024, 2)\n| where total_mb >= 100\n| eval Exfiltrated = total_mb + \" MB\"\n| stats min(_time) as firstTime max(_time) as lastTime\n    Values(url) as url\n    Values(rule) as rule\n    Values(dest_port) as dest_port\n    by src_ip, dest, Exfiltrated, transport, action\n| `security_content_ctime(firstTime)`\n| `security_content_ctime(lastTime)`\n| `cisco_secure_firewall___potential_data_exfiltration_filter`\n",
    "condition": "This search requires Cisco Secure Firewall Threat Defense Logs, which\nincludes the ConnectionEvent EventType. This search uses two input macros named `cisco_secure_firewall` and `cisco_secure_firewall_inside_to_outside`.\nWe strongly recommend that you specify your environment-specific configurations\n(index, source, sourcetype, etc.) for Cisco Secure Firewall Threat Defense logs. Replace the macro definitions\nwith configurations for your Splunk environment. The search also uses a post-filter\nmacro designed to filter out known false positives.\nThe logs are to be ingested using the Splunk Add-on for Cisco Security Cloud (https://splunkbase.splunk.com/app/7404).\nThe access policy must also enable logging.\n",
    "fields": []
  },
  "falsepositives": [
    "Large outbound transfers may occur due to legitimate activities such as cloud backups, file syncing, OS or application updates, or developer build deployments.\nBackup servers, CI/CD pipelines, and enterprise sync tools (e.g., OneDrive, Dropbox) may exhibit similar patterns.\nAdditional validation using user context, scheduled task windows, or endpoint telemetry is recommended to reduce false positives.\n"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}