{
  "id": "a520b1fe-cc9e-4f56-b762-18354594c52f",
  "name": "AWS Successful Single-Factor Authentication",
  "description": "The following analytic identifies a successful Console Login authentication event for an AWS IAM user account without Multi-Factor Authentication (MFA) enabled. It leverages AWS CloudTrail logs to detect instances where MFA was not used during login. This activity is significant as it may indicate a misconfiguration, policy violation, or potential account takeover attempt. If confirmed malicious, an attacker could gain unauthorized access to the AWS environment, potentially leading to data exfiltration, resource manipulation, or further privilege escalation.",
  "source": {
    "type": "splunk",
    "id": "a520b1fe-cc9e-4f56-b762-18354594c52f",
    "url": "https://github.com/splunk/security_content/blob/develop/aws_successful_single_factor_authentication.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/aws_successful_single_factor_authentication.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1621/",
    "https://attack.mitre.org/techniques/T1078/004/",
    "https://aws.amazon.com/what-is/mfa/"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`cloudtrail` eventName= ConsoleLogin errorCode=success \"additionalEventData.MFAUsed\"=No | rename user_name as user | stats count min(_time) as firstTime max(_time) as lastTime by signature dest user user_agent src vendor_account vendor_region vendor_product | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `aws_successful_single_factor_authentication_filter`",
    "condition": "The Splunk AWS Add-on is required to utilize this data. The search requires AWS CloudTrail logs.",
    "fields": []
  },
  "falsepositives": [
    "It is possible that some accounts do not have MFA enabled for the AWS account however its agaisnt the best practices of securing AWS."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}