{
  "id": "f4ca0057-cbf3-44f8-82ea-4e330ee901d3",
  "name": "Okta Phishing Detection with FastPass Origin Check",
  "description": "The following analytic identifies failed user authentication attempts in Okta due to FastPass declining a phishing attempt. It leverages Okta logs, specifically looking for events where multi-factor authentication (MFA) fails with the reason \"FastPass declined phishing attempt.\" This activity is significant as it indicates that attackers are targeting users with real-time phishing proxies, attempting to capture credentials. If confirmed malicious, this could lead to unauthorized access to user accounts, potentially compromising sensitive information and furthering lateral movement within the organization.",
  "source": {
    "type": "splunk",
    "id": "f4ca0057-cbf3-44f8-82ea-4e330ee901d3",
    "url": "https://github.com/splunk/security_content/blob/develop/okta_phishing_detection_with_fastpass_origin_check.yml",
    "file_path": "tmp/repos/splunk/detections/application/okta_phishing_detection_with_fastpass_origin_check.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Okta, Inc, Michael Haag, Splunk",
  "references": [
    "https://sec.okta.com/fastpassphishingdetection"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`okta` eventType=\"user.authentication.auth_via_mfa\" AND result=\"FAILURE\" AND outcome.reason=\"FastPass declined phishing attempt\" | stats count min(_time) as firstTime max(_time) as lastTime values(displayMessage) by user eventType client.userAgent.rawUserAgent client.userAgent.browser outcome.reason | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `okta_phishing_detection_with_fastpass_origin_check_filter`",
    "condition": "This search is specific to Okta and requires Okta logs to be ingested in your Splunk deployment.",
    "fields": []
  },
  "falsepositives": [
    "Fidelity of this is high as Okta is specifying malicious infrastructure. Filter and modify as needed."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}