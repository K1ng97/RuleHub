{
  "id": "d62852db-a1f1-40db-a7fc-c3d56fa8bda3",
  "name": "Azure AD AzureHound UserAgent Detected",
  "description": "This detection identifies the presence of the default AzureHound user-agent string within Microsoft Graph Activity logs and NonInteractive SignIn Logs. AzureHound is a tool used for gathering information about Azure Active Directory environments, often employed by security professionals for legitimate auditing purposes. However, it can also be leveraged by malicious actors to perform reconnaissance activities, mapping out the Azure AD infrastructure to identify potential vulnerabilities and targets for further exploitation. Detecting its usage can help in identifying unauthorized access attempts and preemptively mitigating potential security threats to your Azure environment.",
  "source": {
    "type": "splunk",
    "id": "d62852db-a1f1-40db-a7fc-c3d56fa8bda3",
    "url": "https://github.com/splunk/security_content/blob/develop/azure_ad_azurehound_useragent_detected.yml",
    "file_path": "tmp/repos/splunk/detections/cloud/azure_ad_azurehound_useragent_detected.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Dean Luxton",
  "references": [
    "https://github.com/SpecterOps/AzureHound",
    "https://splunkbase.splunk.com/app/3110",
    "https://docs.splunk.com/Documentation/AddOns/released/MSCloudServices/Install"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`azure_monitor_aad` category IN (MicrosoftGraphActivityLogs, NonInteractiveUserSignInLogs) properties.userAgent=azurehound* | rename properties.userAgent as user_agent | fillnull | stats count min(_time) as firstTime max(_time) as lastTime by dest user src vendor_account vendor_product user_agent signature | iplocation src | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `azure_ad_azurehound_useragent_detected_filter`",
    "condition": "The Splunk Add-on for Microsoft Cloud Services add-on is required to ingest NonInteractiveUserSignInLogs and MicrosoftGraphActivityLogs via an Azure EventHub. See reference for links for further details.",
    "fields": []
  },
  "falsepositives": [
    "None"
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}