{
  "id": "9d22a780-5165-11ec-ad4f-3e22fbd008af",
  "name": "Randomly Generated Scheduled Task Name",
  "description": "The following analytic detects the creation of a Scheduled Task with a high entropy, randomly generated name, leveraging Event ID 4698. It uses the `ut_shannon` function from the URL ToolBox Splunk application to measure the entropy of the Task Name. This activity is significant as adversaries often use randomly named Scheduled Tasks for lateral movement and remote code execution, employing tools like Impacket or CrackMapExec. If confirmed malicious, this could allow attackers to execute arbitrary code remotely, potentially leading to further compromise and persistence within the network.",
  "source": {
    "type": "splunk",
    "id": "9d22a780-5165-11ec-ad4f-3e22fbd008af",
    "url": "https://github.com/splunk/security_content/blob/develop/randomly_generated_scheduled_task_name.yml",
    "file_path": "tmp/repos/splunk/detections/endpoint/randomly_generated_scheduled_task_name.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Mauricio Velazco, Splunk",
  "references": [
    "https://attack.mitre.org/techniques/T1053/005/",
    "https://splunkbase.splunk.com/app/2734/",
    "https://en.wikipedia.org/wiki/Entropy_(information_theory)"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "`wineventlog_security` EventCode=4698 | xmlkv Message | lookup ut_shannon_lookup word as Task_Name | where ut_shannon > 3 | table  _time, dest, Task_Name, ut_shannon, Command, Author, Enabled, Hidden | `randomly_generated_scheduled_task_name_filter`",
    "condition": "To successfully implement this search, you need to be ingesting Windows Security Event Logs with 4698 EventCode enabled. The Windows TA as well as the URL ToolBox application are also required.",
    "fields": []
  },
  "falsepositives": [
    "Legitimate applications may use random Scheduled Task names."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}