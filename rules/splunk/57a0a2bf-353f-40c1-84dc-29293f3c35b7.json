{
  "id": "57a0a2bf-353f-40c1-84dc-29293f3c35b7",
  "name": "Unusually Long Content-Type Length",
  "description": "The following analytic identifies unusually long strings in the Content-Type HTTP header sent by the client to the server. It uses data from the Stream:HTTP source, specifically evaluating the length of the `cs_content_type` field. This activity is significant because excessively long Content-Type headers can indicate attempts to exploit vulnerabilities or evade detection mechanisms. If confirmed malicious, this behavior could allow attackers to execute code, manipulate data, or bypass security controls, potentially leading to unauthorized access or data breaches.",
  "source": {
    "type": "splunk",
    "id": "57a0a2bf-353f-40c1-84dc-29293f3c35b7",
    "url": "https://github.com/splunk/security_content/blob/develop/unusually_long_content_type_length.yml",
    "file_path": "tmp/repos/splunk/detections/web/unusually_long_content_type_length.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "product",
    "security_domain"
  ],
  "author": "Bhavin Patel, Splunk",
  "references": [],
  "severity": "medium",
  "type": "splunk",
  "status": "experimental",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats `security_content_summariesonly` count min(_time) as firstTime max(_time) as lastTime from datamodel=Web by Web.src Web.dest Web.url Web.http_user_agent Web.http_content_type | `drop_dm_object_name(\"Web\")`  | eval http_content_type_length = len(http_content_type)  | where http_content_type_length > 100 | table firstTime lastTime src dest http_content_type_length http_content_type url http_user_agent | `security_content_ctime(firstTime)`  | `security_content_ctime(lastTime)`  | `unusually_long_content_type_length_filter`",
    "condition": "This particular search leverages data extracted from Stream:HTTP. You must configure the http stream using the Splunk Stream App on your Splunk Stream deployment server to extract the cs_content_type field.",
    "fields": []
  },
  "falsepositives": [
    "Very few legitimate Content-Type fields will have a length greater than 100 characters."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}