{
  "id": "89a58e5f-1365-4793-b45c-770abbb32b6c",
  "name": "JetBrains TeamCity RCE Attempt",
  "description": "The following analytic detects attempts to exploit the CVE-2023-42793 vulnerability in JetBrains TeamCity On-Premises. It identifies suspicious POST requests to /app/rest/users/id:1/tokens/RPC2, leveraging the Web datamodel to monitor specific URL patterns and HTTP methods. This activity is significant as it may indicate an unauthenticated attacker attempting to gain administrative access via Remote Code Execution (RCE). If confirmed malicious, this could allow the attacker to execute arbitrary code, potentially compromising the entire TeamCity environment and leading to further unauthorized access and data breaches.",
  "source": {
    "type": "splunk",
    "id": "89a58e5f-1365-4793-b45c-770abbb32b6c",
    "url": "https://github.com/splunk/security_content/blob/develop/jetbrains_teamcity_rce_attempt.yml",
    "file_path": "tmp/repos/splunk/detections/web/jetbrains_teamcity_rce_attempt.yml"
  },
  "tags": [
    "analytic_story",
    "asset_type",
    "atomic_guid",
    "cve",
    "mitre_attack_id",
    "product",
    "security_domain"
  ],
  "author": "Michael Haag, Splunk",
  "references": [
    "https://blog.jetbrains.com/teamcity/2023/09/critical-security-issue-affecting-teamcity-on-premises-update-to-2023-05-4-now/",
    "https://www.sonarsource.com/blog/teamcity-vulnerability/",
    "https://github.com/rapid7/metasploit-framework/pull/18408",
    "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis"
  ],
  "severity": "medium",
  "type": "splunk",
  "status": "production",
  "created": "2025-05-02",
  "modified": "2025-05-02",
  "mitre": {
    "tactics": [],
    "techniques": []
  },
  "detection": {
    "query": "| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web where Web.url IN (\"/app/rest/users/id:1/tokens/RPC2*\") Web.status=200 Web.http_method=POST by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name(\"Web\")` | `security_content_ctime(firstTime)` | `security_content_ctime(lastTime)` | `jetbrains_teamcity_rce_attempt_filter`",
    "condition": "The following analytic requires the Web datamodel. Ensure data source is mapped correctly or modify and tune for your data source.",
    "fields": []
  },
  "falsepositives": [
    "If TeamCity is not in use, this analytic will not return results. Monitor and tune for your environment."
  ],
  "level": "medium",
  "rule_format": "standard",
  "platforms": [],
  "data_sources": []
}